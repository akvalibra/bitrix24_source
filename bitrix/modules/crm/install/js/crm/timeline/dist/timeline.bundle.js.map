{"version":3,"file":"timeline.bundle.js","sources":["../src/types.js","../src/item.js","../src/animations/fasten.js","../src/items/history.js","../src/mixins/history-item.js","../src/mixins/product-list.js","../src/components/product/product.js","../src/components/product/product-list.js","../src/encourage-buy-products/component.js","../src/components/author.js","../src/notification/component.js","../src/components/delivery/delivery-service-info.js","../src/delivery-activity/component.js","../src/delivery-message/component.js","../src/delivery-calculation/component.js","../src/editor.js","../src/tools/wait-configuration-dialog.js","../src/editors/wait.js","../src/editors/sms.js","../src/editors/rest.js","../src/editors/comment.js","../src/items/scheduled.js","../src/action.js","../src/actions/activity.js","../src/actions/email.js","../src/items/history-activity.js","../src/items/document.js","../src/stream.js","../src/streams/entitychat.js","../src/tools/menubar.js","../src/tools/audio-playback-rate-selector.js","../src/tools/schedule-postpone-controller.js","../src/items/scheduled/activity.js","../src/items/scheduled/email.js","../src/items/scheduled/call.js","../src/items/scheduled/call-tracker.js","../src/items/scheduled/meeting.js","../src/items/scheduled/task.js","../src/items/scheduled/store-document.js","../src/items/scheduled/webform.js","../src/items/scheduled/wait.js","../src/items/scheduled/request.js","../src/items/scheduled/rest.js","../src/actions/openline.js","../src/items/scheduled/openline.js","../src/items/scheduled/zoom.js","../src/animations/item.js","../src/animations/shift.js","../src/animations/item-new.js","../src/streams/schedule.js","../src/items/modification.js","../src/items/conversion.js","../src/items/email.js","../src/actions/call.js","../src/items/call.js","../src/items/meeting.js","../src/items/task.js","../src/items/webform.js","../src/items/sms.js","../src/items/request.js","../src/items/openline.js","../src/items/rest.js","../src/items/visit.js","../src/items/zoom.js","../src/items/order-creation.js","../src/items/order-modification.js","../src/items/store-document-creation.js","../src/items/store-document-modification.js","../src/items/external-notice-modification.js","../src/items/external-notice-status-modification.js","../src/items/order-check.js","../src/items/final-summary-documents.js","../src/items/final-summary.js","../src/items/creation.js","../src/items/restoration.js","../src/items/relation.js","../src/items/link.js","../src/items/unlink.js","../src/items/mark.js","../src/items/comment.js","../src/items/wait.js","../src/items/sender.js","../src/items/bizproc.js","../src/items/scoring.js","../src/streams/history.js","../src/streams/fixedhistory.js","../src/animations/expand.js","../src/manager.js","../src/tools/sms-watcher.js","../src/actions/schedule-postpone.js","../src/animations/comment.js","../src/product-compilation/compilation-product-list/component.js","../src/product-compilation/order-notice/component.js","../src/product-compilation/compilation-viewed/component.js","../src/product-compilation/deal-created/component.js","../src/index.js"],"sourcesContent":["/** @memberof BX.Crm.Timeline.Types */\nexport const Item = {\n\tundefined: 0,\n\tactivity: 1,\n\tcreation: 2,\n\tmodification: 3,\n\tlink: 4,\n\tunlink: 5,\n\tmark: 6,\n\tcomment: 7,\n\twait: 8,\n\tbizproc: 9,\n\tconversion: 10,\n\tsender: 11,\n\tdocument: 12,\n\trestoration: 13,\n\torder: 14,\n\torderCheck: 15,\n\tscoring: 16,\n\texternalNotification: 17,\n\tfinalSummary: 18,\n\tdelivery: 19,\n\tfinalSummaryDocuments: 20,\n\tstoreDocument: 21,\n\tproductCompilation: 22,\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Mark = {\n\tundefined: 0,\n\twaiting: 1,\n\tsuccess: 2,\n\trenew: 3,\n\tignored: 4,\n\tfailed: 5\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Delivery = {\n\tundefined: 0,\n\ttaxiEstimationRequest: 1,\n\ttaxiCallRequest: 2,\n\ttaxiCancelledByManager: 3,\n\ttaxiCancelledByDriver: 4,\n\ttaxiPerformerNotFound: 5,\n\ttaxiSmsProviderIssue: 6,\n\ttaxiReturnedFinish: 7,\n\tdeliveryMessage: 101,\n\tdeliveryCalculation: 102,\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Order = {\n\tencourageBuyProducts: 100,\n}\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const EditorMode = {\n\tview: 1,\n\tedit: 2\n}\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Compilation = {\n\tproductList: 1,\n\torderExists: 2,\n\tcompilationViewed: 3,\n\tnewDealCreated: 4,\n}","import {Item as ItemType} from \"./types\";\n\n/** @memberof BX.Crm.Timeline */\nexport default class Item\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._data = {};\n\t\tthis._container = null;\n\t\tthis._wrapper = null;\n\t\n\t\tthis._typeCategoryId = null;\n\t\tthis._associatedEntityData = null;\n\t\tthis._associatedEntityTypeId = null;\n\t\tthis._associatedEntityId = null;\n\t\tthis._isContextMenuShown = false;\n\t\tthis._contextMenuButton = null;\n\t\n\t\tthis._activityEditor = null;\n\t\tthis._actions = [];\n\t\tthis._actionContainer = null;\n\t\n\t\tthis._isTerminated = false;\n\t\n\t\tthis._vueComponent = null;\n\t\tthis._vueComponentMountedNode = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = this.getSetting(\"container\");\n\n\t\tif(!BX.type.isPlainObject(settings['data']))\n\t\t{\n\t\t\tthrow \"Item. A required parameter 'data' is missing.\";\n\t\t}\n\t\tthis._data = settings['data'];\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\n\t\tthis._vueComponent = this.getSetting(\"vueComponent\");\n\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tgetData()\n\t{\n\t\treturn this._data;\n\t}\n\n\tsetData(data)\n\t{\n\t\tif(BX.type.isPlainObject(data))\n\t\t{\n\t\t\tthis._data = data;\n\t\t\tthis.clearCachedData();\n\t\t}\n\t}\n\n\tgetAssociatedEntityData()\n\t{\n\t\tif(this._associatedEntityData === null)\n\t\t{\n\t\t\tthis._associatedEntityData = BX.type.isPlainObject(this._data[\"ASSOCIATED_ENTITY\"])\n\t\t\t\t? this._data[\"ASSOCIATED_ENTITY\"] : {};\n\t\t}\n\n\t\treturn this._associatedEntityData;\n\t}\n\n\tgetAssociatedEntityTypeId()\n\t{\n\t\tif(this._associatedEntityTypeId === null)\n\t\t{\n\t\t\tthis._associatedEntityTypeId = BX.prop.getInteger(this._data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0)\n\t\t}\n\t\treturn this._associatedEntityTypeId;\n\t}\n\n\tgetAssociatedEntityId()\n\t{\n\t\tif(this._associatedEntityId === null)\n\t\t{\n\t\t\tthis._associatedEntityId = BX.prop.getInteger(this._data, \"ASSOCIATED_ENTITY_ID\", 0)\n\t\t}\n\t\treturn this._associatedEntityId;\n\t}\n\n\tsetAssociatedEntityData(associatedEntityData)\n\t{\n\t\tif(!BX.type.isPlainObject(associatedEntityData))\n\t\t{\n\t\t\tassociatedEntityData = {};\n\t\t}\n\n\t\tthis._data[\"ASSOCIATED_ENTITY\"] = associatedEntityData;\n\t\tthis.clearCachedData();\n\t}\n\n\thasPermissions()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\treturn BX.type.isPlainObject(entityData[\"PERMISSIONS\"]);\n\t}\n\n\tgetPermissions()\n\t{\n\t\treturn BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t}\n\n\tsetPermissions(permissions)\n\t{\n\t\tif(!BX.type.isPlainObject(this._data[\"ASSOCIATED_ENTITY\"]))\n\t\t{\n\t\t\tthis._data[\"ASSOCIATED_ENTITY\"] = {};\n\t\t}\n\t\tthis._data[\"ASSOCIATED_ENTITY\"][\"PERMISSIONS\"] = permissions;\n\t\tthis.clearCachedData();\n\t}\n\n\tgetTextDataParam(name)\n\t{\n\t\treturn BX.prop.getString(this._data, name, \"\");\n\t}\n\n\tgetObjectDataParam(name)\n\t{\n\t\treturn BX.prop.getObject(this._data, name, {});\n\t}\n\n\tgetArrayDataParam(name)\n\t{\n\t\treturn BX.prop.getArray(this._data, name, []);\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.undefined;\n\t}\n\n\tgetTypeCategoryId()\n\t{\n\t\tif(this._typeCategoryId === null)\n\t\t{\n\t\t\tthis._typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\t}\n\t\treturn this._typeCategoryId;\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this._container;\n\t}\n\n\tsetContainer(container)\n\t{\n\t\tthis._container = BX.type.isElementNode(container) ? container : null;\n\t}\n\n\tgetWrapper()\n\t{\n\t\treturn this._wrapper;\n\t}\n\n\taddWrapperClass(className, timeout)\n\t{\n\t\tif(!this._wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.addClass(this._wrapper, className);\n\n\t\tif(BX.type.isNumber(timeout) && timeout >= 0)\n\t\t{\n\t\t\twindow.setTimeout(\n\t\t\t\tBX.delegate(\n\t\t\t\t\tfunction(){ this.removeWrapperClass(className); },\n\t\t\t\t\tthis\n\t\t\t\t),\n\t\t\t\ttimeout\n\t\t\t);\n\t\t}\n\t}\n\n\tremoveWrapperClass(className, timeout)\n\t{\n\t\tif(!this._wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._wrapper, className);\n\n\t\tif(BX.type.isNumber(timeout) && timeout >= 0)\n\t\t{\n\t\t\twindow.setTimeout(\n\t\t\t\tBX.delegate(\n\t\t\t\t\tfunction(){ this.addWrapperClass(className); },\n\t\t\t\t\tthis\n\t\t\t\t),\n\t\t\t\ttimeout\n\t\t\t);\n\t\t}\n\n\t}\n\n\tlayout(options)\n\t{\n\t\tif(!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Item. Container is not assigned.\";\n\t\t}\n\n\t\tthis.prepareLayout(options);\n\t\t//region Actions\n\t\t/**/\n\t\tthis.prepareActions();\n\t\tconst actionQty = this._actions.length;\n\t\tfor(let i = 0; i < actionQty; i++)\n\t\t{\n\t\t\tthis._actions[i].layout();\n\t\t}\n\t\tthis.showActions(actionQty > 0);\n\t\t/**/\n\t\t//endregion\n\t}\n\n\tmakeVueComponent(options, mode)\n\t{\n\t\tif (this._vueComponentMountedNode)\n\t\t{\n\t\t\treturn this._vueComponentMountedNode;\n\t\t}\n\n\t\tif (!this._vueComponent)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst app = new this._vueComponent(\n\t\t\t{\n\t\t\t\tpropsData: {\n\t\t\t\t\tself: this,\n\t\t\t\t\tlangMessages: Item.messages,\n\t\t\t\t\tmode: mode\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tapp.$mount();\n\n\t\tthis._vueComponentMountedNode = app.$el;\n\t\treturn this._vueComponentMountedNode;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t}\n\n\tclearLayout()\n\t{\n\t\tthis._wrapper = BX.remove(this._wrapper);\n\t}\n\n\trefreshLayout()\n\t{\n\t\tconst anchor = this._wrapper.previousSibling;\n\t\tthis._wrapper = BX.remove(this._wrapper);\n\t\tthis._playerWrappers = {};\n\t\tthis.layout({ anchor: anchor });\n\t}\n\n\tclearCachedData()\n\t{\n\t\tthis._typeCategoryId = null;\n\t\tthis._associatedEntityData = null;\n\t\tthis._associatedEntityTypeId = null;\n\t\tthis._associatedEntityId = null;\n\t}\n\n\tisDone()\n\t{\n\t\treturn false;\n\t}\n\n\tmarkAsDone(isDone)\n\t{\n\t}\n\n\tisTerminated()\n\t{\n\t\treturn this._isTerminated;\n\t}\n\n\tmarkAsTerminated(terminated)\n\t{\n\t\tterminated = !!terminated;\n\n\t\tif(this._isTerminated === terminated)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isTerminated = terminated;\n\t\tif(!this._wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(terminated)\n\t\t{\n\t\t\tBX.addClass(this._wrapper, \"crm-entity-stream-section-last\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.removeClass(this._wrapper, \"crm-entity-stream-section-last\");\n\t\t}\n\t}\n\n\tview()\n\t{\n\t}\n\n\tedit()\n\t{\n\t}\n\n\tfasten()\n\t{\n\t}\n\n\tunfasten()\n\t{\n\t}\n\n\tremove()\n\t{\n\t}\n\n\tcutOffText(text, length)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn text.substring(0, offset);\n\t}\n\n\tprepareMultilineCutOffElements(text, length, clickHandler)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn [BX.util.htmlspecialchars(text).replace(/(?:\\r\\n|\\r|\\n)/g, '<br>')];\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn(\n\t\t\t[\n\t\t\t\tBX.util.htmlspecialchars(text.substring(0, offset)).replace(/(?:\\r\\n|\\r|\\n)/g, '<br>') + \"&hellip;&nbsp;\" ,\n\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-letter-more\", href: \"#\" },\n\t\t\t\t\t\tevents: { click: clickHandler },\n\t\t\t\t\t\ttext: this.getMessage(\"details\")\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t]\n\t\t);\n\t}\n\n\tprepareCutOffElements(text, length, clickHandler)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn [BX.util.htmlspecialchars(text)];\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn(\n\t\t\t[\n\t\t\t\tBX.util.htmlspecialchars(text.substring(0, offset)) + \"&hellip;&nbsp;\" ,\n\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-letter-more\", href: \"#\" },\n\t\t\t\t\t\tevents: { click: clickHandler },\n\t\t\t\t\t\ttext: this.getMessage(\"details\")\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t]\n\t\t);\n\t}\n\n\tprepareAuthorLayout()\n\t{\n\t\tconst authorInfo = this.getObjectDataParam(\"AUTHOR\", null);\n\t\tif(!authorInfo)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst showUrl = BX.prop.getString(authorInfo, \"SHOW_URL\", \"\");\n\t\tif(showUrl === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst link = BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"ui-icon ui-icon-common-user crm-entity-stream-content-detail-employee\",\n\t\t\t\t\t\thref: showUrl,\n\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\ttitle: BX.prop.getString(authorInfo, \"FORMATTED_NAME\", \"\")\n\t\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create('i', {})\n\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tconst imageUrl = BX.prop.getString(authorInfo, \"IMAGE_URL\", \"\");\n\t\tif(imageUrl !== \"\")\n\t\t{\n\t\t\tlink.children[0].style.backgroundImage = \"url('\" + imageUrl + \"')\";\n\t\t\tlink.children[0].style.backgroundSize = \"21px\";\n\t\t}\n\n\t\treturn link;\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tprepareContextMenuButton()\n\t{\n\t\tthis._contextMenuButton = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section-context-menu\" },\n\t\t\t\tevents: { click: BX.delegate(this.onContextMenuButtonClick, this) }\n\t\t\t}\n\t\t);\n\t\treturn this._contextMenuButton;\n\t}\n\n\tonContextMenuButtonClick(e)\n\t{\n\t\tif(!this._isContextMenuShown)\n\t\t{\n\t\t\tthis.openContextMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.closeContextMenu();\n\t\t}\n\t}\n\n\topenContextMenu()\n\t{\n\t\tconst menuItems = this.prepareContextMenuItems();\n\n\t\tif (typeof IntranetExtensions !== \"undefined\")\n\t\t{\n\t\t\tmenuItems.push(IntranetExtensions);\n\t\t}\n\t\n\t\tif(menuItems.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._contextMenuButton,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onContextMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onContextMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onContextMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis._contextMenu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseContextMenu()\n\t{\n\t\tif(this._contextMenu)\n\t\t{\n\t\t\tthis._contextMenu.close();\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\treturn [];\n\t}\n\n\tonContextMenuShow()\n\t{\n\t\tthis._isContextMenuShown = true;\n\t\tBX.addClass(this._contextMenuButton, \"active\");\n\t}\n\n\tonContextMenuClose()\n\t{\n\t\tif(this._contextMenu)\n\t\t{\n\t\t\tthis._contextMenu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonContextMenuDestroy()\n\t{\n\t\tthis._isContextMenuShown = false;\n\t\tBX.removeClass(this._contextMenuButton, \"active\");\n\t\tthis._contextMenu = null;\n\t\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Item.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic getUserTimezoneOffset()\n\t{\n\t\tif(!this.userTimezoneOffset)\n\t\t{\n\t\t\tthis.userTimezoneOffset = parseInt(BX.message(\"USER_TZ_OFFSET\"));\n\t\t\tif(isNaN(this.userTimezoneOffset))\n\t\t\t{\n\t\t\t\tthis.userTimezoneOffset = 0;\n\t\t\t}\n\t\t}\n\t\treturn this.userTimezoneOffset;\n\t}\n\t\n\tstatic userTimezoneOffset;\n\t\n\tstatic messages = {};\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Fasten\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultValue)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultValue;\n\t}\n\n\taddFixedHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\t\tBX.addClass(node, 'crm-entity-stream-section-animate-start');\n\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\t\tsetTimeout( BX.delegate(\n\t\t\tfunction() {\n\t\t\t\tBX.removeClass(node, 'crm-entity-stream-section-animate-start');\n\t\t\t},\n\t\t\tthis\n\t\t), 0);\n\t\tthis._finalItem.onFinishFasten();\n\t}\n\n\trun()\n\t{\n\t\tconst node = this._initialItem.getWrapper();\n\t\tthis._clone = node.cloneNode(true);\n\n\t\tBX.addClass(this._clone, 'crm-entity-stream-section-animate-start crm-entity-stream-section-top-fixed');\n\n\t\tthis._startPosition = BX.pos(node);\n\t\tthis._clone.style.position = \"absolute\";\n\t\tthis._clone.style.width = this._startPosition.width + \"px\";\n\n\t\tlet _cloneHeight = this._startPosition.height;\n\t\tconst _minHeight = 65;\n\t\tconst _sumPaddingContent = 18;\n\t\tif (_cloneHeight < _sumPaddingContent + _minHeight)\n\t\t\t_cloneHeight = _sumPaddingContent + _minHeight;\n\n\t\tthis._clone.style.height = _cloneHeight + \"px\";\n\t\tthis._clone.style.top = this._startPosition.top + \"px\";\n\t\tthis._clone.style.left = this._startPosition.left + \"px\";\n\t\tthis._clone.style.zIndex = 960;\n\n\t\tdocument.body.appendChild(this._clone);\n\n\t\tsetTimeout(\n\t\t\tBX.proxy(\n\t\t\t\tfunction (){\n\t\t\t\t\tBX.addClass(this._clone, \"crm-entity-stream-section-casper\" )\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t),\n\t\t\t0\n\t\t);\n\n\t\tthis._anchorPosition = BX.pos(this._anchor);\n\t\tconst finish = {\n\t\t\ttop: this._anchorPosition.top,\n\t\t\theight: _cloneHeight + 15,\n\t\t\topacity: 1\n\t\t};\n\n\t\tconst _difference = this._startPosition.top - this._anchorPosition.bottom;\n\t\tconst _deepHistoryLimit = 2 * (document.body.clientHeight + this._startPosition.height);\n\n\t\tif (_difference > _deepHistoryLimit)\n\t\t{\n\t\t\tfinish.top = this._startPosition.top - _deepHistoryLimit;\n\t\t\tfinish.opacity = 0;\n\t\t}\n\n\t\tlet _duration = Math.abs(finish.top - this._startPosition.top) * 2;\n\t\t_duration = (_duration < 1500) ? 1500 : _duration;\n\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: _duration,\n\t\t\tstart: {top: this._startPosition.top, height: 0, opacity: 1},\n\t\t\tfinish: finish,\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._clone.style.top = state.top + \"px\";\n\t\t\t\tthis._clone.style.opacity = state.opacity;\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.finish();\n\t\t\t}, this)\n\t\t});\n\t\tmovingEvent.animate();\n\t}\n\n\tfinish()\n\t{\n\t\tthis._anchor.style.height = 0;\n\t\tthis.addFixedHistoryItem();\n\t\tBX.remove(this._clone);\n\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Fasten();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Item from \"../item\";\nimport {Item as ItemType} from \"../types\";\nimport Fasten from \"../animations/fasten\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class History extends Item\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._history = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._typeId = null;\n\t\tthis._createdTime = null;\n\t\tthis._isFixed = false;\n\t\tthis._headerClickHandler = BX.delegate(this.onHeaderClick, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._history = this.getSetting(\"history\");\n\t\tthis._fixedHistory = this.getSetting(\"fixedHistory\");\n\t}\n\n\tgetTypeId()\n\t{\n\t\tif(this._typeId === null)\n\t\t{\n\t\t\tthis._typeId = BX.prop.getInteger(this._data, \"TYPE_ID\", ItemType.undefined);\n\t\t}\n\t\treturn this._typeId;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn \"\";\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn !(this.isReadOnly());\n\t}\n\n\tgetCreatedTimestamp()\n\t{\n\t\treturn this.getTextDataParam(\"CREATED_SERVER\");\n\t}\n\n\tgetCreatedTime()\n\t{\n\t\tif(this._createdTime === null)\n\t\t{\n\t\t\tconst time = BX.parseDate(\n\t\t\t\tthis.getCreatedTimestamp(),\n\t\t\t\tfalse,\n\t\t\t\t\"YYYY-MM-DD\",\n\t\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t\t);\n\n\t\t\tthis._createdTime = new Date(time.getTime() + 1000 * Item.getUserTimezoneOffset());\n\t\t}\n\t\treturn this._createdTime;\n\t}\n\n\tgetCreatedDate()\n\t{\n\t\treturn BX.prop.extractDate(new Date(this.getCreatedTime().getTime()));\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._history ? this._history.getOwnerInfo() : null;\n\t}\n\n\tgetOwnerTypeId()\n\t{\n\t\treturn BX.prop.getInteger(this.getOwnerInfo(), \"ENTITY_TYPE_ID\", BX.CrmEntityType.enumeration.undefined);\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn BX.prop.getInteger(this.getOwnerInfo(), \"ENTITY_ID\", 0);\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._history.isReadOnly();\n\t}\n\n\tisEditable()\n\t{\n\t\treturn !this.isReadOnly();\n\t}\n\n\tisDone()\n\t{\n\t\tconst typeId = this.getTypeId();\n\t\tif(typeId === ItemType.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\treturn BX.CrmActivityStatus.isFinal(BX.prop.getInteger(entityData, \"STATUS\", 0));\n\t\t}\n\t\treturn false;\n\t}\n\n\tisFixed()\n\t{\n\t\treturn this._isFixed;\n\t}\n\n\tfasten(e)\n\t{\n\t\tif (this._fixedHistory._items.length >= 3)\n\t\t{\n\t\t\tif (!this.fastenLimitPopup)\n\t\t\t{\n\t\t\t\tthis.fastenLimitPopup = new BX.PopupWindow(\n\t\t\t\t\t'timeline_fasten_limit_popup_' + this._id,\n\t\t\t\t\tthis._switcher,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_FASTEN_LIMIT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: true,\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.fastenLimitPopup.show();\n\t\t\tthis.closeContextMenu();\n\t\t\treturn;\n\t\t}\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"CHANGE_FASTEN_ITEM\",\n\t\t\t\t\t\t\"VALUE\": 'Y',\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this._id\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSuccessFasten, this)\n\t\t\t}\n\t\t);\n\n\t\tthis.closeContextMenu();\n\t}\n\n\tonSuccessFasten(result)\n\t{\n\t\tif (BX.type.isNotEmptyString(result.ERROR))\n\t\t\treturn;\n\n\t\tif (!this.isFixed())\n\t\t{\n\t\t\tthis._data.IS_FIXED = 'Y';\n\t\t\tconst fixedItem = this._fixedHistory.createItem(this._data);\n\t\t\tfixedItem._isFixed = true;\n\t\t\tthis._fixedHistory.addItem(fixedItem, 0);\n\t\t\tfixedItem.layout({ add: false });\n\t\t\tthis.refreshLayout();\n\t\t\tconst animation = Fasten.create(\n\t\t\t\t\"\",\n\t\t\t\t{\n\t\t\t\t\tinitialItem: this,\n\t\t\t\t\tfinalItem: fixedItem,\n\t\t\t\t\tanchor: this._fixedHistory._anchor\n\t\t\t\t}\n\t\t\t);\n\t\t\tanimation.run();\n\t\t}\n\n\t\tthis.closeContextMenu();\n\t}\n\n\tonFinishFasten(e)\n\t{\n\t}\n\n\tunfasten(e)\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"CHANGE_FASTEN_ITEM\",\n\t\t\t\t\t\t\"VALUE\": 'N',\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this._id\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSuccessUnfasten, this)\n\t\t\t}\n\t\t);\n\n\t\tthis.closeContextMenu();\n\t}\n\n\tonSuccessUnfasten(result)\n\t{\n\t\tif (BX.type.isNotEmptyString(result.ERROR))\n\t\t\treturn;\n\n\t\tlet item;\n\t\tlet historyItem;\n\n\t\tif (this.isFixed())\n\t\t{\n\t\t\titem = this;\n\t\t\thistoryItem = this._history.findItemById(this._id);\n\t\t}\n\t\telse\n\t\t{\n\t\t\titem = this._fixedHistory.findItemById(this._id);\n\t\t\thistoryItem = this;\n\t\t}\n\n\t\tif (item)\n\t\t{\n\t\t\tconst index = this._fixedHistory.getItemIndex(item);\n\t\t\titem.clearAnimate();\n\t\t\tthis._fixedHistory.removeItemByIndex(index);\n\t\t\tif (historyItem)\n\t\t\t{\n\t\t\t\thistoryItem._data.IS_FIXED = 'N';\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t\tBX.LazyLoad.showImages();\n\t\t\t}\n\t\t}\n\t}\n\n\tclearAnimate()\n\t{\n\t\tif (!BX.type.isDomNode(this._wrapper))\n\t\t\treturn ;\n\n\t\tconst wrapperPosition = BX.pos(this._wrapper);\n\t\tconst hideEvent = new BX.easing({\n\t\t\tduration: 1000,\n\t\t\tstart: {height: wrapperPosition.height, opacity: 1, marginBottom: 15},\n\t\t\tfinish: {height: 0, opacity: 0, marginBottom: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._wrapper.style.height = state.height + \"px\";\n\t\t\t\tthis._wrapper.style.opacity = state.opacity;\n\t\t\t\tthis._wrapper.style.marginBottom = state.marginBottom;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.clearLayout();\n\t\t\t}, this)\n\t\t});\n\n\t\thideEvent.animate();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\treturn [];\n\t}\n\n\tprepareContent()\n\t{\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history\";\n\t\t}\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: this.getIconClassName() } }));\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-content\" }, children: [ contentWrapper ] }\n\t\t\t)\n\t\t);\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-time\"},\n\t\t\t\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tcontentWrapper.appendChild(header);\n\n\t\tcontentWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: this.prepareContentDetails()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t\tconst vueComponent = this.makeVueComponent(options, 'history');\n\t\tthis._wrapper = vueComponent ? vueComponent : this.prepareContent();\n\t\tif(this._wrapper)\n\t\t{\n\t\t\tconst enableAdd = BX.type.isPlainObject(options) ? BX.prop.getBoolean(options, \"add\", true) : true;\n\t\t\tif(enableAdd)\n\t\t\t{\n\t\t\t\tconst anchor = BX.type.isPlainObject(options) && BX.type.isElementNode(options[\"anchor\"]) ? options[\"anchor\"] : null;\n\t\t\t\tif(anchor && anchor.nextSibling)\n\t\t\t\t{\n\t\t\t\t\tthis._container.insertBefore(this._wrapper,  anchor.nextSibling);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._container.appendChild(this._wrapper);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.markAsTerminated(this._history.checkItemForTermination(this));\n\t\t}\n\t}\n\n\tonHeaderClick(e)\n\t{\n\t\tthis.view();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-event-title\" }, text: this.getTitle() });\n\t}\n\n\tprepareFixedSwitcherLayout()\n\t{\n\t\tconst isFixed = (this.getTextDataParam(\"IS_FIXED\") === 'Y');\n\t\tthis._switcher = BX.create(\"span\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section-top-fixed-btn\" },\n\t\t\t\tevents: {\n\t\t\t\t\tclick: isFixed ? BX.delegate(this.unfasten, this) : BX.delegate(this.fasten, this)\n\t\t\t\t}\n\t\t\t});\n\t\tif (isFixed)\n\t\t\tBX.addClass(this._switcher, \"crm-entity-stream-section-top-fixed-btn-active\");\n\n\t\tif (!this.isReadOnly() && !isFixed)\n\t\t{\n\t\t\tconst manager = this._history.getManager();\n\t\t\tif (!manager.isSpotlightShowed())\n\t\t\t{\n\t\t\t\tmanager.setSpotlightShowed();\n\t\t\t\tBX.addClass(this._switcher, \"crm-entity-stream-section-top-fixed-btn-spotlight\");\n\t\t\t\tconst spotlight = new BX.SpotLight({\n\t\t\t\t\ttargetElement: this._switcher,\n\t\t\t\t\ttargetVertex: \"middle-center\",\n\t\t\t\t\tlightMode: false,\n\t\t\t\t\tid: \"CRM_TIMELINE_FASTEN_SWITCHER\",\n\t\t\t\t\tzIndex: 900,\n\t\t\t\t\ttop: -3,\n\t\t\t\t\tleft: -1,\n\t\t\t\t\tautoSave: true,\n\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_SPOTLIGHT_FASTEN_MESSAGE')\n\t\t\t\t});\n\t\t\t\tspotlight.show();\n\t\t\t}\n\t\t}\n\n\t\treturn this._switcher;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t\tthis._history.getManager().onActivityCreated(activity, data);\n\t}\n\n\tformatTime(time)\n\t{\n\t\tif (this.isFixed())\n\t\t{\n\t\t\treturn this._fixedHistory.formatTime(time);\n\t\t}\n\n\t\treturn this._history.formatTime(time);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new History();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic isCounterEnabled(deadline)\n\t{\n\t\tif(!BX.type.isDate(deadline))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet start = new Date();\n\t\tstart.setHours(0);\n\t\tstart.setMinutes(0);\n\t\tstart.setSeconds(0);\n\t\tstart.setMilliseconds(0);\n\t\tstart = start.getTime();\n\n\t\tlet end = new Date();\n\t\tend.setHours(23);\n\t\tend.setMinutes(59);\n\t\tend.setSeconds(59);\n\t\tend.setMilliseconds(999);\n\t\tend = end.getTime();\n\n\t\tconst time = deadline.getTime();\n\t\treturn time < start || (time >= start && time <= end);\n\t}\n}\n","import HistoryItem from \"../items/history\";\n\nexport default {\n\tprops: {\n\t\tself: {\n\t\t\trequired: true,\n\t\t\ttype: Object\n\t\t},\n\t\tlangMessages: {\n\t\t\trequired: false,\n\t\t\ttype: Object\n\t\t},\n\t},\n\tcomputed: {\n\t\tdata()\n\t\t{\n\t\t\treturn this.self._data;\n\t\t},\n\t\tfields()\n\t\t{\n\t\t\treturn this.data.FIELDS ? this.data.FIELDS : null;\n\t\t},\n\t\tauthor()\n\t\t{\n\t\t\treturn this.data.AUTHOR ? this.data.AUTHOR : null;\n\t\t},\n\t\tcreatedAt()\n\t\t{\n\t\t\treturn (this.self instanceof HistoryItem) ? this.self.formatTime(this.self.getCreatedTime()) : '';\n\t\t},\n\t},\n\tmethods: {\n\t\tgetLangMessage(key)\n\t\t{\n\t\t\treturn this.langMessages.hasOwnProperty(key) ? this.langMessages[key] : key;\n\t\t}\n\t}\n};\n","import {UI} from 'ui.notification';\nimport {Loc} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {Vue} from 'ui.vue';\n\nexport default {\n\tdata()\n\t{\n\t\treturn {\n\t\t\tnotificationBalloon: false,\n\t\t\tactiveRequestsCnt: 0,\n\t\t\tdealId: null,\n\t\t\tproducts: [],\n\t\t};\n\t},\n\n\tmethods: {\n\t\tisProductsGridAvailable()\n\t\t{\n\t\t\treturn !!this.productsGrid;\n\t\t},\n\t\tsetProductsGrid(productsGrid)\n\t\t{\n\t\t\tthis.productsGrid = productsGrid;\n\t\t\tif (this.productsGrid)\n\t\t\t{\n\t\t\t\tthis.onProductsGridChanged();\n\t\t\t}\n\t\t},\n\t\t// region event handlers\n\t\thandleProductAddingToDeal()\n\t\t{\n\t\t\tthis.activeRequestsCnt += 1;\n\t\t},\n\t\thandleProductAddedToDeal()\n\t\t{\n\t\t\tif (this.activeRequestsCnt > 0)\n\t\t\t{\n\t\t\t\tthis.activeRequestsCnt -= 1;\n\t\t\t}\n\n\t\t\tif (!(this.activeRequestsCnt === 0 && this.productsGrid))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.Crm.EntityEditor.getDefault().reload();\n\t\t\tthis.productsGrid.reloadGrid(false);\n\n\t\t\tif (!this.notificationBalloon || this.notificationBalloon.getState() !== BX.UI.Notification.State.OPEN)\n\t\t\t{\n\t\t\t\tthis.notificationBalloon = UI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_PRODUCTS_ADDED_TO_DEAL'),\n\t\t\t\t\tactions: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_EDIT_PRODUCTS'),\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: (event, balloon, action) => {\n\t\t\t\t\t\t\t\t\tBX.onCustomEvent(window, 'OpenEntityDetailTab', ['tab_products']);\n\t\t\t\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t// endregion\n\t\t// region custom events\n\t\tsubscribeCustomEvents()\n\t\t{\n\t\t\tEventEmitter.subscribe('EntityProductListController', this.onProductsGridCreated);\n\t\t\tEventEmitter.subscribe('BX.Crm.EntityEditor:onSave', this.onProductsGridChanged);\n\t\t},\n\t\tunsubscribeCustomEvents()\n\t\t{\n\t\t\tEventEmitter.unsubscribe('EntityProductListController', this.onProductsGridCreated);\n\t\t\tEventEmitter.unsubscribe('BX.Crm.EntityEditor:onSave', this.onProductsGridChanged);\n\t\t},\n\t\tonProductsGridCreated(event: BaseEvent)\n\t\t{\n\t\t\tthis.setProductsGrid(event.getData()[0]);\n\t\t},\n\t\tonProductsGridChanged(event: BaseEvent)\n\t\t{\n\t\t\tif (!this.productsGrid)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet dealOfferIds = this.productsGrid.products.map((product, index) => {\n\t\t\t\tif (!(product.hasOwnProperty('fields') && product.fields.hasOwnProperty('OFFER_ID')))\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn product.fields.OFFER_ID;\n\t\t\t});\n\n\t\t\tfor (const [i, product] of this.products.entries())\n\t\t\t{\n\t\t\t\tlet isInDeal = dealOfferIds.some(id => parseInt(id) === parseInt(product.offerId));\n\n\t\t\t\tif (product.isInDeal === isInDeal)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tVue.set(this.products, i, Object.assign({}, product, {isInDeal}));\n\t\t\t}\n\t\t},\n\t\t// endregion\n\t\tbeforeDestroy()\n\t\t{\n\t\t\tthis.unsubscribeCustomEvents();\n\t\t}\n\t},\n}","import {ajax, Loc} from 'main.core';\nimport 'currency';\nimport './styles.css';\n\nexport default {\n\tprops: {\n\t\tproduct: {\n\t\t\trequired: true,\n\t\t\ttype: Object,\n\t\t},\n\t\tdealId: {\n\t\t\trequired: true,\n\t\t\ttype: Number,\n\t\t},\n\t\tisAddToDealVisible: {\n\t\t\trequired: true,\n\t\t\ttype: Boolean,\n\t\t},\n\t},\n\tmethods: {\n\t\taddProductToDeal()\n\t\t{\n\t\t\tif (this.product.isInDeal)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('product-adding-to-deal');\n\t\t\tthis.product.isInDeal = true;\n\n\t\t\tajax.runAction(\n\t\t\t\t'crm.timeline.encouragebuyproducts.addproducttodeal',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tdealId: this.dealId,\n\t\t\t\t\t\tproductId: this.product.offerId,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tprice: this.product.price\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then((result) => {\n\t\t\t\tthis.$emit('product-added-to-deal');\n\t\t\t\tthis.product.isInDeal = true;\n\t\t\t}).catch((result) => {\n\t\t\t\tthis.product.isInDeal = false;\n\t\t\t});\n\t\t},\n\t\topenDetailPage()\n\t\t{\n\t\t\tif (BX.type.isNotEmptyString(this.product.adminLink))\n\t\t\t{\n\t\t\t\tif (this.product?.slider === 'N')\n\t\t\t\t{\n\t\t\t\t\twindow.open(this.product.adminLink, '_blank');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBX.SidePanel.Instance.open(this.product.adminLink);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tcomputed: {\n\t\tisBottomAreaVisible()\n\t\t{\n\t\t\treturn this.isVariationInfoVisible || this.isPriceVisible;\n\t\t},\n\t\tisVariationInfoVisible()\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.product.hasOwnProperty('variationInfo')\n\t\t\t\t&& this.product.variationInfo\n\t\t\t);\n\t\t},\n\t\tisPriceVisible()\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.product.hasOwnProperty('price')\n\t\t\t\t&& this.product.hasOwnProperty('currency')\n\t\t\t\t&& this.product.price\n\t\t\t\t&& this.product.currency\n\t\t\t);\n\t\t},\n\t\tprice()\n\t\t{\n\t\t\treturn BX.Currency.currencyFormat(this.product.price, this.product.currency, true);\n\t\t},\n\t\timageStyle()\n\t\t{\n\t\t\tif (!this.product.image)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: 'url(' + this.product.image + ')'\n\t\t\t};\n\t\t},\n\t\tbuttonText()\n\t\t{\n\t\t\treturn Loc.getMessage(\n\t\t\t\tthis.product.isInDeal\n\t\t\t\t\t? 'CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_PRODUCT_IN_DEAL'\n\t\t\t\t\t: 'CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_ADD_PRODUCT_TO_DEAL'\n\t\t\t);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<li\n\t\t\t:class=\"{'crm-entity-stream-advice-list-item--active': product.isInDeal}\"\n\t\t\tclass=\"crm-entity-stream-advice-list-item\"\n\t\t>\t\n\t\t\t<div class=\"crm-entity-stream-advice-list-content\">\n\t\t\t\t<div\t\n\t\t\t\t\t:style=\"imageStyle\"\n\t\t\t\t\tclass=\"crm-entity-stream-advice-list-icon\"\n\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-entity-stream-advice-list-inner\">\n\t\t\t\t\t<a\n\t\t\t\t\t\t@click.prevent=\"openDetailPage\"\n\t\t\t\t\t\thref=\"#\"\n\t\t\t\t\t\tclass=\"crm-entity-stream-advice-list-name\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{product.name}}\n\t\t\t\t\t</a>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"isBottomAreaVisible\"\n\t\t\t\t\t\tclass=\"crm-entity-stream-advice-list-desc-box\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"isVariationInfoVisible\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-advice-list-desc-name\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{product.variationInfo}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"isPriceVisible\"\n\t\t\t\t\t\t\tv-html=\"price\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-advice-list-desc-value\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"isAddToDealVisible\" class=\"crm-entity-stream-advice-list-btn-box\">\n\t\t\t\t<button\n\t\t\t\t\t@click=\"addProductToDeal\"\n\t\t\t\t\tclass=\"ui-btn ui-btn-round ui-btn-xs crm-entity-stream-advice-list-btn\"\n\t\t\t\t>\n\t\t\t\t\t{{buttonText}}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</li>\n\t`\n}\n","import {Loc} from 'main.core';\nimport Product from './product';\nimport './styles.css';\n\nexport default {\n\tprops: {\n\t\tproducts: [],\n\t\tdealId: null,\n\t\tisAddToDealVisible: false,\n\t},\n\n\tdata()\n\t{\n\t\treturn {\n\t\t\tisShortList: true,\n\t\t\tshortListProductsCnt: 3,\n\t\t};\n\t},\n\n\tcomponents: {\n\t\t'product': Product,\n\t},\n\n\tmethods: {\n\t\tonProductAddedToDeal()\n\t\t{\n\t\t\tthis.$emit('product-added-to-deal');\n\t\t},\n\n\t\tonProductAddingToDeal()\n\t\t{\n\t\t\tthis.$emit('product-adding-to-deal');\n\t\t},\n\n\t\tshowMore()\n\t\t{\n\t\t\tthis.isShortList = false;\n\t\t\tconst listWrap = this.$refs.adviceList;\n\t\t\tlistWrap.style.maxHeight = 950 + 'px';\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tisShowMoreVisible()\n\t\t{\n\t\t\treturn this.isShortList && this.products.length > this.shortListProductsCnt;\n\t\t},\n\n\t\tvisibleProducts()\n\t\t{\n\t\t\tlet result = [];\n\n\t\t\tconst length =\n\t\t\t\tthis.isShortList && this.shortListProductsCnt < this.products.length\n\t\t\t\t\t? this.shortListProductsCnt\n\t\t\t\t\t: this.products.length\n\t\t\t;\n\t\t\tfor (let productIndex = 0; productIndex < length; productIndex++)\n\t\t\t{\n\t\t\t\tresult.push(this.products[productIndex]);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<transition-group ref=\"adviceList\" class=\"crm-entity-stream-advice-list\" name=\"list\" tag=\"ul\">\n\t\t\t\t<product\n\t\t\t\t\tv-for=\"product in visibleProducts\"\n\t\t\t\t\tv-bind:key=\"product.offerId\"\n\t\t\t\t\t:product=\"product\"\n\t\t\t\t\t:dealId=\"dealId\"\n\t\t\t\t\t:isAddToDealVisible=\"isAddToDealVisible\"\n\t\t\t\t\t@product-added-to-deal=\"onProductAddedToDeal\"\n\t\t\t\t\t@product-adding-to-deal=\"onProductAddingToDeal\"\n\t\t\t\t></product>\n\t\t\t</transition-group>\n\t\t\t<!--</ul>-->\n\t\t\t<a\n\t\t\t\tv-if=\"isShowMoreVisible\"\n\t\t\t\t@click.prevent=\"showMore\"\n\t\t\t\tclass=\"crm-entity-stream-advice-link\"\n\t\t\t\thref=\"#\"\n\t\t\t>\n\t\t\t\t${Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_SHOW_MORE')}\n\t\t\t</a>\n\t\t</div>\n\t`\n}\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\nimport HistoryItemMixin from '../mixins/history-item';\nimport ProductListMixin from '../mixins/product-list';\nimport ProductList from '../components/product/product-list';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin, ProductListMixin],\n\tcomponents: {\n\t\t'product-list': ProductList,\n\t},\n\tcreated() {\n\t\tthis.products = this.data.VIEWED_PRODUCTS;\n\t\tthis.dealId = this.data.DEAL_ID;\n\t\tthis.productsGrid = null;\n\t\tthis.subscribeCustomEvents();\n\t\tBX.Crm.EntityEditor.getDefault().tapController('PRODUCT_LIST', (controller) => {\n\t\t\tthis.setProductsGrid(controller.getProductList());\n\t\t});\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-advice\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-advice\"></div>\n\t\t\t<div class=\"crm-entity-stream-advice-content\">\n\t\t\t\t<div class=\"crm-entity-stream-advice-info\">\n\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_LOOK_AT_CLIENT_PRODUCTS')}\n\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_ENCOURAGE_CLIENT_BUY_PRODUCTS_2')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-entity-stream-advice-inner\">\n\t\t\t\t\t<h3 class=\"crm-entity-stream-advice-subtitle\">\n\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_VIEWED_PRODUCTS')}\n\t\t\t\t\t</h3>\n\t\t\t\t\t<!--<ul class=\"crm-entity-stream-advice-list\">-->\n\t\t\t\t\t<product-list\n\t\t\t\t\t\t:products=\"products\"\n\t\t\t\t\t\t:dealId=\"dealId\"\n\t\t\t\t\t\t:isAddToDealVisible=\"isProductsGridAvailable\"\n\t\t\t\t\t\t@product-added-to-deal=\"handleProductAddedToDeal\"\n\t\t\t\t\t\t@product-adding-to-deal=\"handleProductAddingToDeal\"\n\t\t\t\t\t></product-list>\n\t\t\t\t\t<!--</ul>-->\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","export default {\n\tprops: {\n\t\tauthor: {\n\t\t\trequired: true,\n\t\t\ttype: Object\n\t\t},\n\t},\n\tcomputed: {\n\t\tiStyle()\n\t\t{\n\t\t\tif (!this.author.IMAGE_URL)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t'background-image': 'url(' + this.author.IMAGE_URL + ')',\n\t\t\t\t'background-size': '21px',\n\t\t\t};\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<a\n\t\t\tv-if=\"author.SHOW_URL\"\n\t\t\t:href=\"author.SHOW_URL\"\n\t\t\ttarget=\"_blank\"\n\t\t\t:title=\"author.FORMATTED_NAME\"\n\t\t\tclass=\"ui-icon ui-icon-common-user crm-entity-stream-content-detail-employee\"\n\t\t>\n\t\t\t<i :style=\"iStyle\"></i>\t\n\t\t</a>\n\t`\n};\n","import {Vue} from 'ui.vue';\nimport HistoryItemMixin from '../mixins/history-item';\nimport Author from '../components/author';\nimport {ajax, Loc} from 'main.core';\nimport {PULL} from 'pull.client';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\tcomponents: {\n\t\t'author': Author,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tentityData: null,\n\t\t\tmessageId: null,\n\t\t\ttext: null,\n\t\t\ttitle: null,\n\t\t\tstatus: {\n\t\t\t\tname: null,\n\t\t\t\tsemantics: null,\n\t\t\t\tdescription: null,\n\t\t\t},\n\t\t\tprovider: null,\n\t\t\tisRefreshing: false,\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tthis.entityData = this.self.getAssociatedEntityData();\n\n\t\tif (this.entityData['MESSAGE_INFO'])\n\t\t{\n\t\t\tthis.setMessageInfo(this.entityData['MESSAGE_INFO']);\n\t\t}\n\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'notifications',\n\t\t\tcommand: 'message_update',\n\t\t\tcallback: (params) => {\n\t\t\t\tif (params.message.ID == this.messageId)\n\t\t\t\t{\n\t\t\t\t\tthis.refresh();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tif (this.entityData['PULL_TAG_NAME'])\n\t\t{\n\t\t\tPULL.extendWatch(this.entityData['PULL_TAG_NAME']);\n\t\t}\n\t},\n\tmethods: {\n\t\tsetMessageInfo(messageInfo)\n\t\t{\n\t\t\tthis.messageId = messageInfo['MESSAGE']['ID'];\n\n\t\t\tif (\n\t\t\t\tmessageInfo['HISTORY_ITEMS']\n\t\t\t\t&& Array.isArray(messageInfo['HISTORY_ITEMS'])\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'].length > 0\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'][0]\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'][0]['PROVIDER_DATA']\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'][0]['PROVIDER_DATA']['DESCRIPTION']\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.provider = messageInfo['HISTORY_ITEMS'][0]['PROVIDER_DATA']['DESCRIPTION'];\n\t\t\t\tthis.title = this.provider + ' ' + Loc.getMessage('CRM_TIMELINE_NOTIFICATION_MESSAGE');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.title = this.capitalizeFirstLetter(Loc.getMessage('CRM_TIMELINE_NOTIFICATION_MESSAGE'));\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tmessageInfo['HISTORY_ITEMS']\n\t\t\t\t&& Array.isArray(messageInfo['HISTORY_ITEMS'])\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'].length > 0\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'][0]\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'][0]['STATUS_DATA']\n\t\t\t\t&& messageInfo['HISTORY_ITEMS'][0]['STATUS_DATA']['DESCRIPTION']\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.status.name = messageInfo['HISTORY_ITEMS'][0]['STATUS_DATA']['DESCRIPTION'];\n\t\t\t\tthis.status.semantics = messageInfo['HISTORY_ITEMS'][0]['STATUS_DATA']['SEMANTICS'];\n\t\t\t\tthis.status.description = messageInfo['HISTORY_ITEMS'][0]['ERROR_MESSAGE'];\n\t\t\t}\n\n\t\t\tthis.text = messageInfo['MESSAGE']['TEXT']\n\t\t\t\t? messageInfo['MESSAGE']['TEXT']\n\t\t\t\t: Loc.getMessage('CRM_TIMELINE_NOTIFICATION_NO_MESSAGE_TEXT_2');\n\t\t},\n\t\trefresh()\n\t\t{\n\t\t\tif (this.isRefreshing)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isRefreshing = true;\n\n\t\t\tajax.runAction(\n\t\t\t\t'crm.timeline.notification.getmessageinfo',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmessageId: this.messageId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then((result) => {\n\t\t\t\tthis.setMessageInfo(result.data);\n\t\t\t\tthis.isRefreshing = false;\n\t\t\t}).catch((result) => {\n\t\t\t\tthis.isRefreshing = false;\n\t\t\t});\n\t\t},\n\t\tviewActivity()\n\t\t{\n\t\t\tthis.self.view();\n\t\t},\n\t\tcapitalizeFirstLetter(str, locale= navigator.language)\n\t\t{\n\t\t\treturn str.replace(/^\\p{CWU}/u, char => char.toLocaleUpperCase(locale));\n\t\t}\n\t},\n\tcomputed: {\n\t\tcommunication()\n\t\t{\n\t\t\treturn this.entityData['COMMUNICATION'] ? this.entityData['COMMUNICATION'] : null;\n\t\t},\n\t\tstatusClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-entity-stream-content-event-process': this.status.semantics === 'process',\n\t\t\t\t'crm-entity-stream-content-event-successful': this.status.semantics === 'success',\n\t\t\t\t'crm-entity-stream-content-event-missing': this.status.semantics === 'failure',\n\t\t\t\t'crm-entity-stream-content-event-error-tip': this.isStatusError,\n\t\t\t};\n\t\t},\n\t\tisStatusError()\n\t\t{\n\t\t\treturn (this.status.semantics === 'failure' && !!this.status.description);\n\t\t},\n\t\tstatusErrorDescription()\n\t\t{\n\t\t\treturn this.isStatusError ? this.status.description : '';\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-sms\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-sms\"></div>\n\t\t\t<div class=\"crm-entity-stream-section-content\">\n\t\t\t\t<div class=\"crm-entity-stream-content-event\">\n\t\t\t\t\t<div class=\"crm-entity-stream-content-header\">\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t@click.prevent=\"viewActivity\"\n\t\t\t\t\t\t\thref=\"#\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-event-title\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{title}}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"status\"\n\t\t\t\t\t\t\t:class=\"statusClass\"\n\t\t\t\t\t\t\t:title=\"statusErrorDescription\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{status.name}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-time\">{{createdAt}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-entity-stream-content-detail\">\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-detail-sms\">\n\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-detail-sms-status\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_NOTIFICATION_VIA')} \n\t\t\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_NOTIFICATION_BITRIX24')}\n\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-detail-sms-fragment\">\n\t\t\t\t\t\t\t\t<span>{{text}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"communication\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-detail-contact-info\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{BX.message('CRM_TIMELINE_SMS_TO')}}\n\t\t\t\t\t\t\t<a v-if=\"communication.SHOW_URL\" :href=\"communication.SHOW_URL\">\n\t\t\t\t\t\t\t\t{{communication.TITLE}}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t{{communication.TITLE}}\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<span v-if=\"communication.VALUE\">{{communication.VALUE}}</span>\n\t\t\t\t\t\t\t<template v-if=\"provider\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_NOTIFICATION_IN_MESSENGER')} {{provider}}\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<author v-if=\"author\" :author=\"author\"></author>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\t\n\t`\n});\n","export default {\n\tprops: {\n\t\tdeliveryService: {\n\t\t\trequired: true,\n\t\t\ttype: Object\n\t\t},\n\t},\n\tcomputed: {\n\t\tisDeliveryServiceProfile()\n\t\t{\n\t\t\treturn this.deliveryService.IS_PROFILE;\n\t\t},\n\t\tdeliveryServiceName()\n\t\t{\n\t\t\treturn this.isDeliveryServiceProfile ? this.deliveryService.PARENT_NAME : this.deliveryService.NAME;\n\t\t},\n\t\tdeliveryProfileServiceName()\n\t\t{\n\t\t\treturn this.deliveryService.NAME;\n\t\t},\n\t\tdeliveryServiceLogoBackgroundUrl()\n\t\t{\n\t\t\treturn this.isDeliveryServiceProfile ? this.deliveryService.PARENT_LOGO : this.deliveryService.LOGO;\n\n\t\t\treturn logo\n\t\t\t\t? {\n\t\t\t\t\t'background-image': 'url(' + logo + ')'\n\t\t\t\t}\n\t\t\t\t: {};\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-content-delivery-title\">\n\t\t\t<div\n\t\t\t\tv-if=\"isDeliveryServiceProfile && deliveryService.LOGO\"\n\t\t\t\tclass=\"crm-entity-stream-content-delivery-icon\"\n\t\t\t\t:style=\"{'background-image': 'url(' + deliveryService.LOGO + ')'}\"\n\t\t\t>\n\t\t\t</div>\n\t\t\t<div class=\"crm-entity-stream-content-delivery-title-contnet\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"deliveryServiceLogoBackgroundUrl\"\n\t\t\t\t\tclass=\"crm-entity-stream-content-delivery-title-logo\"\n\t\t\t\t\t:style=\"{'background-image': 'url(' + deliveryServiceLogoBackgroundUrl + ')'}\"\n\t\t\t\t></div>\n\t\t\t\t<div class=\"crm-entity-stream-content-delivery-title-info\">\n\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-title-name\">\n\t\t\t\t\t\t{{deliveryServiceName}}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"isDeliveryServiceProfile\"\n\t\t\t\t\t\tclass=\"crm-entity-stream-content-delivery-title-param\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{deliveryProfileServiceName}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n","import {Vue} from 'ui.vue';\nimport {ajax, Loc} from 'main.core';\nimport Author from '../components/author';\nimport DeliveryServiceInfo from '../components/delivery/delivery-service-info';\nimport {PULL} from 'pull.client';\nimport HistoryItemMixin from '../mixins/history-item';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\tcomponents: {\n\t\t'author': Author,\n\t\t'delivery-service-info': DeliveryServiceInfo,\n\t},\n\tprops: {\n\t\tmode: {\n\t\t\trequired: true,\n\t\t\ttype: String\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tentityData: null,\n\t\t\tdeliveryInfo: null,\n\t\t\tisRefreshing: false,\n\t\t\tisCreatingRequest: false,\n\t\t\tisCancellingRequest: false,\n\t\t};\n\t},\n\tmethods: {\n\t\t// region common activity methods\n\t\tcompleteActivity()\n\t\t{\n\t\t\tif(this.self.canComplete())\n\t\t\t{\n\t\t\t\tthis.self.setAsDone(!this.self.isDone());\n\t\t\t}\n\t\t},\n\t\tshowContextMenu(event)\n\t\t{\n\t\t\tlet popup = BX.PopupMenu.create(\n\t\t\t\t'taxi_activity_context_menu_' + this.self.getId(),\n\t\t\t\tevent.target,\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'delete',\n\t\t\t\t\t\ttext: this.getLangMessage('menuDelete'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tpopup.close();\n\n\t\t\t\t\t\t\tlet deletionDlgId = 'entity_timeline_deletion_' + this.self.getId() + '_confirm';\n\t\t\t\t\t\t\tlet dlg = BX.Crm.ConfirmationDialog.get(deletionDlgId);\n\n\t\t\t\t\t\t\tif (!dlg)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\t\t\t\t\t\tdeletionDlgId,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttitle: this.getLangMessage('removeConfirmTitle'),\n\t\t\t\t\t\t\t\t\t\tcontent: this.getLangMessage('deliveryRemove')\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdlg.open().then(\n\t\t\t\t\t\t\t\t(result) => {\n\t\t\t\t\t\t\t\t\tif (result.cancel)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tthis.self.remove();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t(result) => {},\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\t{\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 16,\n\t\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupShow: () =>  BX.addClass(event.target, 'active'),\n\t\t\t\t\t\tonPopupClose: () => BX.removeClass(event.target, 'active'),\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tpopup.show();\n\t\t},\n\t\t// endregion\n\t\t// region delivery request methods\n\t\tcreateDeliveryRequest()\n\t\t{\n\t\t\tif (this.isLocked)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isCreatingRequest = true;\n\t\t\tBX.ajax.runAction(\n\t\t\t\t'sale.deliveryrequest.create',\n\t\t\t\t{\n\t\t\t\t\tanalyticsLabel: 'saleDeliveryTaxiCall',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tshipmentIds: this.shipmentIds,\n\t\t\t\t\t\tadditional: {\n\t\t\t\t\t\t\tACTIVITY_ID: this.activityId,\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then((result) => {\n\t\t\t\tthis.refresh(() => {\n\t\t\t\t\tthis.isCreatingRequest = false;\n\t\t\t\t});\n\t\t\t}).catch((result) => {\n\t\t\t\tthis.isCreatingRequest = false;\n\t\t\t\tthis.showError(result.errors.map((item) => item.message).join());\n\t\t\t});\n\t\t},\n\t\tcancelDeliveryRequest()\n\t\t{\n\t\t\tif (this.isLocked || !this.deliveryRequest)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isCancellingRequest = true;\n\t\t\tBX.ajax.runAction(\n\t\t\t\t'sale.deliveryrequest.execute',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\trequestId: this.deliveryRequest['ID'],\n\t\t\t\t\t\tactionType: this.deliveryService['CANCEL_ACTION_CODE'],\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then((result) => {\n\t\t\t\t\tconst data = result.data;\n\n\t\t\t\t\tBX.ajax.runAction(\n\t\t\t\t\t\t'crm.timeline.deliveryactivity.createcanceldeliveryrequestmessage',\n\t\t\t\t\t\t{data: {\n\t\t\t\t\t\t\trequestId: this.deliveryRequest['ID'],\n\t\t\t\t\t\t\tmessage: data.message\n\t\t\t\t\t\t}}\n\t\t\t\t\t).then((result) => {\n\t\t\t\t\t\tBX.ajax.runAction(\n\t\t\t\t\t\t\t'sale.deliveryrequest.delete',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\trequestId: this.deliveryRequest['ID'],\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\t\t\tthis.refresh(() => {\n\t\t\t\t\t\t\t\t\tthis.isCancellingRequest = false;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}).catch((result) => {\n\t\t\t\t\t\t\tthis.isCancellingRequest = false;\n\t\t\t\t\t\t\tthis.showError(result.errors.map((item) => item.message).join());\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}).catch((result) => {\n\t\t\t\t\tthis.isCancellingRequest = false;\n\t\t\t\t\tthis.showError(result.errors.map((item) => item.message).join());\n\t\t\t\t});\n\t\t},\n\t\tcheckRequestStatus()\n\t\t{\n\t\t\tBX.ajax.runAction('crm.timeline.deliveryactivity.checkrequeststatus');\n\t\t},\n\t\tstartCheckingRequestStatus()\n\t\t{\n\t\t\tclearTimeout(this._checkRequestStatusTimeoutId);\n\t\t\tthis._checkRequestStatusTimeoutId = setInterval(\n\t\t\t\t() => this.checkRequestStatus(), 30 * 1000\n\t\t\t);\n\t\t},\n\t\tstopCheckingRequestStatus()\n\t\t{\n\t\t\tclearTimeout(this._checkRequestStatusTimeoutId);\n\t\t},\n\t\t// endregion\n\t\t// region refresh methods\n\t\tsetDeliveryInfo(deliveryInfo)\n\t\t{\n\t\t\tthis.deliveryInfo = deliveryInfo;\n\t\t},\n\t\trefresh(callback = null)\n\t\t{\n\t\t\tif (this.isRefreshing)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.isRefreshing = true;\n\n\t\t\tconst finallyCallback = () => {\n\t\t\t\tthis.isRefreshing = false;\n\t\t\t\tif (callback)\n\t\t\t\t{\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t};\n\t\t\tajax.runAction(\n\t\t\t\t'crm.timeline.deliveryactivity.getdeliveryinfo',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tactivityId: this.activityId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then((result) => {\n\t\t\t\tthis.setDeliveryInfo(result.data);\n\t\t\t\tfinallyCallback();\n\t\t\t}).catch((result) => {\n\t\t\t\tfinallyCallback();\n\t\t\t});\n\t\t},\n\t\tsubscribePullEvents()\n\t\t{\n\t\t\tif (this._isPullSubscribed)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tPULL.subscribe({\n\t\t\t\tmoduleId: 'crm',\n\t\t\t\tcommand: 'onOrderShipmentSave',\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tif (this.shipmentIds.some(id => id == params.FIELDS.ID))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tPULL.subscribe({\n\t\t\t\tmoduleId: 'sale',\n\t\t\t\tcommand: 'onDeliveryServiceSave',\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tif (this.deliveryServiceIds.some(id => id == params.ID))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tPULL.subscribe({\n\t\t\t\tmoduleId: 'sale',\n\t\t\t\tcommand: 'onDeliveryRequestUpdate',\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tif (this.deliveryRequestId == params.ID)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tPULL.subscribe({\n\t\t\t\tmoduleId: 'sale',\n\t\t\t\tcommand: 'onDeliveryRequestDelete',\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tif (this.deliveryRequestId == params.ID)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tPULL.extendWatch('SALE_DELIVERY_SERVICE');\n\t\t\tPULL.extendWatch('CRM_ENTITY_ORDER_SHIPMENT');\n\t\t\tPULL.extendWatch('SALE_DELIVERY_REQUEST');\n\n\t\t\tthis._isPullSubscribed = true;\n\t\t},\n\t\t//endregion\n\t\t// region miscellaneous\n\t\tcallPhone(phone)\n\t\t{\n\t\t\tif (this.canUseTelephony && typeof(top.BXIM)!=='undefined')\n\t\t\t{\n\t\t\t\ttop.BXIM.phoneTo(phone);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twindow.location.href='tel:' + phone;\n\t\t\t}\n\t\t},\n\t\tisPhone(property)\n\t\t{\n\t\t\treturn (\n\t\t\t\tproperty.hasOwnProperty('TAGS')\n\t\t\t\t&& Array.isArray(property['TAGS'])\n\t\t\t\t&& property['TAGS'].includes('phone')\n\t\t\t);\n\t\t},\n\t\tshowError(message)\n\t\t{\n\t\t\tBX.loadExt('ui.notification').then(() => { BX.UI.Notification.Center.notify({content: message}); });\n\t\t},\n\t\t// endregion\n\t},\n\tcreated()\n\t{\n\t\tthis.entityData = this.self.getAssociatedEntityData();\n\t\tif (this.entityData['DELIVERY_INFO'])\n\t\t{\n\t\t\tthis.setDeliveryInfo(this.entityData['DELIVERY_INFO']);\n\t\t}\n\n\t\tthis.subscribePullEvents();\n\n\t\tthis._checkRequestStatusTimeoutId = null;\n\t\tif (this.needCheckRequestStatus)\n\t\t{\n\t\t\tthis.startCheckingRequestStatus();\n\t\t}\n\t},\n\tcomputed: {\n\t\tactivityId()\n\t\t{\n\t\t\treturn this.data.ASSOCIATED_ENTITY.ID;\n\t\t},\n\t\t// region shipments\n\t\tshipments()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.deliveryInfo\n\t\t\t\t&& this.deliveryInfo.hasOwnProperty('SHIPMENTS')\n\t\t\t\t&& Array.isArray(this.deliveryInfo['SHIPMENTS'])\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.deliveryInfo['SHIPMENTS'];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tshipmentIds()\n\t\t{\n\t\t\treturn this.shipments ? this.shipments.map((shipment) => shipment['ID']) : [];\n\t\t},\n\t\tshipment()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.shipments\n\t\t\t\t&& Array.isArray(this.shipments)\n\t\t\t\t&& this.shipments.length > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.shipments[0];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\texpectedDeliveryPriceFormatted()\n\t\t{\n\t\t\treturn (this.shipment && this.shipment.hasOwnProperty('BASE_PRICE_DELIVERY'))\n\t\t\t\t? this.shipment['BASE_PRICE_DELIVERY_FORMATTED']\n\t\t\t\t: this.shipment['PRICE_DELIVERY_FORMATTED'];\n\t\t},\n\t\t// endregion\n\t\t// region delivery service\n\t\tdeliveryService()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.deliveryInfo\n\t\t\t\t&& this.deliveryInfo.hasOwnProperty('DELIVERY_SERVICE')\n\t\t\t\t&& typeof this.deliveryInfo['DELIVERY_SERVICE'] === 'object'\n\t\t\t\t&& this.deliveryInfo['DELIVERY_SERVICE'] !== null\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.deliveryInfo['DELIVERY_SERVICE'];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tdeliveryServiceIds()\n\t\t{\n\t\t\t// @TODO\n\t\t\tif (!this.deliveryService)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.deliveryService.IDS;\n\t\t},\n\t\t// endregion\n\t\t// region delivery request\n\t\tdeliveryRequest()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.deliveryInfo\n\t\t\t\t&& this.deliveryInfo.hasOwnProperty('DELIVERY_REQUEST')\n\t\t\t\t&& typeof this.deliveryInfo['DELIVERY_REQUEST'] === 'object'\n\t\t\t\t&& this.deliveryInfo['DELIVERY_REQUEST'] !== null\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.deliveryInfo['DELIVERY_REQUEST'];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tdeliveryRequestId()\n\t\t{\n\t\t\tif (this.deliveryRequest && this.deliveryRequest.hasOwnProperty('ID'))\n\t\t\t{\n\t\t\t\treturn this.deliveryRequest['ID'];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tdeliveryRequestProperties()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.deliveryRequest\n\t\t\t\t&& this.deliveryRequest.hasOwnProperty('EXTERNAL_PROPERTIES')\n\t\t\t\t&& typeof this.deliveryRequest['EXTERNAL_PROPERTIES'] === 'object'\n\t\t\t\t&& this.deliveryRequest['EXTERNAL_PROPERTIES'] !== null\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.deliveryRequest['EXTERNAL_PROPERTIES'];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tdeliveryRequestStatus()\n\t\t{\n\t\t\tif (!this.deliveryRequest)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.deliveryRequest['EXTERNAL_STATUS'];\n\t\t},\n\t\tdeliveryRequestStatusSemantic()\n\t\t{\n\t\t\tif (!this.deliveryRequest)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.deliveryRequest['EXTERNAL_STATUS_SEMANTIC'];\n\t\t},\n\t\tisConnectedWithDeliveryRequest()\n\t\t{\n\t\t\treturn !!this.deliveryRequest;\n\t\t},\n\t\tneedCheckRequestStatus()\n\t\t{\n\t\t\treturn this.isConnectedWithDeliveryRequest && this.mode === 'schedule';\n\t\t},\n\t\tisSendRequestButtonVisible()\n\t\t{\n\t\t\treturn (!this.isCreatingRequest && !this.isConnectedWithDeliveryRequest);\n\t\t},\n\t\t// endregion\n\t\t//region miscellaneous\n\t\tmiscellaneous()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.deliveryInfo\n\t\t\t\t&& this.deliveryInfo.hasOwnProperty('MISCELLANEOUS')\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.deliveryInfo['MISCELLANEOUS'];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tcanUseTelephony()\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.miscellaneous\n\t\t\t\t&& this.miscellaneous.hasOwnProperty('CAN_USE_TELEPHONY')\n\t\t\t\t&& this.miscellaneous['CAN_USE_TELEPHONY']\n\t\t\t);\n\t\t},\n\t\ttemplate()\n\t\t{\n\t\t\tif (!this.miscellaneous || !this.miscellaneous.hasOwnProperty('TEMPLATE'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.miscellaneous['TEMPLATE'];\n\t\t},\n\t\t// endregion\n\t\t// region classes\n\t\tcancelRequestButtonStyle()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'ui-btn': true,\n\t\t\t\t'ui-btn-sm': true,\n\t\t\t\t'ui-btn-light-border': true,\n\t\t\t\t'ui-btn-wait': this.isCancellingRequest\n\t\t\t};\n\t\t},\n\t\tstatusClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-entity-stream-content-event-process': this.deliveryRequestStatusSemantic === 'process',\n\t\t\t\t'crm-entity-stream-content-event-missing': this.deliveryRequestStatusSemantic === 'error',\n\t\t\t\t'crm-entity-stream-content-event-done': this.deliveryRequestStatusSemantic === 'success',\n\t\t\t};\n\t\t},\n\t\twrapperContainerClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-entity-stream-section-planned': this.mode === 'schedule'\n\t\t\t};\n\t\t},\n\t\tinnerWrapperContainerClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-entity-stream-content-event--delivery': this.mode !== 'schedule'\n\t\t\t};\n\t\t},\n\t\t// endregion\n\t\tisLocked()\n\t\t{\n\t\t\treturn this.isRefreshing || this.isCreatingRequest || this.isCancellingRequest;\n\t\t},\n\t},\n\twatch: {\n\t\tneedCheckRequestStatus: function (value)\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tthis.startCheckingRequestStatus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.stopCheckingRequestStatus();\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"crm-entity-stream-section crm-entity-stream-section-new\"\n\t\t\t:class=\"wrapperContainerClass\"\n\t\t>\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-new crm-entity-stream-section-icon-taxi\"></div>\n\t\t\t<div\n\t\t\t\tv-if=\"mode === 'schedule'\"\n\t\t\t\t@click=\"showContextMenu\"\n\t\t\t\tclass=\"crm-entity-stream-section-context-menu\"\n\t\t\t></div>\n\t\t\t<div class=\"crm-entity-stream-section-content\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"crm-entity-stream-content-event\"\n\t\t\t\t\t:class=\"innerWrapperContainerClass\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"crm-entity-stream-content-header\">\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_SERVICE')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"deliveryRequestStatus && deliveryRequestStatusSemantic\"\n\t\t\t\t\t\t\t:class=\"statusClass\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{deliveryRequestStatus}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-time\">{{createdAt}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-entity-stream-content-detail crm-entity-stream-content-delivery\">\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-row crm-entity-stream-content-delivery-row--flex\">\n\t\t\t\t\t\t\t<template v-if=\"mode === 'schedule'\">\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tv-if=\"isSendRequestButtonVisible\"\n\t\t\t\t\t\t\t\t\t@click=\"createDeliveryRequest\"\n\t\t\t\t\t\t\t\t\tclass=\"ui-btn ui-btn-sm ui-btn-primary\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_CREATE_DELIVERY_REQUEST')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span v-if=\"isCreatingRequest\" class=\"crm-entity-stream-content-delivery-status\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_CREATING_REQUEST')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tv-if=\"isConnectedWithDeliveryRequest && deliveryService && deliveryService.IS_CANCELLABLE\"\n\t\t\t\t\t\t\t\t\t@click=\"cancelDeliveryRequest\"\n\t\t\t\t\t\t\t\t\t:class=\"cancelRequestButtonStyle\"\n\t\t\t\t\t\t\t\t>\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t{{deliveryService.CANCEL_ACTION_NAME}}\n\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<delivery-service-info\n\t\t\t\t\t\t\t\tv-if=\"deliveryService\"\n\t\t\t\t\t\t\t\t:deliveryService=\"deliveryService\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</delivery-service-info>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-row\">\n\t\t\t\t\t\t\t<table class=\"crm-entity-stream-content-delivery-order\">\n\t\t\t\t\t\t\t\t<tr v-if=\"shipment && shipment.ADDRESS_FROM_FORMATTED && shipment.ADDRESS_TO_FORMATTED\">\n\t\t\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-item\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-value crm-entity-stream-content-delivery-order-value--sm\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-box\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-box-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_ADDRESS_FROM')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span v-html=\"shipment.ADDRESS_FROM_FORMATTED\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-box\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-box-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_ADDRESS_TO')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span v-html=\"shipment.ADDRESS_TO_FORMATTED\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr v-if=\"shipment\">\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-item\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_CLIENT_DELIVERY_PRICE')}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-value crm-entity-stream-content-delivery-order-value--sm\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tv-html=\"shipment.PRICE_DELIVERY_FORMATTED\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t style=\"font-size: 14px; color: #333;\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-item\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_EXPECTED_DELIVERY_PRICE')}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-value crm-entity-stream-content-delivery-order-value--sm\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span style=\"font-size: 14px; color: #333; opacity: .5;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tv-html=\"expectedDeliveryPriceFormatted\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span v-else>\n\t\t\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_EXPECTED_PRICE_NOT_RECEIVED')}\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<!-- Properties --->\n\t\t\t\t\t\t\t\t<tr v-for=\"property in deliveryRequestProperties\">\n\t\t\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-item\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t{{property.NAME}}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-value crm-entity-stream-content-delivery-order-value--sm\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"isPhone(property)\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t@click=\"callPhone(property.VALUE)\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-delivery-link\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{{property.VALUE}}\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span v-else>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{{property.VALUE}}\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<!-- end Properties --->\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"mode === 'schedule'\" class=\"crm-entity-stream-content-detail-planned-action\">\n\t\t\t\t\t\t<input @click=\"completeActivity\" type=\"checkbox\" class=\"crm-entity-stream-planned-apply-btn\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<author v-if=\"author\" :author=\"author\">\n\t\t\t\t\t</author>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Vue} from 'ui.vue';\nimport HistoryItemMixin from '../mixins/history-item';\nimport Author from '../components/author';\nimport DeliveryServiceInfo from '../components/delivery/delivery-service-info';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\tcomponents: {\n\t\t'author': Author,\n\t\t'delivery-service-info': DeliveryServiceInfo,\n\t},\n\tcomputed: {\n\t\tdeliveryService()\n\t\t{\n\t\t\tif (!this.data.FIELDS.hasOwnProperty('DELIVERY_SERVICE'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.data.FIELDS.DELIVERY_SERVICE;\n\t\t},\n\t\tmessageData()\n\t\t{\n\t\t\tif (!this.data.FIELDS.hasOwnProperty('MESSAGE_DATA'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.data.FIELDS.MESSAGE_DATA;\n\t\t},\n\t\tmessageTitle()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['TITLE'];\n\t\t},\n\t\tmessageDescription()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['DESCRIPTION'];\n\t\t},\n\t\tmessageStatus()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['STATUS'];\n\t\t},\n\t\tmessageStatusSemantics()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['STATUS_SEMANTIC'];\n\t\t},\n\t\tmessageStatusSemanticsClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-entity-stream-content-event-process': this.messageStatusSemantics === 'process',\n\t\t\t\t'crm-entity-stream-content-event-missing': this.messageStatusSemantics === 'error',\n\t\t\t\t'crm-entity-stream-content-event-done': this.messageStatusSemantics === 'success',\n\t\t\t};\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-new\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-new crm-entity-stream-section-icon-taxi\"></div>\n\t\t\t<div class=\"crm-entity-stream-section-content\">\n\t\t\t\t<div class=\"crm-entity-stream-content-event\">\n\t\t\t\t\t<div class=\"crm-entity-stream-content-header\">\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"messageTitle\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-event-title\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{messageTitle}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"messageStatus && messageStatusSemantics\"\n\t\t\t\t\t\t\t:class=\"messageStatusSemanticsClass\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{messageStatus}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-time\">\n\t\t\t\t\t\t\t<span v-html=\"createdAt\">\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-entity-stream-content-detail\">\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-row crm-entity-stream-content-delivery-row--flex\">\n\t\t\t\t\t\t\t<delivery-service-info\n\t\t\t\t\t\t\t\tv-if=\"deliveryService\"\n\t\t\t\t\t\t\t\t:deliveryService=\"deliveryService\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</delivery-service-info>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"messageDescription\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-delivery-description\"\n\t\t\t\t\t\t\tv-html=\"messageDescription\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<author v-if=\"author\" :author=\"author\">\n\t\t\t\t\t</author>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\nimport HistoryItemMixin from '../mixins/history-item';\nimport Author from '../components/author';\nimport DeliveryServiceInfo from '../components/delivery/delivery-service-info';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\tcomponents: {\n\t\t'author': Author,\n\t\t'delivery-service-info': DeliveryServiceInfo,\n\t},\n\tcomputed: {\n\t\tdeliveryService()\n\t\t{\n\t\t\tif (!this.data.FIELDS.hasOwnProperty('DELIVERY_SERVICE'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.data.FIELDS.DELIVERY_SERVICE;\n\t\t},\n\t\tmessageData()\n\t\t{\n\t\t\tif (!this.data.FIELDS.hasOwnProperty('MESSAGE_DATA'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.data.FIELDS.MESSAGE_DATA;\n\t\t},\n\t\tmessageTitle()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['TITLE'];\n\t\t},\n\t\tmessageDescription()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['DESCRIPTION'];\n\t\t},\n\t\tmessageStatus()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['STATUS'];\n\t\t},\n\t\tmessageStatusSemantics()\n\t\t{\n\t\t\tif (!this.messageData)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.messageData['STATUS_SEMANTIC'];\n\t\t},\n\t\tmessageStatusSemanticsClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-entity-stream-content-event-process': this.messageStatusSemantics === 'process',\n\t\t\t\t'crm-entity-stream-content-event-missing': this.messageStatusSemantics === 'error',\n\t\t\t\t'crm-entity-stream-content-event-done': this.messageStatusSemantics === 'success',\n\t\t\t};\n\t\t},\n\t\taddressFrom()\n\t\t{\n\t\t\tif (!this.data.FIELDS.hasOwnProperty('ADDRESS_FROM_FORMATTED'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.data.FIELDS.ADDRESS_FROM_FORMATTED;\n\t\t},\n\t\taddressTo()\n\t\t{\n\t\t\tif (!this.data.FIELDS.hasOwnProperty('ADDRESS_TO_FORMATTED'))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.data.FIELDS.ADDRESS_TO_FORMATTED;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-new\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-new crm-entity-stream-section-icon-taxi\"></div>\n\t\t\t\n\t\t\t<div class=\"crm-entity-stream-section-content\">\n\t\t\t\t<div class=\"crm-entity-stream-content-event\">\n\t\t\t\t\t<div class=\"crm-entity-stream-content-header\">\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"messageTitle\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-event-title\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{messageTitle}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"messageStatus && messageStatusSemantics\"\n\t\t\t\t\t\t\t:class=\"messageStatusSemanticsClass\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{messageStatus}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-time\">\n\t\t\t\t\t\t\t<span v-html=\"createdAt\">\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-entity-stream-content-detail\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-html=\"messageDescription\"\n\t\t\t\t\t\t\tclass=\"crm-entity-stream-content-detail-description crm-delivery-taxi-caption\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-detail-description\">\n\t\t\t\t\t\t\t<div v-if=\"addressFrom\" class=\"crm-entity-stream-content-delivery-order-box\">\n\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-box-label\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_ADDRESS_FROM')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span>{{addressFrom}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-if=\"addressTo\" class=\"crm-entity-stream-content-delivery-order-box\">\n\t\t\t\t\t\t\t\t<div class=\"crm-entity-stream-content-delivery-order-box-label\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('TIMELINE_DELIVERY_TAXI_ADDRESS_TO')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span>{{addressTo}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<author v-if=\"author\" :author=\"author\">\n\t\t\t\t\t</author>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import Manager from \"./manager\";\n\n/** @memberof BX.Crm.Timeline */\nexport default class Editor\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._manager = null;\n\n\t\tthis._ownerTypeId = 0;\n\t\tthis._ownerId = 0;\n\n\t\tthis._container = null;\n\t\tthis._input = null;\n\t\tthis._saveButton = null;\n\t\tthis._cancelButton = null;\n\t\tthis._ghostInput = null;\n\n\t\tthis._saveButtonHandler = BX.delegate(this.onSaveButtonClick, this);\n\t\tthis._cancelButtonHandler = BX.delegate(this.onCancelButtonClick, this);\n\t\tthis._focusHandler = BX.delegate(this.onFocus, this);\n\t\tthis._blurHandler = BX.delegate(this.onBlur, this);\n\t\tthis._keyupHandler = BX.delegate(this.resizeForm, this);\n\t\tthis._delayedKeyupHandler = BX.delegate(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tsetTimeout(this.resizeForm.bind(this), 0);\n\t\t\t},\n\t\t\tthis\n\t\t);\n\n\t\tthis._isVisible = true;\n\t\tthis._hideButtonsOnBlur = true;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._manager = this.getSetting(\"manager\");\n\t\tif(!(this._manager instanceof Manager))\n\t\t{\n\t\t\tthrow \"Editor. Manager instance is not found.\";\n\t\t}\n\n\t\tthis._ownerTypeId = this.getSetting(\"ownerTypeId\", 0);\n\t\tthis._ownerId = this.getSetting(\"ownerId\", 0);\n\n\t\tthis._container = BX(this.getSetting(\"container\"));\n\t\tthis._input = BX(this.getSetting(\"input\"));\n\t\tthis._saveButton = BX(this.getSetting(\"button\"));\n\t\tthis._cancelButton = BX(this.getSetting(\"cancelButton\"));\n\n\t\tBX.bind(this._saveButton, \"click\", this._saveButtonHandler);\n\t\tif(this._cancelButton)\n\t\t{\n\t\t\tBX.bind(this._cancelButton, \"click\", this._cancelButtonHandler);\n\t\t}\n\n\t\tBX.bind(this._input, \"focus\", this._focusHandler);\n\t\tBX.bind(this._input, \"blur\", this._blurHandler);\n\t\tBX.bind(this._input, \"keyup\", this._keyupHandler);\n\t\tBX.bind(this._input, \"cut\", this._delayedKeyupHandler);\n\t\tBX.bind(this._input, \"paste\", this._delayedKeyupHandler);\n\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tsetVisible(visible)\n\t{\n\t\tvisible = !!visible;\n\t\tif(this._isVisible === visible)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isVisible = visible;\n\t\tthis._container.style.display = visible ? \"\" : \"none\";\n\t}\n\n\tisVisible()\n\t{\n\t\treturn this._isVisible;\n\t}\n\n\tonFocus(e)\n\t{\n\t\tBX.addClass(this._container, \"focus\");\n\t}\n\n\tonBlur(e)\n\t{\n\t\tif(!this._hideButtonsOnBlur)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._input.value === \"\")\n\t\t{\n\t\t\twindow.setTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\tBX.removeClass(this._container, \"focus\");\n\t\t\t\t\tthis._input.style.minHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t200\n\t\t\t);\n\t\t}\n\t}\n\n\tonSaveButtonClick(e)\n\t{\n\t\tthis.save();\n\t}\n\n\tonCancelButtonClick()\n\t{\n\t\tthis.cancel();\n\t\tthis._manager.processEditingCancellation(this);\n\t}\n\n\tsave()\n\t{\n\t}\n\n\tcancel()\n\t{\n\t}\n\n\trelease()\n\t{\n\t\tif(this._ghostInput)\n\t\t{\n\t\t\tthis._ghostInput = BX.remove(this._ghostInput);\n\t\t}\n\t}\n\n\tensureGhostCreated()\n\t{\n\t\tif(this._ghostInput)\n\t\t{\n\t\t\treturn this._ghostInput;\n\t\t}\n\n\t\tthis._ghostInput = BX.create('div', {\n\t\t\tprops: { className: 'crm-entity-stream-content-new-comment-textarea-shadow' },\n\t\t\ttext: this._input.value\n\t\t});\n\n\t\tthis._ghostInput.style.width = this._input.offsetWidth + 'px';\n\t\tdocument.body.appendChild(this._ghostInput);\n\t\treturn this._ghostInput;\n\t}\n\n\tresizeForm()\n\t{\n\t\tconst ghost = this.ensureGhostCreated();\n\t\tconst computedStyle = getComputedStyle(this._input);\n\t\tconst diff = parseInt(computedStyle.paddingBottom) +\n\t\t\tparseInt(computedStyle.paddingTop) +\n\t\t\tparseInt(computedStyle.borderTopWidth) +\n\t\t\tparseInt(computedStyle.borderBottomWidth) || 0;\n\n\t\tghost.innerHTML = BX.util.htmlspecialchars(this._input.value.replace(/[\\r\\n]{1}/g, '<br>'));\n\t\tthis._input.style.minHeight = ghost.scrollHeight + diff + 'px'\n\t}\n}\n","import Wait from \"../editors/wait\";\n\n/** @memberof BX.Crm.Timeline.Tools */\nexport default class WaitConfigurationDialog\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._type = Wait.WaitingType.undefined;\n\t\tthis._duration = 0;\n\t\tthis._target = \"\";\n\t\tthis._targetDates = null;\n\t\tthis._container = null;\n\t\tthis._durationMeasureNode = null;\n\t\tthis._durationInput = null;\n\t\tthis._targetDateNode = null;\n\t\tthis._popup = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\t\tthis._type = BX.prop.getInteger(this._settings, \"type\", Wait.WaitingType.after);\n\t\tthis._duration = BX.prop.getInteger(this._settings, \"duration\", 1);\n\t\tthis._target = BX.prop.getString(this._settings, \"target\", \"\");\n\t\tthis._targetDates = BX.prop.getArray(this._settings, \"targetDates\", []);\n\n\t\tthis._menuId = this._id + \"_target_date_sel\";\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetType()\n\t{\n\t\treturn this._type;\n\t}\n\n\tsetType(type)\n\t{\n\t\tthis._type = type;\n\t}\n\n\tgetDuration()\n\t{\n\t\treturn this._duration;\n\t}\n\n\tsetDuration(duration)\n\t{\n\t\tthis._duration = duration;\n\t}\n\n\tgetTarget()\n\t{\n\t\treturn this._target;\n\t}\n\n\tsetTarget(target)\n\t{\n\t\tthis._target = target;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = WaitConfigurationDialog.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetDurationText(duration, enableNumber)\n\t{\n\t\treturn Wait.Helper.getDurationText(duration, enableNumber);\n\t}\n\n\tgetTargetDateCaption(name)\n\t{\n\t\tconst length = this._targetDates.length;\n\t\tfor(let i = 0; i < length; i++)\n\t\t{\n\t\t\tconst info = this._targetDates[i];\n\t\t\tif(info[\"name\"] === name)\n\t\t\t{\n\t\t\t\treturn info[\"caption\"];\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\topen()\n\t{\n\t\tthis._popup = new BX.PopupWindow(\n\t\t\tthis._id,\n\t\t\tnull, //this._configSelector,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tdraggable: false,\n\t\t\t\tbindOptions: { forceBindPosition: false },\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tzIndex: 0,\n\t\t\t\tcontent: this.prepareDialogContent(),\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onPopupShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onPopupClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onPopupDestroy, this)\n\t\t\t\t\t},\n\t\t\t\tbuttons:\n\t\t\t\t\t[\n\t\t\t\t\t\tnew BX.PopupWindowButton(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: this.getMessage(\"select\"),\n\t\t\t\t\t\t\t\tclassName: \"popup-window-button-accept\" ,\n\t\t\t\t\t\t\t\tevents: { click: BX.delegate(this.onSaveButtonClick, this) }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tnew BX.PopupWindowButtonLink(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext : BX.message(\"JS_CORE_WINDOW_CANCEL\"),\n\t\t\t\t\t\t\t\tevents: { click: BX.delegate(this.onCancelButtonClick, this) }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tthis._popup.show();\n\t}\n\n\tclose()\n\t{\n\t\tif(this._popup)\n\t\t{\n\t\t\tthis._popup.close();\n\t\t}\n\t}\n\n\tprepareDialogContent()\n\t{\n\t\tconst container = BX.create(\"div\", {attrs: {className: \"crm-wait-popup-select-block\"}});\n\t\tconst wrapper = BX.create(\"div\", {attrs: {className: \"crm-wait-popup-select-wrapper\"}});\n\t\tcontainer.appendChild(wrapper);\n\n\t\tthis._durationInput = BX.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tattrs: { type: \"text\", className: \"crm-wait-popup-settings-input\", value: this._duration },\n\t\t\t\tevents: { keyup: BX.delegate(this.onDurationChange, this) }\n\t\t\t}\n\t\t);\n\n\t\tthis._durationMeasureNode = BX.create(\n\t\t\t\"span\",\n\t\t\t{ attrs: { className: \"crm-wait-popup-settings-title\" }, text: this.getDurationText(this._duration, false) }\n\t\t);\n\n\t\tif(this._type === Wait.WaitingType.after)\n\t\t{\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { attrs: { className: \"crm-wait-popup-settings-title\" }, text: this.getMessage(\"prefixTypeAfter\") })\n\t\t\t);\n\t\t\twrapper.appendChild(this._durationInput);\n\t\t\twrapper.appendChild(this._durationMeasureNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { attrs: { className: \"crm-wait-popup-settings-title\" }, text: this.getMessage(\"prefixTypeBefore\") })\n\t\t\t);\n\t\t\twrapper.appendChild(this._durationInput);\n\t\t\twrapper.appendChild(this._durationMeasureNode);\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { attrs: { className: \"crm-wait-popup-settings-title\" }, text: \" \" + this.getMessage(\"targetPrefixTypeBefore\") })\n\t\t\t);\n\n\t\t\tthis._targetDateNode = BX.create(\n\t\t\t\t\"span\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-automation-popup-settings-link\" },\n\t\t\t\t\ttext: this.getTargetDateCaption(this._target),\n\t\t\t\t\tevents: { click: BX.delegate(this.toggleTargetMenu, this) }\n\t\t\t\t}\n\t\t\t);\n\t\t\twrapper.appendChild(this._targetDateNode);\n\t\t}\n\t\treturn container;\n\t}\n\n\tonDurationChange()\n\t{\n\t\tlet duration = parseInt(this._durationInput.value);\n\t\tif(isNaN(duration) || duration <= 0)\n\t\t{\n\t\t\tduration = 1;\n\t\t}\n\t\tthis._duration = duration;\n\t\tthis._durationMeasureNode.innerHTML = BX.util.htmlspecialchars(this.getDurationText(duration, false));\n\n\t}\n\n\ttoggleTargetMenu()\n\t{\n\t\tif(this.isTargetMenuOpened())\n\t\t{\n\t\t\tthis.closeTargetMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.openTargetMenu();\n\t\t}\n\t}\n\n\tisTargetMenuOpened()\n\t{\n\t\treturn !!BX.PopupMenu.getMenuById(this._menuId);\n\t}\n\n\topenTargetMenu()\n\t{\n\t\tconst menuItems = [];\n\t\tlet i = 0;\n\t\tconst length = this._targetDates.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst info = this._targetDates[i];\n\n\t\t\tmenuItems.push(\n\t\t\t\t{\n\t\t\t\t\ttext: info[\"caption\"],\n\t\t\t\t\ttitle: info[\"caption\"],\n\t\t\t\t\tvalue: info[\"name\"],\n\t\t\t\t\tonclick: BX.delegate(this.onTargetSelect, this)\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._menuId,\n\t\t\tthis._targetDateNode,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tzIndex: 200,\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: BX.pos(this._targetDateNode)[\"width\"] / 2,\n\t\t\t\tangle: { position: 'top', offset: 0 }\n\t\t\t}\n\t\t);\n\t}\n\n\tcloseTargetMenu()\n\t{\n\t\tBX.PopupMenu.destroy(this._menuId);\n\t}\n\n\tonPopupShow(e, item)\n\t{\n\t}\n\n\tonPopupClose()\n\t{\n\t\tif(this._popup)\n\t\t{\n\t\t\tthis._popup.destroy();\n\t\t}\n\n\t\tthis.closeTargetMenu();\n\t}\n\n\tonPopupDestroy()\n\t{\n\t\tif(this._popup)\n\t\t{\n\t\t\tthis._popup = null;\n\t\t}\n\t}\n\n\tonSaveButtonClick(e)\n\t{\n\t\tconst callback = BX.prop.getFunction(this._settings, \"onSave\", null);\n\t\tif(!callback)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst params = {type: this._type};\n\t\tparams[\"duration\"] = this._duration;\n\t\tparams[\"target\"] = this._type === Wait.WaitingType.before ? this._target : \"\";\n\t\tcallback(this, params);\n\t}\n\n\tonCancelButtonClick(e)\n\t{\n\t\tconst callback = BX.prop.getFunction(this._settings, \"onCancel\", null);\n\t\tif(callback)\n\t\t{\n\t\t\tcallback(this);\n\t\t}\n\t}\n\n\tonTargetSelect(e, item)\n\t{\n\t\tconst fieldName = BX.prop.getString(item, \"value\", \"\");\n\t\tif(fieldName !== \"\")\n\t\t{\n\t\t\tthis._target = fieldName;\n\t\t\tthis._targetDateNode.innerHTML = BX.util.htmlspecialchars(this.getTargetDateCaption(fieldName));\n\t\t}\n\n\t\tthis.closeTargetMenu();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WaitConfigurationDialog();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Editor from \"../editor.js\";\nimport WaitConfigurationDialog from \"../tools/wait-configuration-dialog\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class Wait extends Editor\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._serviceUrl = \"\";\n\t\tthis._isRequestRunning = false;\n\t\tthis._isLocked = false;\n\n\t\tthis._hideButtonsOnBlur = false;\n\t\t//region Config\n\t\tthis._type = Wait.WaitingType.after;\n\t\tthis._duration = 1;\n\t\tthis._target = \"\";\n\t\tthis._configContainer = null;\n\t\tthis._configSelector = null;\n\t\t//endregion\n\n\t\tthis._isMenuShown = false;\n\t\tthis._menu = null;\n\t\tthis._configDialog = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._configContainer = BX(this.getSetting(\"configContainer\"));\n\t\tthis._serviceUrl = this.getSetting(\"serviceUrl\", \"\");\n\n\t\tconst config = BX.prop.getObject(this._settings, \"config\", {});\n\t\tthis._type = Wait.WaitingType.resolveTypeId(\n\t\t\tBX.prop.getString(\n\t\t\t\tconfig,\n\t\t\t\t\"type\",\n\t\t\t\tWait.WaitingType.names.after\n\t\t\t)\n\t\t);\n\t\tthis._duration = BX.prop.getInteger(config, \"duration\", 1);\n\t\tthis._target = BX.prop.getString(config, \"target\", \"\");\n\t\tthis._targetDates = BX.prop.getArray(this._settings, \"targetDates\", []);\n\t\tthis.layoutConfigurationSummary();\n\t}\n\n\tgetDurationText(duration, enableNumber)\n\t{\n\t\treturn Wait.Helper.getDurationText(duration, enableNumber);\n\t}\n\n\tgetTargetDateCaption(name)\n\t{\n\t\tlet i = 0;\n\t\tconst length = this._targetDates.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst info = this._targetDates[i];\n\t\t\tif(info[\"name\"] === name)\n\t\t\t{\n\t\t\t\treturn info[\"caption\"];\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\tonSelectorClick(e)\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\tthis.openMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.closeMenu();\n\t\t}\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\topenMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\n\t\tconst menuItems =\n\t\t\t[\n\t\t\t\t{id: \"day_1\", text: this.getMessage(\"oneDay\"), onclick: handler},\n\t\t\t\t{id: \"day_2\", text: this.getMessage(\"twoDays\"), onclick: handler},\n\t\t\t\t{id: \"day_3\", text: this.getMessage(\"threeDays\"), onclick: handler},\n\t\t\t\t{id: \"week_1\", text: this.getMessage(\"oneWeek\"), onclick: handler},\n\t\t\t\t{id: \"week_2\", text: this.getMessage(\"twoWeek\"), onclick: handler},\n\t\t\t\t{id: \"week_3\", text: this.getMessage(\"threeWeeks\"), onclick: handler}\n\t\t\t];\n\n\t\tconst customMenu = {id: \"custom\", text: this.getMessage(\"custom\"), items: []};\n\t\tcustomMenu[\"items\"].push({ id: \"afterDays\", text: this.getMessage(\"afterDays\"), onclick: handler });\n\t\tif(this._targetDates.length > 0)\n\t\t{\n\t\t\tcustomMenu[\"items\"].push({ id: \"beforeDate\", text: this.getMessage(\"beforeDate\"), onclick: handler });\n\t\t}\n\t\tmenuItems.push(customMenu);\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._configSelector,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 36,\n\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\n\t\tif(item.id === \"afterDays\" || item.id === \"beforeDate\")\n\t\t{\n\t\t\tthis.openConfigDialog(\n\t\t\t\titem.id === \"afterDays\" ? Wait.WaitingType.after : Wait.WaitingType.before\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tconst params = {type: Wait.WaitingType.after};\n\t\tif(item.id === \"day_1\")\n\t\t{\n\t\t\tparams[\"duration\"] = 1;\n\t\t}\n\t\telse if(item.id === \"day_2\")\n\t\t{\n\t\t\tparams[\"duration\"] = 2;\n\t\t}\n\t\telse if(item.id === \"day_3\")\n\t\t{\n\t\t\tparams[\"duration\"] = 3;\n\t\t}\n\t\tif(item.id === \"week_1\")\n\t\t{\n\t\t\tparams[\"duration\"] = 7;\n\t\t}\n\t\telse if(item.id === \"week_2\")\n\t\t{\n\t\t\tparams[\"duration\"] = 14;\n\t\t}\n\t\telse if(item.id === \"week_3\")\n\t\t{\n\t\t\tparams[\"duration\"] = 21;\n\t\t}\n\t\tthis.saveConfiguration(params);\n\t}\n\n\topenConfigDialog(type)\n\t{\n\t\tif(!this._configDialog)\n\t\t{\n\t\t\tthis._configDialog = WaitConfigurationDialog.create(\n\t\t\t\t\"\",\n\t\t\t\t{\n\t\t\t\t\ttargetDates: this._targetDates,\n\t\t\t\t\tonSave: BX.delegate(this.onConfigDialogSave, this),\n\t\t\t\t\tonCancel: BX.delegate(this.onConfigDialogCancel, this)\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis._configDialog.setType(type);\n\t\tthis._configDialog.setDuration(this._duration);\n\n\t\tlet target = this._target;\n\t\tif(target === \"\" && this._targetDates.length > 0)\n\t\t{\n\t\t\ttarget = this._targetDates[0][\"name\"];\n\t\t}\n\t\tthis._configDialog.setTarget(target);\n\t\tthis._configDialog.open();\n\t}\n\n\tonConfigDialogSave(sender, params)\n\t{\n\t\tthis.saveConfiguration(params);\n\t\tthis._configDialog.close();\n\t}\n\n\tonConfigDialogCancel(sender)\n\t{\n\t\tthis._configDialog.close();\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tif(this._menu && this._menu.popupWindow)\n\t\t{\n\t\t\tthis._menu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu = null;\n\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tsaveConfiguration(params)\n\t{\n\t\t//region Parse params\n\t\tthis._type = BX.prop.getInteger(params, \"type\", Wait.WaitingType.after);\n\t\tthis._duration = BX.prop.getInteger(params, \"duration\", 0);\n\t\tif(this._duration <= 0)\n\t\t{\n\t\t\tthis._duration = 1;\n\t\t}\n\t\tthis._target = this._type === Wait.WaitingType.before\n\t\t\t? BX.prop.getString(params, \"target\", \"\") : \"\";\n\t\t//endregion\n\t\t//region Save settings\n\t\tconst optionName = this._manager.getId().toLowerCase();\n\t\tBX.userOptions.save(\n\t\t\t\"crm.timeline.wait\",\n\t\t\toptionName,\n\t\t\t\"type\",\n\t\t\tthis._type === Wait.WaitingType.after ? \"after\" : \"before\"\n\t\t);\n\n\t\tBX.userOptions.save(\n\t\t\t\"crm.timeline.wait\",\n\t\t\toptionName,\n\t\t\t\"duration\",\n\t\t\tthis._duration\n\t\t);\n\n\t\tBX.userOptions.save(\n\t\t\t\"crm.timeline.wait\",\n\t\t\toptionName,\n\t\t\t\"target\",\n\t\t\tthis._target\n\t\t);\n\t\t//endregion\n\t\tthis.layoutConfigurationSummary();\n\t}\n\n\tgetSummaryHtml()\n\t{\n\t\tif(this._type === Wait.WaitingType.before)\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.getMessage(\"completionTypeBefore\")\n\t\t\t\t\t.replace(\"#DURATION#\", this.getDurationText(this._duration, true))\n\t\t\t\t\t.replace(\"#TARGET_DATE#\", this.getTargetDateCaption(this._target))\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\tthis.getMessage(\"completionTypeAfter\")\n\t\t\t\t.replace(\"#DURATION#\", this.getDurationText(this._duration, true))\n\t\t);\n\t}\n\n\tgetSummaryText()\n\t{\n\t\treturn BX.util.strip_tags(this.getSummaryHtml());\n\t}\n\n\tlayoutConfigurationSummary()\n\t{\n\t\tthis._configContainer.innerHTML = this.getSummaryHtml();\n\t\tthis._configSelector = this._configContainer.querySelector(\"a\");\n\t\tif(this._configSelector)\n\t\t{\n\t\t\tBX.bind(this._configSelector, \"click\", BX.delegate(this.onSelectorClick, this));\n\t\t}\n\t}\n\n\tpostpone(id, offset, callback)\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"POSTPONE_WAIT\",\n\t\t\t\t\t\t\"DATA\": { \"ID\": id, \"OFFSET\": offset }\n\t\t\t\t\t},\n\t\t\t\tonsuccess: callback\n\t\t\t}\n\t\t);\n\t}\n\n\tcomplete(id, completed, callback)\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"COMPLETE_WAIT\",\n\t\t\t\t\t\t\"DATA\": { \"ID\": id, \"COMPLETED\": completed ? 'Y' : 'N' }\n\t\t\t\t\t},\n\t\t\t\tonsuccess: callback\n\t\t\t}\n\t\t);\n\t}\n\n\tsave()\n\t{\n\t\tif(this._isRequestRunning || this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet description = this.getSummaryText();\n\t\tconst comment = BX.util.trim(this._input.value);\n\t\tif(comment !== \"\")\n\t\t{\n\t\t\tdescription += \"\\n\" + comment;\n\t\t}\n\n\t\tconst data =\n\t\t\t{\n\t\t\t\tID: 0,\n\t\t\t\ttypeId: this._type,\n\t\t\t\tduration: this._duration,\n\t\t\t\ttargetFieldName: this._target,\n\t\t\t\tsubject: \"\",\n\t\t\t\tdescription: description,\n\t\t\t\tcompleted: 0,\n\t\t\t\townerType: BX.CrmEntityType.resolveName(this._ownerTypeId),\n\t\t\t\townerID: this._ownerId\n\t\t\t};\n\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"SAVE_WAIT\",\n\t\t\t\t\t\t\"DATA\": data\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onSaveFailure, this)\n\t\t\t}\n\t\t);\n\t\tthis._isRequestRunning = this._isLocked = true;\n\t}\n\n\tcancel()\n\t{\n\t\tthis._input.value = \"\";\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis.release();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\n\t\tconst error = BX.prop.getString(data, \"ERROR\", \"\");\n\t\tif(error !== \"\")\n\t\t{\n\t\t\talert(error);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._input.value = \"\";\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis._manager.processEditingCompletion(this);\n\t\tthis.release();\n\t}\n\n\tonSaveFailure()\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Wait.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\tthis.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic WaitingType = {\n\t\tundefined: 0,\n\t\tafter: 1,\n\t\tbefore: 2,\n\n\t\tnames:\n\t\t\t{\n\t\t\t\tafter: \"after\",\n\t\t\t\tbefore: \"before\"\n\t\t\t},\n\t\tresolveTypeId: function(name)\n\t\t{\n\t\t\tif(name === this.names.after)\n\t\t\t{\n\t\t\t\treturn this.after;\n\t\t\t}\n\t\t\telse if(name === this.names.before)\n\t\t\t{\n\t\t\t\treturn this.before;\n\t\t\t}\n\n\t\t\treturn this.undefined;\n\t\t}\n\t};\n\n\tstatic messages = {};\n\tstatic items = {};\n\n\tstatic Helper =\n\t{\n\t\tgetDurationText: function(duration, enableNumber)\n\t\t{\n\t\t\tenableNumber = !!enableNumber;\n\n\t\t\tlet result = \"\";\n\t\t\tlet type = \"D\";\n\t\t\tif(enableNumber)\n\t\t\t{\n\t\t\t\tif((duration % 7) === 0)\n\t\t\t\t{\n\t\t\t\t\tduration = duration / 7;\n\t\t\t\t\ttype = \"W\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (type === \"W\")\n\t\t\t{\n\t\t\t\tresult = BX.Loc.getMessagePlural('CRM_TIMELINE_WAIT_WEEK', duration);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult = BX.Loc.getMessagePlural('CRM_TIMELINE_WAIT_DAY', duration);\n\t\t\t}\n\n\t\t\tif(enableNumber)\n\t\t\t{\n\t\t\t\tresult = duration.toString() + \" \" + result;\n\t\t\t}\n\t\t\treturn result;\n\t\t},\n\t\tgetMessage: function(name)\n\t\t{\n\t\t\treturn Wait.Helper.messages.hasOwnProperty(name) ? Wait.Helper.messages[name] : name;\n\t\t},\n\t\tmessages: {},\n\t}\n}\n","import Editor from \"../editor\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class Sms extends Editor\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._history = null;\n\t\tthis._serviceUrl = \"\";\n\n\t\tthis._isRequestRunning = false;\n\t\tthis._isLocked = false;\n\n\t\tthis._senderId = null;\n\t\tthis._from = null;\n\t\tthis._commEntityTypeId = null;\n\t\tthis._commEntityId = null;\n\t\tthis._to = null;\n\n\t\tthis._canUse = null;\n\t\tthis._canSendMessage = null;\n\t\tthis._manageUrl = '';\n\t\tthis._senders = [];\n\t\tthis._fromList = [];\n\t\tthis._toList = [];\n\t\tthis._defaults = {};\n\t\tthis._communications = [];\n\n\t\tthis._menu = null;\n\t\tthis._isMenuShown = false;\n\t\tthis._shownMenuId = null;\n\t\tthis._documentSelector = null;\n\t\tthis._source = null;\n\n\t\tthis._paymentId = null;\n\t\tthis._shipmentId = null;\n\n\t\tthis._compilationProductIds = [];\n\n\t\tthis._templateId = null;\n\t\tthis._templatesContainer = null;\n\t\tthis._templateFieldHintNode = null;\n\t\tthis._templateSelectorNode = null;\n\t\tthis._templateTemplateTitleNode = null;\n\t\tthis._templatePreviewNode = null;\n\t\tthis._templateSelectorMenuId = 'CrmTimelineSmsEditorTemplateSelector';\n\t\tthis._templateFieldHintHandler = BX.delegate(this.onTemplateHintIconClick, this);\n\t\tthis._templateSeletorClickHandler = BX.delegate(this.onTemplateSelectClick, this);\n\t\tthis._selectTemplateHandler = BX.delegate(this.onSelectTemplate, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._serviceUrl = BX.util.remove_url_param(\n\t\t\tthis.getSetting(\"serviceUrl\", \"\"),\n\t\t\t['sessid', 'site']\n\t\t);\n\n\t\tconst config = BX.prop.getObject(this._settings, \"config\", {});\n\n\t\tthis._canUse = BX.prop.getBoolean(config, \"canUse\", false);\n\t\tthis._canSendMessage = BX.prop.getBoolean(config, \"canSendMessage\", false);\n\t\tthis._manageUrl = BX.prop.getString(config, \"manageUrl\", '');\n\t\tthis._senders = BX.prop.getArray(config, \"senders\", []);\n\t\tthis._defaults = BX.prop.getObject(config, \"defaults\", {senderId:null,from:null});\n\t\tthis._communications = BX.prop.getArray(config, \"communications\", []);\n\t\tthis._isSalescenterEnabled = BX.prop.getBoolean(config, \"isSalescenterEnabled\", false);\n\t\tthis._isDocumentsEnabled = BX.prop.getBoolean(config, \"isDocumentsEnabled\", false);\n\t\tif(this._isDocumentsEnabled)\n\t\t{\n\t\t\tthis._documentsProvider = BX.prop.getString(config, \"documentsProvider\", '');\n\t\t\tthis._documentsValue = BX.prop.getString(config, \"documentsValue\", '');\n\t\t}\n\t\tthis._isFilesEnabled = BX.prop.getBoolean(config, \"isFilesEnabled\", false);\n\t\tif(this._isFilesEnabled)\n\t\t{\n\t\t\tthis._diskUrls = BX.prop.getObject(config, \"diskUrls\");\n\t\t\tthis._isFilesExternalLinkEnabled = BX.prop.getBoolean(config, \"isFilesExternalLinkEnabled\", true);\n\t\t}\n\n\t\tthis._senderSelectorNode = this._container.querySelector('[data-role=\"sender-selector\"]');\n\t\tthis._fromContainerNode = this._container.querySelector('[data-role=\"from-container\"]');\n\t\tthis._fromSelectorNode = this._container.querySelector('[data-role=\"from-selector\"]');\n\t\tthis._clientContainerNode = this._container.querySelector('[data-role=\"client-container\"]');\n\t\tthis._clientSelectorNode = this._container.querySelector('[data-role=\"client-selector\"]');\n\t\tthis._toSelectorNode = this._container.querySelector('[data-role=\"to-selector\"]');\n\t\tthis._messageLengthCounterWrapperNode = this._container.querySelector('[data-role=\"message-length-counter-wrap\"]');\n\t\tthis._messageLengthCounterNode = this._container.querySelector('[data-role=\"message-length-counter\"]');\n\t\tthis._salescenterStarter = this._container.querySelector('[data-role=\"salescenter-starter\"]');\n\t\tthis._smsDetailSwitcher = this._container.querySelector('[data-role=\"sms-detail-switcher\"]');\n\t\tthis._smsDetail = this._container.querySelector('[data-role=\"sms-detail\"]');\n\t\tthis._documentSelectorButton = this._container.querySelector('[data-role=\"sms-document-selector\"]');\n\t\tthis._fileSelectorButton = this._container.querySelector('[data-role=\"sms-file-selector\"]');\n\t\tthis._fileUploadZone = this._container.querySelector('[data-role=\"sms-file-upload-zone\"]');\n\t\tthis._fileUploadLabel = this._container.querySelector('[data-role=\"sms-file-upload-label\"]');\n\t\tthis._fileSelectorBitrix = this._container.querySelector('[data-role=\"sms-file-selector-bitrix\"]');\n\t\tthis._fileExternalLinkDisabledContent = this._container.querySelector('[data-role=\"sms-file-external-link-disabled\"]');\n\n\t\tthis._templatesContainer = BX(this.getSetting(\"templatesContainer\"));\n\t\tif (this._templatesContainer)\n\t\t{\n\t\t\tthis._templateFieldHintNode = this._templatesContainer.querySelector('[data-role=\"hint\"]');\n\t\t\tthis._templateSelectorNode = this._templatesContainer.querySelector('[data-role=\"template-selector\"]');\n\t\t\tthis._templateTemplateTitleNode = this._templatesContainer.querySelector('[data-role=\"template-title\"]');\n\t\t\tthis._templatePreviewNode = this._templatesContainer.querySelector('[data-role=\"preview\"]');\n\t\t}\n\t\tif (this._templateFieldHintNode)\n\t\t{\n\t\t\tBX.bind(this._templateFieldHintNode, \"click\", this._templateFieldHintHandler);\n\t\t}\n\t\tif (this._templateSelectorNode)\n\t\t{\n\t\t\tBX.bind(this._templateSelectorNode, \"click\", this._templateSeletorClickHandler);\n\t\t}\n\n\t\tif (this._canUse && this._senders.length > 0)\n\t\t{\n\t\t\tthis.initSenderSelector();\n\t\t}\n\t\tif (this._canUse && this._canSendMessage)\n\t\t{\n\t\t\tthis.initDetailSwitcher();\n\t\t\tthis.initFromSelector();\n\t\t\tthis.initClientContainer();\n\t\t\tthis.initClientSelector();\n\t\t\tthis.initToSelector();\n\t\t\tthis.initMessageLengthCounter();\n\t\t\tthis.setMessageLengthCounter();\n\t\t\tif(this._isDocumentsEnabled)\n\t\t\t{\n\t\t\t\tthis.initDocumentSelector();\n\t\t\t}\n\t\t\tif(this._isFilesEnabled)\n\t\t\t{\n\t\t\t\tthis.initFileSelector();\n\t\t\t}\n\t\t}\n\n\t\tif(this._isSalescenterEnabled)\n\t\t{\n\t\t\tthis.initSalescenterApplication();\n\t\t}\n\t}\n\n\tinitDetailSwitcher()\n\t{\n\t\tBX.bind(this._smsDetailSwitcher, 'click', function()\n\t\t{\n\t\t\tif(this._smsDetail.classList.contains('hidden'))\n\t\t\t{\n\t\t\t\tthis._smsDetail.classList.remove('hidden');\n\t\t\t\tthis._smsDetailSwitcher.innerText = BX.message('CRM_TIMELINE_COLLAPSE');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._smsDetail.classList.add('hidden');\n\t\t\t\tthis._smsDetailSwitcher.innerText = BX.message('CRM_TIMELINE_DETAILS');\n\t\t\t}\n\t\t}.bind(this));\n\t}\n\n\tinitSenderSelector()\n\t{\n\t\tconst defaultSenderId = this._defaults.senderId;\n\t\tlet defaultSender = this._senders[0].canUse ? this._senders[0] : null;\n\t\tlet restSender = null;\n\t\tconst menuItems = [];\n\t\tconst handler = this.onSenderSelectorClick.bind(this);\n\n\t\tfor (let i = 0; i < this._senders.length; ++i)\n\t\t{\n\t\t\tif (this._senders[i].canUse && this._senders[i].fromList.length && (this._senders[i].id === defaultSenderId || !defaultSender))\n\t\t\t{\n\t\t\t\tdefaultSender = this._senders[i];\n\t\t\t}\n\n\t\t\tif (this._senders[i].id === 'rest')\n\t\t\t{\n\t\t\t\trestSender = this._senders[i];\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._senders[i].name,\n\t\t\t\tsender: this._senders[i],\n\t\t\t\tonclick: handler,\n\t\t\t\tclassName: (!this._senders[i].canUse || !this._senders[i].fromList.length)\n\t\t\t\t\t? 'crm-timeline-popup-menu-item-disabled menu-popup-no-icon' : ''\n\t\t\t});\n\t\t}\n\n\t\tif (restSender)\n\t\t{\n\t\t\tif (restSender.fromList.length > 0)\n\t\t\t{\n\t\t\t\tmenuItems.push({delimiter: true});\n\t\t\t\tfor (let i = 0; i < restSender.fromList.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tmenuItems.push({\n\t\t\t\t\t\ttext: restSender.fromList[i].name,\n\t\t\t\t\t\tsender: restSender,\n\t\t\t\t\t\tfrom: restSender.fromList[i],\n\t\t\t\t\t\tonclick: handler\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tmenuItems.push({delimiter: true}, {\n\t\t\t\ttext: BX.message('CRM_TIMELINE_SMS_REST_MARKETPLACE'),\n\t\t\t\thref: '/marketplace/category/crm_robot_sms/',\n\t\t\t\ttarget: '_blank'\n\t\t\t});\n\t\t}\n\n\t\tif (defaultSender)\n\t\t{\n\t\t\tthis.setSender(defaultSender);\n\t\t}\n\n\t\tBX.bind(this._senderSelectorNode, 'click', this.openMenu.bind(this, 'sender', this._senderSelectorNode, menuItems));\n\t}\n\n\tonSenderSelectorClick(e, item)\n\t{\n\t\tif (item.sender)\n\t\t{\n\t\t\tif (!item.sender.canUse || !item.sender.fromList.length)\n\t\t\t{\n\t\t\t\tconst url = BX.Uri.addParam(item.sender.manageUrl, {'IFRAME': 'Y'});\n\t\t\t\tconst slider = BX.SidePanel.Instance.getTopSlider();\n\t\t\t\tconst options = {\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonClose: function () {\n\t\t\t\t\t\t\tif (slider)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tslider.reload();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonCloseComplete: function () {\n\t\t\t\t\t\t\tif (!slider)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (item.sender.id === 'ednaru')\n\t\t\t\t{\n\t\t\t\t\toptions.width = 700;\n\t\t\t\t}\n\t\t\t\tBX.SidePanel.Instance.open(url, options);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setSender(item.sender, true);\n\t\t\tconst from = item.from ? item.from : item.sender.fromList[0];\n\t\t\tthis.setFrom(from, true);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetSender(sender, setAsDefault)\n\t{\n\t\tthis._senderId = sender.id;\n\t\tthis._fromList = sender.fromList;\n\t\tthis._senderSelectorNode.textContent = sender.shortName ? sender.shortName : sender.name;\n\n\t\tthis._templateId = null;\n\t\tif (sender.isTemplatesBased)\n\t\t{\n\t\t\tthis.showNode(this._templatesContainer);\n\t\t\tthis.hideNode(this._messageLengthCounterWrapperNode);\n\t\t\tthis.hideNode(this._fileSelectorButton);\n\t\t\tthis.hideNode(this._documentSelectorButton);\n\t\t\tthis.hideNode(this._input);\n\t\t\tthis.toggleTemplateSelectAvailability();\n\t\t\tthis.toggleSaveButton();\n\t\t\tthis._hideButtonsOnBlur = false;\n\t\t\tthis.onFocus();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideNode(this._templatesContainer);\n\t\t\tthis.showNode(this._messageLengthCounterWrapperNode);\n\t\t\tthis.showNode(this._fileSelectorButton);\n\t\t\tthis.showNode(this._documentSelectorButton);\n\t\t\tthis.showNode(this._input);\n\t\t\tthis.setMessageLengthCounter();\n\t\t\tthis._hideButtonsOnBlur = true;\n\t\t}\n\n\t\tconst visualFn = sender.id === 'rest' ? 'hide' : 'show';\n\t\tBX[visualFn](this._fromContainerNode);\n\n\t\tif (setAsDefault)\n\t\t{\n\t\t\tBX.userOptions.save(\"crm\", \"sms_manager_editor\", \"senderId\", this._senderId);\n\t\t}\n\t}\n\n\tshowNode(node)\n\t{\n\t\tif (node)\n\t\t{\n\t\t\tnode.style.display = \"\";\n\t\t}\n\t}\n\n\thideNode(node)\n\t{\n\t\tif (node)\n\t\t{\n\t\t\tnode.style.display = \"none\";\n\t\t}\n\t}\n\n\tinitFromSelector()\n\t{\n\t\tif (this._fromList.length > 0)\n\t\t{\n\t\t\tconst defaultFromId = this._defaults.from || this._fromList[0].id;\n\t\t\tlet defaultFrom = null;\n\t\t\tfor (let i = 0; i < this._fromList.length; ++i)\n\t\t\t{\n\t\t\t\tif (this._fromList[i].id === defaultFromId || !defaultFrom)\n\t\t\t\t{\n\t\t\t\t\tdefaultFrom = this._fromList[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (defaultFrom)\n\t\t\t{\n\t\t\t\tthis.setFrom(defaultFrom);\n\t\t\t}\n\t\t}\n\n\t\tBX.bind(this._fromSelectorNode, 'click', this.onFromSelectorClick.bind(this));\n\t}\n\n\tonFromSelectorClick(e)\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = this.onFromSelectorItemClick.bind(this);\n\n\t\tfor (let i = 0; i < this._fromList.length; ++i)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._fromList[i].name,\n\t\t\t\tfrom: this._fromList[i],\n\t\t\t\tonclick: handler\n\t\t\t});\n\t\t}\n\n\t\tthis.openMenu('from_'+this._senderId, this._fromSelectorNode, menuItems, e);\n\t}\n\n\tonFromSelectorItemClick(e, item)\n\t{\n\t\tif (item.from)\n\t\t{\n\t\t\tthis.setFrom(item.from, true);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetFrom(from, setAsDefault)\n\t{\n\t\tthis._from = from.id;\n\n\t\tif (this._senderId === 'rest')\n\t\t{\n\t\t\tthis._senderSelectorNode.textContent = from.name;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._fromSelectorNode.textContent = from.name;\n\t\t}\n\n\t\tif (setAsDefault)\n\t\t{\n\t\t\tBX.userOptions.save(\"crm\", \"sms_manager_editor\", \"from\", this._from);\n\t\t}\n\t}\n\n\tinitClientContainer()\n\t{\n\t\tif (this._communications.length === 0)\n\t\t{\n\t\t\tBX.hide(this._clientContainerNode);\n\t\t}\n\t}\n\n\tinitClientSelector()\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = this.onClientSelectorClick.bind(this);\n\n\t\tfor (let i = 0; i < this._communications.length; ++i)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._communications[i].caption,\n\t\t\t\tclient: this._communications[i],\n\t\t\t\tonclick: handler\n\t\t\t});\n\t\t\tif (i === 0)\n\t\t\t{\n\t\t\t\tthis.setClient(this._communications[i]);\n\t\t\t}\n\t\t}\n\n\t\tBX.bind(this._clientSelectorNode, 'click', this.openMenu.bind(this, 'comm', this._clientSelectorNode, menuItems));\n\t}\n\n\tonClientSelectorClick(e, item)\n\t{\n\t\tif (item.client)\n\t\t{\n\t\t\tthis.setClient(item.client);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetClient(client)\n\t{\n\t\tthis._commEntityTypeId = client.entityTypeId;\n\t\tthis._commEntityId = client.entityId;\n\t\tthis._clientSelectorNode.textContent = client.caption;\n\t\tthis._toList = client.phones;\n\t\tthis.setTo(client.phones[0]);\n\t}\n\n\tinitToSelector()\n\t{\n\t\tBX.bind(this._toSelectorNode, 'click', this.onToSelectorClick.bind(this));\n\t}\n\n\tonToSelectorClick(e)\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = this.onToSelectorItemClick.bind(this);\n\n\t\tfor (let i = 0; i < this._toList.length; ++i)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this._toList[i].valueFormatted || this._toList[i].value,\n\t\t\t\tto: this._toList[i],\n\t\t\t\tonclick: handler\n\t\t\t});\n\t\t}\n\n\t\tthis.openMenu('to_'+this._commEntityTypeId+'_'+this._commEntityId, this._toSelectorNode, menuItems, e);\n\t}\n\n\tonToSelectorItemClick(e, item)\n\t{\n\t\tif (item.to)\n\t\t{\n\t\t\tthis.setTo(item.to);\n\t\t}\n\t\tthis._menu.close();\n\t}\n\n\tsetTo(to)\n\t{\n\t\tthis._to = to.value;\n\t\tthis._toSelectorNode.textContent = to.valueFormatted || to.value;\n\t}\n\n\topenMenu(menuId, bindElement, menuItems, e)\n\t{\n\t\tif (this._shownMenuId === menuId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._shownMenuId !== null && this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t\tthis._shownMenuId = null;\n\t\t}\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id + menuId,\n\t\t\tbindElement,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 36,\n\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu = BX.PopupMenu.currentItem;\n\t\te.preventDefault();\n\t}\n\n\tonMenuClose()\n\t{\n\t\tthis._shownMenuId = null;\n\t\tthis._menu = null;\n\t}\n\n\tinitMessageLengthCounter()\n\t{\n\t\tthis._messageLengthMax = parseInt(this._messageLengthCounterNode.getAttribute('data-length-max'));\n\t\tBX.bind(this._input, 'keyup', this.setMessageLengthCounter.bind(this));\n\t\tBX.bind(this._input, 'cut', this.setMessageLengthCounterDelayed.bind(this));\n\t\tBX.bind(this._input, 'paste', this.setMessageLengthCounterDelayed.bind(this));\n\t}\n\n\tsetMessageLengthCounterDelayed()\n\t{\n\t\tsetTimeout(this.setMessageLengthCounter.bind(this), 0);\n\t}\n\n\tsetMessageLengthCounter()\n\t{\n\t\tconst length = this._input.value.length;\n\t\tthis._messageLengthCounterNode.textContent = length;\n\n\t\tconst classFn = length >= this._messageLengthMax ? 'addClass' : 'removeClass';\n\t\tBX[classFn](this._messageLengthCounterNode, 'crm-entity-stream-content-sms-symbol-counter-number-overhead');\n\n\t\tthis.toggleSaveButton();\n\t}\n\n\ttoggleSaveButton()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\t\tlet enabled;\n\t\tif (!sender || !sender.isTemplatesBased)\n\t\t{\n\t\t\tenabled = this._input.value.length > 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tenabled = !!this._templateId;\n\t\t}\n\t\tif (enabled)\n\t\t{\n\t\t\tBX.removeClass(this._saveButton, 'ui-btn-disabled');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addClass(this._saveButton, 'ui-btn-disabled');\n\t\t}\n\t}\n\n\tsave()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\n\t\tlet text = '';\n\t\tlet templateId = '';\n\n\t\tif (!sender || !sender.isTemplatesBased)\n\t\t{\n\t\t\ttext = this._input.value;\n\t\t\tif (text === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst template = this.getSelectedTemplate();\n\t\t\tif (!template)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttext = template.PREVIEW;\n\t\t\ttemplateId = template.ID;\n\t\t}\n\n\t\tif (!this._communications.length)\n\t\t{\n\t\t\talert(BX.message('CRM_TIMELINE_SMS_ERROR_NO_COMMUNICATIONS'));\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isRequestRunning || this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isRequestRunning = this._isLocked = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: BX.util.add_url_param(this._serviceUrl, {\n\t\t\t\t\t\"action\": \"save_sms_message\",\n\t\t\t\t\t\"sender\": this._senderId\n\t\t\t\t}),\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t'site': BX.message('SITE_ID'),\n\t\t\t\t\t\t'sessid': BX.bitrix_sessid(),\n\t\t\t\t\t\t'source': this._source,\n\t\t\t\t\t\t\"ACTION\": \"SAVE_SMS_MESSAGE\",\n\t\t\t\t\t\t\"SENDER_ID\": this._senderId,\n\t\t\t\t\t\t\"MESSAGE_FROM\": this._from,\n\t\t\t\t\t\t\"MESSAGE_TO\": this._to,\n\t\t\t\t\t\t\"MESSAGE_BODY\": text,\n\t\t\t\t\t\t\"MESSAGE_TEMPLATE\": templateId,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._ownerTypeId,\n\t\t\t\t\t\t\"OWNER_ID\": this._ownerId,\n\t\t\t\t\t\t\"TO_ENTITY_TYPE_ID\": this._commEntityTypeId,\n\t\t\t\t\t\t\"TO_ENTITY_ID\": this._commEntityId,\n\t\t\t\t\t\t\"PAYMENT_ID\": this._paymentId,\n\t\t\t\t\t\t\"SHIPMENT_ID\": this._shipmentId,\n\t\t\t\t\t\t\"COMPILATION_PRODUCT_IDS\": this._compilationProductIds,\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onSaveFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tcancel()\n\t{\n\t\tthis._input.value = \"\";\n\t\tthis.setMessageLengthCounter();\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis.release();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\n\t\tconst error = BX.prop.getString(data, \"ERROR\", \"\");\n\t\tif(error !== \"\")\n\t\t{\n\t\t\talert(error);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._input.value = \"\";\n\t\tthis.setMessageLengthCounter();\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis._manager.processEditingCompletion(this);\n\t\tthis.release();\n\t}\n\n\tonSaveFailure()\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tinitSalescenterApplication()\n\t{\n\t\tBX.bind(this._salescenterStarter, 'click', this.startSalescenterApplication.bind(this));\n\t}\n\n\tstartSalescenterApplication()\n\t{\n\t\tBX.loadExt('salescenter.manager').then(function()\n\t\t{\n\t\t\tBX.Salescenter.Manager.openApplication({\n\t\t\t\tdisableSendButton: this._canSendMessage ? '' : 'y',\n\t\t\t\tcontext: 'sms',\n\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\townerId: this._ownerId,\n\t\t\t\tmode: this._ownerTypeId === BX.CrmEntityType.enumeration.deal ? 'payment_delivery' : 'payment',\n\t\t\t}).then(function(result)\n\t\t\t{\n\t\t\t\tif(result && result.get('action'))\n\t\t\t\t{\n\t\t\t\t\tif(result.get('action') === 'sendPage' && result.get('page') && result.get('page').url)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._input.focus();\n\t\t\t\t\t\tthis._input.value = this._input.value + result.get('page').name + ' ' + result.get('page').url;\n\t\t\t\t\t\tthis.setMessageLengthCounter();\n\t\t\t\t\t}\n\t\t\t\t\telse if (result.get('action') === 'sendPayment' && result.get('order'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._input.focus();\n\t\t\t\t\t\tthis._input.value = this._input.value + result.get('order').title;\n\t\t\t\t\t\tthis.setMessageLengthCounter();\n\t\t\t\t\t\tthis._source = 'order';\n\t\t\t\t\t\tthis._paymentId = result.get('order').paymentId;\n\t\t\t\t\t\tthis._shipmentId = result.get('order').shipmentId;\n\t\t\t\t\t}\n\t\t\t\t\telse if(result.get('action') === 'sendCompilation' && result.get('compilation'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._input.focus();\n\t\t\t\t\t\tthis._input.value = this._input.value + result.get('compilation').title;\n\t\t\t\t\t\tthis.setMessageLengthCounter();\n\t\t\t\t\t\tthis._source = 'deal';\n\t\t\t\t\t\tthis._compilationProductIds = result.get('compilation').productIds;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}.bind(this));\n\t}\n\n\tinitDocumentSelector()\n\t{\n\t\tBX.bind(this._documentSelectorButton, 'click', this.onDocumentSelectorClick.bind(this));\n\t}\n\n\tonDocumentSelectorClick()\n\t{\n\t\tif(!this._documentSelector)\n\t\t{\n\t\t\tBX.loadExt('documentgenerator.selector').then(function()\n\t\t\t{\n\t\t\t\tthis._documentSelector = new BX.DocumentGenerator.Selector.Menu({\n\t\t\t\t\tnode: this._documentSelectorButton,\n\t\t\t\t\tmoduleId: 'crm',\n\t\t\t\t\tprovider: this._documentsProvider,\n\t\t\t\t\tvalue: this._documentsValue,\n\t\t\t\t\tanalyticsLabelPrefix: 'crmTimelineSmsEditor'\n\t\t\t\t});\n\t\t\t\tthis.selectPublicUrl();\n\t\t\t}.bind(this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.selectPublicUrl();\n\t\t}\n\t}\n\n\tselectPublicUrl()\n\t{\n\t\tif(!this._documentSelector)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._documentSelector.show().then(function(object)\n\t\t{\n\t\t\tif(object instanceof BX.DocumentGenerator.Selector.Template)\n\t\t\t{\n\t\t\t\tthis._documentSelector.createDocument(object).then(function(document)\n\t\t\t\t{\n\t\t\t\t\tthis.pasteDocumentUrl(document);\n\t\t\t\t}.bind(this)).catch(function(error)\n\t\t\t\t{\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t}.bind(this));\n\t\t\t}\n\t\t\telse if(object instanceof BX.DocumentGenerator.Selector.Document)\n\t\t\t{\n\t\t\t\tthis.pasteDocumentUrl(object);\n\t\t\t}\n\t\t}.bind(this)).catch(function(error)\n\t\t{\n\t\t\tconsole.error(error);\n\t\t}.bind(this));\n\t}\n\n\tpasteDocumentUrl(document)\n\t{\n\t\tthis._documentSelector.getDocumentPublicUrl(document).then(function(publicUrl)\n\t\t{\n\t\t\tthis._input.focus();\n\t\t\tthis._input.value = this._input.value + ' ' + document.getTitle() + ' ' + publicUrl;\n\t\t\tthis.setMessageLengthCounter();\n\t\t\tthis._source = 'document';\n\t\t}.bind(this)).catch(function(error)\n\t\t{\n\t\t\tconsole.error(error);\n\t\t}.bind(this));\n\t}\n\n\tinitFileSelector()\n\t{\n\t\tBX.bind(this._fileSelectorButton, 'click', this.onFileSelectorClick.bind(this));\n\t}\n\n\tcloseFileSelector()\n\t{\n\t\tBX.PopupMenu.destroy('sms-file-selector');\n\t}\n\n\tonFileSelectorClick()\n\t{\n\t\tBX.PopupMenu.show('sms-file-selector', this._fileSelectorButton, [\n\t\t\t{\n\t\t\t\ttext: BX.message('CRM_TIMELINE_SMS_UPLOAD_FILE'),\n\t\t\t\tonclick: this.uploadFile.bind(this),\n\t\t\t\tclassName: this._isFilesExternalLinkEnabled ? '' : 'crm-entity-stream-content-sms-menu-item-with-lock'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: BX.message('CRM_TIMELINE_SMS_FIND_FILE'),\n\t\t\t\tonclick: this.findFile.bind(this),\n\t\t\t\tclassName: this._isFilesExternalLinkEnabled ? '' : 'crm-entity-stream-content-sms-menu-item-with-lock'\n\t\t\t}\n\t\t])\n\t}\n\n\tgetFileUploadInput()\n\t{\n\t\treturn document.getElementById(this._fileUploadLabel.getAttribute('for'));\n\t}\n\n\tuploadFile()\n\t{\n\t\tthis.closeFileSelector();\n\t\tif(this._isFilesExternalLinkEnabled)\n\t\t{\n\t\t\tthis.initDiskUF();\n\t\t\tBX.fireEvent(this.getFileUploadInput(), 'click');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showFilesExternalLinkFeaturePopup();\n\t\t}\n\t}\n\n\tfindFile()\n\t{\n\t\tthis.closeFileSelector();\n\t\tif(this._isFilesExternalLinkEnabled)\n\t\t{\n\t\t\tthis.initDiskUF();\n\t\t\tBX.fireEvent(this._fileSelectorBitrix, 'click');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showFilesExternalLinkFeaturePopup();\n\t\t}\n\t}\n\n\tgetLoader()\n\t{\n\t\tif(!this.loader)\n\t\t{\n\t\t\tthis.loader = new BX.Loader(\n\t\t\t\t{\n\t\t\t\t\tsize: 50\n\t\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(node)\n\t{\n\t\tif(node && !this.getLoader().isShown())\n\t\t{\n\t\t\tthis.getLoader().show(node);\n\t\t}\n\t}\n\n\thideLoader()\n\t{\n\t\tif(this.getLoader().isShown())\n\t\t{\n\t\t\tthis.getLoader().hide();\n\t\t}\n\t}\n\n\tinitDiskUF()\n\t{\n\t\tif(this.isDiskFileUploaderInited || !this._isFilesEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.isDiskFileUploaderInited = true;\n\t\tBX.addCustomEvent(this._fileUploadZone, 'OnFileUploadSuccess', this.OnFileUploadSuccess.bind(this));\n\t\tBX.addCustomEvent(this._fileUploadZone, 'DiskDLoadFormControllerInit', function(uf)\n\t\t{\n\t\t\tuf._onUploadProgress = function()\n\t\t\t{\n\t\t\t\tthis.showLoader(this._fileSelectorButton.parentNode.parentNode);\n\t\t\t}.bind(this);\n\t\t}.bind(this));\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: this._fileUploadZone.getAttribute('data-node-id'),\n\t\t\tcontrolName: this._fileUploadLabel.getAttribute('for'),\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect: this._diskUrls.urlSelect,\n\t\t\turlRenameFile: this._diskUrls.urlRenameFile,\n\t\t\turlDeleteFile: this._diskUrls.urlDeleteFile,\n\t\t\turlUpload: this._diskUrls.urlUpload\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis._fileUploadZone,\n\t\t\t'DiskLoadFormController',\n\t\t\t['show']\n\t\t);\n\t}\n\n\tOnFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tthis.hideLoader();\n\t\tconst diskFileId = parseInt(fileResult.element_id.replace('n', ''));\n\t\tconst fileName = fileResult.element_name;\n\t\tthis.pasteFileUrl(diskFileId, fileName);\n\t}\n\n\tpasteFileUrl(diskFileId, fileName)\n\t{\n\t\tthis.showLoader(this._fileSelectorButton.parentNode.parentNode);\n\t\tBX.ajax.runAction('disk.file.generateExternalLink', {\n\t\t\tanalyticsLabel: 'crmTimelineSmsEditorGetFilePublicUrl',\n\t\t\tdata: {\n\t\t\t\tfileId: diskFileId\n\t\t\t}\n\t\t}).then(function(response)\n\t\t{\n\t\t\tthis.hideLoader();\n\t\t\tif(response.data.externalLink && response.data.externalLink.link)\n\t\t\t{\n\t\t\t\tthis._input.focus();\n\t\t\t\tthis._input.value = this._input.value + ' ' + fileName + ' ' + response.data.externalLink.link;\n\t\t\t\tthis.setMessageLengthCounter();\n\t\t\t\tthis._source = 'file';\n\t\t\t}\n\t\t}.bind(this)).catch(function(response)\n\t\t{\n\t\t\tconsole.error(response.errors.pop().message);\n\t\t});\n\t}\n\n\tgetFeaturePopup(content)\n\t{\n\t\tif(this.featurePopup != null)\n\t\t{\n\t\t\treturn this.featurePopup;\n\t\t}\n\t\tthis.featurePopup = new BX.PopupWindow('bx-popup-crm-sms-editor-feature-popup', null, {\n\t\t\tzIndex: 200,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: true,\n\t\t\toverlay : true,\n\t\t\tevents : {\n\t\t\t\tonPopupDestroy : function()\n\t\t\t\t{\n\t\t\t\t\tthis.featurePopup = null;\n\t\t\t\t}.bind(this)\n\t\t\t},\n\t\t\tcontent : content,\n\t\t\tcontentColor: 'white'\n\t\t});\n\n\t\treturn this.featurePopup;\n\t}\n\n\tshowFilesExternalLinkFeaturePopup()\n\t{\n\t\tthis.getFeaturePopup(this._fileExternalLinkDisabledContent).show();\n\t}\n\n\tonTemplateHintIconClick()\n\t{\n\t\tif (this._senderId === 'ednaru')\n\t\t{\n\t\t\ttop.BX.Helper.show(\"redirect=detail&code=14214014\");\n\t\t}\n\t}\n\n\tshowTemplateSelectDropdown(items)\n\t{\n\t\tconst menuItems = [];\n\t\tif (BX.Type.isArray(items))\n\t\t{\n\t\t\tif (items.length)\n\t\t\t{\n\t\t\t\titems.forEach(function(item)\n\t\t\t\t{\n\t\t\t\t\tmenuItems.push({\n\t\t\t\t\t\tvalue: item.ID,\n\t\t\t\t\t\ttext: item.TITLE,\n\t\t\t\t\t\tonclick: this._selectTemplateHandler\n\t\t\t\t\t})\n\t\t\t\t}.bind(this));\n\n\t\t\t\tBX.PopupMenu.show({\n\t\t\t\t\tid: this._templateSelectorMenuId,\n\t\t\t\t\tbindElement: this._templateSelectorNode,\n\t\t\t\t\titems: menuItems,\n\t\t\t\t\tangle: false,\n\t\t\t\t\twidth: this._templateSelectorNode.offsetWidth,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\telse if (this._senderId)\n\t\t{\n\t\t\tconst loaderMenuId = this._templateSelectorMenuId + 'loader';\n\t\t\tconst loaderMenuLoaderId = this._templateSelectorMenuId + 'loader';\n\n\t\t\tBX.PopupMenu.show({\n\t\t\t\tid: loaderMenuId,\n\t\t\t\tbindElement: this._templateSelectorNode,\n\t\t\t\titems: [{\n\t\t\t\t\thtml: '<div id=\"' + loaderMenuLoaderId + '\"></div>',\n\t\t\t\t}],\n\t\t\t\tangle: false,\n\t\t\t\twidth: this._templateSelectorNode.offsetWidth,\n\t\t\t\theight: 60,\n\t\t\t\tevents: {\n\t\t\t\t\tonDestroy: function() {\n\t\t\t\t\t\tthis.hideLoader();\n\t\t\t\t\t}.bind(this)\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.showLoader(BX(loaderMenuLoaderId));\n\n\t\t\tif (!this._isRequestRunning)\n\t\t\t{\n\t\t\t\tthis._isRequestRunning = true;\n\t\t\t\tconst senderId = this._senderId;\n\t\t\t\tBX.ajax.runAction(\n\t\t\t\t\t'messageservice.Sender.getTemplates',\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: senderId,\n\t\t\t\t\t\t\tcontext: {\n\t\t\t\t\t\t\t\tmodule: 'crm',\n\t\t\t\t\t\t\t\tentityTypeId: this._manager._ownerTypeId,\n\t\t\t\t\t\t\t\tentityId: this._manager._ownerId,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t\t.then(function(response)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t\t\tconst sender = this._senders.find(function (sender) {\n\t\t\t\t\t\t\treturn (sender.id === senderId);\n\t\t\t\t\t\t}.bind(this));\n\n\t\t\t\t\t\tif (sender)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsender.templates = response.data.templates;\n\t\t\t\t\t\t\tthis.toggleTemplateSelectAvailability();\n\t\t\t\t\t\t\tif (BX.PopupMenu.getMenuById(loaderMenuId))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.PopupMenu.getMenuById(loaderMenuId).close();\n\t\t\t\t\t\t\t\tthis.showTemplateSelectDropdown(sender.templates);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this))\n\t\t\t\t\t.catch(function(response)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t\t\tif (BX.PopupMenu.getMenuById(loaderMenuId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (response && response.errors && response.errors[0] && response.errors[0].message)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\talert(response.errors[0].message);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tBX.PopupMenu.getMenuById(loaderMenuId).close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this))\n\t\t\t\t;\n\t\t\t}\n\t\t}\n\n\t}\n\n\tgetSelectedSender()\n\t{\n\t\treturn this._senders.find(function(sender) {\n\t\t\treturn (sender.id === this._senderId);\n\t\t}.bind(this));\n\t}\n\n\tgetSelectedTemplate()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\t\tif (!this._templateId || !sender || !sender.templates)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst template = sender.templates.find(function (template) {\n\t\t\treturn template.ID == this._templateId;\n\t\t}.bind(this));\n\n\t\treturn template ? template : null;\n\t}\n\n\tonTemplateSelectClick()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\n\t\tif (sender)\n\t\t{\n\t\t\tthis.showTemplateSelectDropdown(sender.templates);\n\t\t}\n\t}\n\n\tonSelectTemplate(e, item)\n\t{\n\t\tthis._templateId = item.value;\n\t\tthis.applySelectedTemplate();\n\t\tthis.toggleSaveButton();\n\t\tconst menu = BX.PopupMenu.getMenuById(this._templateSelectorMenuId);\n\t\tif (menu)\n\t\t{\n\t\t\tmenu.close();\n\t\t}\n\t}\n\n\ttoggleTemplateSelectAvailability()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\t\tif (sender && BX.Type.isArray(sender.templates) && !sender.templates.length)\n\t\t{\n\t\t\tBX.addClass(this._templateSelectorNode, 'ui-ctl-disabled');\n\t\t\tthis._templateTemplateTitleNode.textContent = BX.message('CRM_TIMELINE_SMS_TEMPLATES_NOT_FOUND');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.removeClass(this._templateSelectorNode, 'ui-ctl-disabled');\n\t\t\tthis.applySelectedTemplate();\n\t\t}\n\t}\n\n\tapplySelectedTemplate()\n\t{\n\t\tconst sender = this.getSelectedSender();\n\t\tif (!this._templateId || !sender || !sender.templates)\n\t\t{\n\t\t\tthis.hideNode(this._templatePreviewNode);\n\t\t\tthis._templateTemplateTitleNode.textContent = '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst template = this.getSelectedTemplate();\n\t\t\tif (template)\n\t\t\t{\n\t\t\t\tconst preview = BX.Text.encode(template.PREVIEW).replace(/\\n/g, '<br>');\n\n\t\t\t\tthis.showNode(this._templatePreviewNode);\n\t\t\t\tthis._templatePreviewNode.innerHTML = preview;\n\t\t\t\tthis._templateTemplateTitleNode.textContent = template.TITLE;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideNode(this._templatePreviewNode);\n\t\t\t\tthis._templateTemplateTitleNode.textContent = '';\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Sms();\n\t\tself.initialize(id, settings);\n\t\tSms.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n}\n","import Editor from \"../editor\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class Rest extends Editor\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._interfaceInitialized = false;\n\t}\n\n\taction(action)\n\t{\n\t\tif(!this._interfaceInitialized)\n\t\t{\n\t\t\tthis._interfaceInitialized = true;\n\t\t\tthis.initializeInterface();\n\t\t}\n\n\t\tif(action === 'activity_rest_applist')\n\t\t{\n\t\t\tBX.rest.Marketplace.open({\n\t\t\t\tPLACEMENT: this.getSetting(\"placement\", '')\n\t\t\t});\n\n\t\t\ttop.BX.addCustomEvent(top, 'Rest:AppLayout:ApplicationInstall', BX.proxy(this.fireUpdateEvent, this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst appId = action.replace('activity_rest_', '');\n\t\t\tconst appData = appId.split('_');\n\n\t\t\tBX.rest.AppLayout.openApplication(\n\t\t\t\tappData[0],\n\t\t\t\t{\n\t\t\t\t\tID: this._ownerId\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tPLACEMENT: this.getSetting(\"placement\", ''),\n\t\t\t\t\tPLACEMENT_ID: appData[1]\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tinitializeInterface()\n\t{\n\t\tif(!!top.BX.rest && !!top.BX.rest.AppLayout)\n\t\t{\n\t\t\tconst entityTypeId = this._manager._ownerTypeId, entityId = this._manager._ownerId;\n\n\t\t\tconst PlacementInterface = top.BX.rest.AppLayout.initializePlacement(this.getSetting(\"placement\", ''));\n\n\t\t\tPlacementInterface.prototype.reloadData = function(params, cb)\n\t\t\t{\n\t\t\t\tBX.Crm.EntityEvent.fireUpdate(entityTypeId, entityId, '');\n\t\t\t\tcb();\n\t\t\t};\n\t\t}\n\t}\n\n\tfireUpdateEvent()\n\t{\n\t\tconst entityTypeId = this._manager._ownerTypeId, entityId = this._manager._ownerId;\n\t\tsetTimeout(function(){\n\t\t\tconsole.log('fireUpdate', entityId, entityTypeId);\n\t\t\tBX.Crm.EntityEvent.fire(BX.Crm.EntityEvent.names.invalidate, entityTypeId, entityId, '');\n\t\t}, 3000);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\tRest.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n}\n","import Editor from \"../editor\";\n\n/** @memberof BX.Crm.Timeline.Editors */\nexport default class Comment extends Editor\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._history = null;\n\t\tthis._serviceUrl = \"\";\n\t\tthis._postForm = null;\n\t\tthis._editor = null;\n\t\tthis._isRequestRunning = false;\n\t\tthis._isLocked = false;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._serviceUrl = this.getSetting(\"serviceUrl\", \"\");\n\t\tBX.unbind(this._input, \"blur\", this._blurHandler);\n\t\tBX.unbind(this._input, \"keyup\", this._keyupHandler);\n\t}\n\n\tloadEditor()\n\t{\n\t\tthis._editorName = 'CrmTimeLineComment0';\n\n\t\tif (this._postForm)\n\t\t\treturn;\n\n\t\tBX.ajax.runAction(\n\t\t\t\"crm.api.timeline.loadEditor\",\n\t\t\t{ data: { name: this._editorName } }\n\t\t).then(this.onLoadEditorSuccess.bind(this));\n\t}\n\n\tonLoadEditorSuccess(result)\n\t{\n\t\tconst html = BX.prop.getString(BX.prop.getObject(result, \"data\", {}), \"html\", '');\n\t\tBX.html(this._editorContainer, html)\n\t\t\t.then(BX.delegate(this.showEditor,this))\n\t\t\t.then(BX.delegate(this.addEvents,this));\n\t}\n\n\taddEvents()\n\t{\n\t\tBX.addCustomEvent(\n\t\t\tthis._editorContainer.firstElementChild,\n\t\t\t'onFileIsAppended',\n\t\t\tBX.delegate(function(id, item) {\n\t\t\t\tBX.addClass(this._saveButton, 'ui-btn-disabled');\n\t\t\t\tBX.addClass(this._saveButton, 'ui-btn-clock');\n\t\t\t\tthis._saveButton.removeEventListener(\"click\", this._saveButtonHandler);\n\t\t\t}, this)\n\t\t);\n\n\t\tBX.addCustomEvent(\n\t\t\tthis._editorContainer.firstElementChild,\n\t\t\t'onFileIsAdded',\n\t\t\tBX.delegate(function(file, controller, obj, blob) {\n\t\t\t\tBX.removeClass(this._saveButton, 'ui-btn-clock');\n\t\t\t\tBX.removeClass(this._saveButton, 'ui-btn-disabled');\n\t\t\t\tthis._saveButton.addEventListener(\"click\", this._saveButtonHandler);\n\t\t\t}, this)\n\t\t);\n\t}\n\n\tshowEditor()\n\t{\n\t\tif (LHEPostForm)\n\t\t{\n\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\tthis._postForm = LHEPostForm.getHandler(this._editorName);\n\t\t\t\tthis._editor = BXHtmlEditor.Get(this._editorName);\n\t\t\t\tBX.onCustomEvent(this._postForm.eventNode, 'OnShowLHE', [true]);\n\t\t\t} ,this), 100);\n\t\t}\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tonFocus(e)\n\t{\n\t\tthis._input.style.display = 'none';\n\t\tif (this._editor && this._postForm)\n\t\t{\n\t\t\tthis._postForm.eventNode.style.display = 'block';\n\t\t\tthis._editor.Focus();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\t{\n\t\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\t\t\t\tthis._editorContainer.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { className: \"crm-timeline-wait\" }\n\t\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\tthis._container.appendChild(this._editorContainer);\n\t\t\t}\n\n\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\tthis.loadEditor();\n\t\t\t} ,this), 100);\n\t\t}\n\n\t\tBX.addClass(this._container, \"focus\");\n\t}\n\n\tsave()\n\t{\n\t\tlet text = \"\";\n\t\tconst attachmentList = [];\n\t\tif (this._postForm)\n\t\t{\n\t\t\ttext = this._postForm.oEditor.GetContent();\n\t\t\tthis._postForm.eventNode\n\t\t\t\t.querySelectorAll('input[name=\"UF_CRM_COMMENT_FILES[]\"]')\n\t\t\t\t.forEach(function(input) {\n\t\t\t\t\tattachmentList.push(input.value)\n\t\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttext = this._input.value;\n\t\t}\n\n\t\tif(text === \"\")\n\t\t{\n\t\t\tif (!this.emptyCommentMessage)\n\t\t\t{\n\t\t\t\tthis.emptyCommentMessage = new BX.PopupWindow(\n\t\t\t\t\t'timeline_empty_new_comment_' + this._ownerId,\n\t\t\t\t\tthis._saveButton,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_EMPTY_COMMENT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: {position: 'top', offset: 77},\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.emptyCommentMessage.show();\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isRequestRunning || this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isRequestRunning = this._isLocked = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"SAVE_COMMENT\",\n\t\t\t\t\t\t\"TEXT\": text,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._ownerTypeId,\n\t\t\t\t\t\t\"OWNER_ID\": this._ownerId,\n\t\t\t\t\t\t\"ATTACHMENTS\": attachmentList\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onSaveFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tcancel()\n\t{\n\t\tthis._input.value = \"\";\n\t\tthis._input.style.minHeight = \"\";\n\t\tif (BX.type.isDomNode(this._editorContainer))\n\t\t\tthis._postForm.eventNode.style.display = 'none';\n\n\t\tthis._input.style.display = 'block';\n\t\tBX.removeClass(this._container, \"focus\");\n\t\tthis.release();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = false;\n\t\tif (this._postForm)\n\t\t{\n\t\t\tthis._postForm.reinit('', {});\n\t\t}\n\n\t\tthis.cancel();\n\t\tconst itemData = BX.prop.getObject(data, \"HISTORY_ITEM\");\n\t\tconst historyItem = this._history.createItem(itemData);\n\t\tthis._history.addItem(historyItem, 0);\n\n\t\tconst anchor = this._history.createAnchor();\n\t\thistoryItem.layout({ anchor: anchor });\n\n\t\tconst move = BX.CrmCommentAnimation.create(\n\t\t\thistoryItem.getWrapper(),\n\t\t\tanchor,\n\t\t\tBX.pos(this._input),\n\t\t\t{\n\t\t\t\tstart: BX.delegate(this.onAnimationStart, this),\n\t\t\t\tcomplete: BX.delegate(this.onAnimationComplete, this)\n\t\t\t}\n\t\t);\n\t\tmove.run();\n\t}\n\n\tonSaveFailure()\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tonAnimationStart()\n\t{\n\t\tthis._input.value = \"\";\n\t}\n\n\tonAnimationComplete()\n\t{\n\t\tthis._isLocked = false;\n\t\tBX.removeClass(this._container, \"focus\");\n\n\t\tthis._input.style.minHeight = \"\";\n\t\tthis._manager.processEditingCompletion(this);\n\n\t\tthis.release();\n\n\t\tthis._history._anchor = null;\n\t\tthis._history.refreshLayout();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(id, settings);\n\t\tComment.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n}\n","import Item from \"../item\";\nimport History from \"./history\";\nimport {Item as ItemType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Scheduled extends Item\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._schedule = null;\n\t\tthis._deadlineNode = null;\n\t\n\t\tthis._headerClickHandler = BX.delegate(this.onHeaderClick, this);\n\t\tthis._setAsDoneButtonHandler = BX.delegate(this.onSetAsDoneButtonClick, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._schedule = this.getSetting(\"schedule\");\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Scheduled. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t\n\t\tif(this.hasPermissions() && !this.verifyPermissions())\n\t\t{\n\t\t\tthis.loadPermissions();\n\t\t}\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.undefined;\n\t}\n\n\tverifyPermissions()\n\t{\n\t\tconst userId = BX.prop.getInteger(this.getPermissions(), \"USER_ID\", 0);\n\t\treturn userId <= 0 || userId === this._schedule.getUserId();\n\t}\n\n\tloadPermissions()\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._schedule.getServiceUrl(),\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata: { \"ACTION\": \"GET_PERMISSIONS\", \"TYPE_ID\": this.getTypeId(), \"ID\": this.getAssociatedEntityId() },\n\t\t\t\tonsuccess: this.onPermissionsLoad.bind(this)\n\t\t\t}\n\t\t);\n\t}\n\n\tonPermissionsLoad(result)\n\t{\n\t\tconst permissions = BX.prop.getObject(result, \"PERMISSIONS\", null);\n\t\tif(!permissions)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\n\t\tthis.setPermissions(permissions);\n\t\twindow.setTimeout(function(){ this.refreshLayout(); }.bind(this), 0);\n\t}\n\n\tgetDeadline()\n\t{\n\t\treturn null;\n\t}\n\n\thasDeadline()\n\t{\n\t\treturn BX.type.isDate(this.getDeadline());\n\t}\n\n\tisCounterEnabled()\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\treturn deadline && History.isCounterEnabled(deadline);\n\t}\n\n\tgetSourceId()\n\t{\n\t\treturn BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t}\n\n\tonSetAsDoneCompleted(data)\n\t{\n\t\tif(!BX.prop.getBoolean(data, \"COMPLETED\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\n\t\tthis.markAsDone(true);\n\t\tthis._schedule.onItemMarkedAsDone(\n\t\t\tthis,\n\t\t\t{ 'historyItemData': BX.prop.getObject(data, \"HISTORY_ITEM\") }\n\t\t);\n\t}\n\n\tonPosponeCompleted(data)\n\t{\n\t}\n\n\trefreshDeadline()\n\t{\n\t\tthis._deadlineNode.innerHTML = this.formatDateTime(this.getDeadline());\n\t}\n\n\tformatDateTime(time)\n\t{\n\t\treturn this._schedule.formatDateTime(time);\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon\";\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._schedule.isReadOnly();\n\t}\n\n\tisEditable()\n\t{\n\t\treturn !this.isReadOnly();\n\t}\n\n\tcanPostpone()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst perms = BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t\treturn BX.prop.getBoolean(perms, \"POSTPONE\", false);\n\t}\n\n\tisDone()\n\t{\n\t\treturn BX.CrmActivityStatus.isFinal(\n\t\t\tBX.prop.getInteger(this.getAssociatedEntityData(), \"STATUS\", 0)\n\t\t);\n\t}\n\n\tcanComplete()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst perms = BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t\treturn BX.prop.getBoolean(perms, \"COMPLETE\", false);\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t}\n\n\tprepareContent(options)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t\tconst vueComponent = this.makeVueComponent(options, 'schedule');\n\t\tthis._wrapper = vueComponent ? vueComponent : this.prepareContent();\n\t\tif(this._wrapper)\n\t\t{\n\t\t\tconst enableAdd = BX.type.isPlainObject(options) ? BX.prop.getBoolean(options, \"add\", true) : true;\n\t\t\tif(enableAdd)\n\t\t\t{\n\t\t\t\tconst anchor = BX.type.isPlainObject(options) && BX.type.isElementNode(options[\"anchor\"]) ? options[\"anchor\"] : null;\n\t\t\t\tif(anchor && anchor.nextSibling)\n\t\t\t\t{\n\t\t\t\t\tthis._container.insertBefore(this._wrapper, anchor.nextSibling);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._container.appendChild(this._wrapper);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tthis.markAsTerminated(this._schedule.checkItemForTermination(this));\n\t\t}\n\t}\n\n\tonHeaderClick(e)\n\t{\n\t\tthis.view();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tonSetAsDoneButtonClick(e)\n\t{\n\t\tif(this.canComplete())\n\t\t{\n\t\t\tthis.setAsDone(!this.isDone());\n\t\t}\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t\tthis._schedule.getManager().onActivityCreated(activity, data);\n\t}\n\n\tstatic isDone(data)\n\t{\n\t\tconst entityData = BX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {});\n\t\treturn BX.CrmActivityStatus.isFinal(BX.prop.getInteger(entityData, \"STATUS\", 0));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Scheduled();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline */\nexport default class Action\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = this.getSetting(\"container\");\n\t\tif(!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"BX.CrmTimelineAction: Could not find container.\";\n\t\t}\n\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tlayout()\n\t{\n\t\tthis.doLayout();\n\t}\n\n\tdoLayout()\n\t{\n\t}\n}\n","import Action from \"../action\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Activity extends Action\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._activityEditor = null;\n\t\tthis._entityData = null;\n\t\tthis._item = null;\n\t\tthis._isEnabled = true;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._entityData = this.getSetting(\"entityData\");\n\t\tif(!BX.type.isPlainObject(this._entityData))\n\t\t{\n\t\t\tthrow \"BX.Crm.Timeline.Actions.Activity. A required parameter 'entityData' is missing.\";\n\t\t}\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"BX.Crm.Timeline.Actions.Activity. A required parameter 'activityEditor' is missing.\";\n\t\t}\n\n\t\tthis._item = this.getSetting(\"item\");\n\t\tthis._isEnabled = this.getSetting(\"enabled\", true);\n\t}\n\n\tgetActivityId()\n\t{\n\t\treturn BX.prop.getInteger(this._entityData, \"ID\", 0);\n\t}\n\n\tloadActivityCommunications(callback)\n\t{\n\t\tthis._activityEditor.getActivityCommunications(\n\t\t\tthis.getActivityId(),\n\t\t\tfunction(communications)\n\t\t\t{\n\t\t\t\tif(BX.type.isFunction(callback))\n\t\t\t\t{\n\t\t\t\t\tcallback(communications);\n\t\t\t\t}\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n\n\tgetItemData()\n\t{\n\t\treturn this._item ?  this._item.getData() : null;\n\t}\n}\n","import Activity from \".//activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class Email extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._saveHandler = BX.delegate(this.onSave, this);\n\t}\n\n\tonClick(e)\n\t{\n\t\tconst settings =\n\t\t\t{\n\t\t\t\t\"ownerType\": BX.CrmEntityType.resolveName(BX.prop.getInteger(this._entityData, \"OWNER_TYPE_ID\", 0)),\n\t\t\t\t\"ownerID\": BX.prop.getInteger(this._entityData, \"OWNER_ID\", 0),\n\t\t\t\t\"ownerUrl\": BX.prop.getString(this._entityData, \"OWNER_URL\", \"\"),\n\t\t\t\t\"ownerTitle\": BX.prop.getString(this._entityData, \"OWNER_TITLE\", \"\"),\n\t\t\t\t\"originalMessageID\": BX.prop.getInteger(this._entityData, \"ID\", 0),\n\t\t\t\t\"messageType\": \"RE\"\n\t\t\t};\n\n\t\tif (BX.CrmActivityProvider && top.BX.Bitrix24 && top.BX.Bitrix24.Slider)\n\t\t{\n\t\t\tconst activity = this._activityEditor.addEmail(settings);\n\t\t\tactivity.addOnSave(this._saveHandler);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.loadActivityCommunications(\n\t\t\t\tBX.delegate(\n\t\t\t\t\tfunction(communications)\n\t\t\t\t\t{\n\t\t\t\t\t\tsettings['communications'] = BX.type.isArray(communications) ? communications : [];\n\t\t\t\t\t\tsettings['communicationsLoaded'] = true;\n\n\t\t\t\t\t\tBX.CrmActivityEmail.prepareReply(settings);\n\n\t\t\t\t\t\tconst activity = this._activityEditor.addEmail(settings);\n\t\t\t\t\t\tactivity.addOnSave(this._saveHandler);\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tonSave(activity, data)\n\t{\n\t\tif(BX.type.isFunction(this._item.onActivityCreate))\n\t\t{\n\t\t\tthis._item.onActivityCreate(activity, data);\n\t\t}\n\t}\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class HistoryEmail extends Email\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryEmail();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class ScheduleEmail extends Email\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ScheduleEmail();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\nimport {Mark} from \"../types\";\nimport {HistoryEmail} from \"../actions/email\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class HistoryActivity extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"HistoryActivity. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn BX.prop.getString(this.getAssociatedEntityData(), \"SUBJECT\", \"\");\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\treturn this.getMessage(\"meeting\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\treturn this.getMessage(\"task\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.provider)\n\t\t{\n\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\n\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"webform\");\n\t\t\t}\n\t\t\telse if (providerId === \"CRM_SMS\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"sms\");\n\t\t\t}\n\t\t\telse if (providerId === \"CRM_REQUEST\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"activityRequest\");\n\t\t\t}\n\t\t\telse if (providerId === \"IMOPENLINES_SESSION\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"openLine\");\n\t\t\t}\n\t\t\telse if (providerId === \"REST_APP\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"restApplication\");\n\t\t\t}\n\t\t\telse if (providerId === \"VISIT_TRACKER\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"visit\");\n\t\t\t}\n\t\t\telse if (providerId === \"ZOOM\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"zoom\");\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs: { href: \"#\",  className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\ttext: this.getTypeDescription()\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareMarkLayout()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst markTypeId = BX.prop.getInteger(entityData, \"MARK_TYPE_ID\", 0);\n\t\tif(markTypeId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet messageName = \"\";\n\t\tif(markTypeId === Mark.success)\n\t\t{\n\t\t\tmessageName = \"SuccessMark\";\n\t\t}\n\t\telse if(markTypeId === Mark.renew)\n\t\t{\n\t\t\tmessageName = \"RenewMark\";\n\t\t}\n\n\t\tif(messageName === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet markText = \"\";\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"email\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"call\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"meeting\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"task\" + messageName);\n\t\t}\n\n\t\tif(markText === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn(\n\t\t\tBX.create(\n\t\t\t\t\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-content-event-skipped\" },\n\t\t\t\t\ttext: markText\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\tthis._actions.push(\n\t\t\t\tHistoryEmail.create(\n\t\t\t\t\t\"email\",\n\t\t\t\t\t{\n\t\t\t\t\t\titem: this,\n\t\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isEditable())\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.edit, this)});\n\t\t\t}\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\t\treturn menuItems;\n\t}\n\n\tview()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.viewActivity(id);\n\t\t}\n\t}\n\n\tedit()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.editActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getRemoveMessage()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\treturn this.getMessage('removeConfirm');\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tconst activityEditor = this._activityEditor;\n\t\t\t\tconst item = activityEditor.getItemById(id);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tactivityEditor.deleteActivity(id, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst serviceUrl = BX.util.add_url_param(activityEditor.getSetting('serviceUrl', ''),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\taction: 'get_activity',\n\t\t\t\t\t\t\townertype: activityEditor.getSetting('ownerType', ''),\n\t\t\t\t\t\t\townerid: activityEditor.getSetting('ownerID', '')\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tBX.ajax({\n\t\t\t\t\t\t'url': serviceUrl,\n\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t'dataType': 'json',\n\t\t\t\t\t\t'data':\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'ACTION' : 'GET_ACTIVITY',\n\t\t\t\t\t\t\t\t'ID': id,\n\t\t\t\t\t\t\t\t'OWNER_TYPE': activityEditor.getSetting('ownerType', ''),\n\t\t\t\t\t\t\t\t'OWNER_ID': activityEditor.getSetting('ownerID', '')\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\tonsuccess: BX.delegate(\n\t\t\t\t\t\t\tfunction(data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(typeof(data['ACTIVITY']) !== 'undefined')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tactivityEditor._handleActivityChange(data['ACTIVITY']);\n\t\t\t\t\t\t\t\t\twindow.setTimeout(BX.delegate(this.remove ,this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonfailure: function(data){}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryActivity();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Document extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif(typeCategoryId === 3)\n\t\t{\n\t\t\treturn BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_VIEWED');\n\t\t}\n\n\t\treturn this.getMessage(\"document\");\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\tevents: { \"click\": BX.delegate(this.editDocument, this) },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tprepareTitleStatusLayout()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif(typeCategoryId === 3)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-done\" },\n\t\t\t\t\ttext: BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_VIEWED_STATUS')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif(typeCategoryId === 2)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-sent\" },\n\t\t\t\t\ttext: BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_CREATED_STATUS')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\n\t\treturn typeCategoryId !== 3;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tconst statusLayout = this.prepareTitleStatusLayout();\n\t\tif(statusLayout)\n\t\t{\n\t\t\theader.appendChild(statusLayout);\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst text = this.getTextDataParam(\"COMMENT\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-document\"}\n\t\t\t}\n\t\t);\n\n\t\tif(this.isFixed())\n\t\t{\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\t\t}\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-document\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif(!this.isReadOnly())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\t\t}\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: text\n\t\t\t}\n\t\t);\n\t\tconst title = BX.findChildByClassName(detailWrapper, 'document-title-link');\n\t\tif(title)\n\t\t{\n\t\t\tBX.bind(title, 'click', BX.proxy(this.editDocument, this));\n\t\t}\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif(!this.isReadOnly())\n\t\t{\n\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.editDocument, this)});\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.confirmDelete, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t\t}\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tconfirmDelete()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getMessage('documentRemove')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onConfirmDelete, this), BX.DoNothing);\n\t}\n\n\tonConfirmDelete(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteDocument();\n\t}\n\n\tdeleteDocument()\n\t{\n\t\tif(this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"DELETE_DOCUMENT\",\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this.getId()\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(function(result)\n\t\t\t\t{\n\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t\tif(BX.type.isNotEmptyString(result.ERROR))\n\t\t\t\t\t{\n\t\t\t\t\t\talert(result.ERROR);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst deleteItem = this._history.findItemById(this._id);\n\t\t\t\t\t\tif (deleteItem instanceof Document)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdeleteItem.clearAnimate();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst deleteFixedItem = this._fixedHistory.findItemById(this._id);\n\t\t\t\t\t\tif (deleteFixedItem instanceof Document)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdeleteFixedItem.clearAnimate();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, this),\n\t\t\t\tonfailure: BX.delegate(function()\n\t\t\t\t{\n\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t}, this)\n\t\t\t}\n\t\t);\n\t}\n\n\teditDocument()\n\t{\n\t\tconst documentId = this.getData().DOCUMENT_ID || 0;\n\t\tif(documentId > 0)\n\t\t{\n\t\t\tlet url = '/bitrix/components/bitrix/crm.document.view/slider.php';\n\t\t\turl = BX.util.add_url_param(url, {documentId: documentId});\n\t\t\tif(BX.SidePanel)\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.open(url, {width: 980});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttop.location.href = url;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateWrapper()\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif(wrapper)\n\t\t{\n\t\t\tconst detailWrapper = BX.findChildByClassName(wrapper, 'crm-entity-stream-content-detail');\n\t\t\tif(detailWrapper)\n\t\t\t{\n\t\t\t\tBX.adjust(detailWrapper, {html: this.getTextDataParam(\"COMMENT\", \"\")});\n\t\t\t\tconst title = BX.findChildByClassName(detailWrapper, 'document-title-link');\n\t\t\t\tif(title)\n\t\t\t\t{\n\t\t\t\t\tBX.bind(title, 'click', BX.proxy(this.editDocument, this));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Document();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Manager from \"./manager\";\n\n/** @memberof BX.Crm.Timeline */\nexport default class Steam\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t\tthis._manager = null;\n\t\tthis._activityEditor = null;\n\n\t\tthis._userTimezoneOffset = null;\n\t\tthis._serverTimezoneOffset = null;\n\t\tthis._timeFormat = \"\";\n\t\tthis._year = 0;\n\n\t\tthis._isStubMode = false;\n\t\tthis._userId = 0;\n\t\tthis._readOnly = false;\n\n\t\tthis._serviceUrl = \"\";\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = BX(this.getSetting(\"container\"));\n\t\tif (!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Timeline. Container node is not found.\";\n\t\t}\n\t\tthis._editorContainer = BX(this.getSetting(\"editorContainer\"));\n\t\tthis._manager = this.getSetting(\"manager\");\n\t\tif (!(this._manager instanceof Manager))\n\t\t{\n\t\t\tthrow \"Timeline. Manager instance is not found.\";\n\t\t}\n\n\t\t//\n\t\tconst datetimeFormat = BX.message(\"FORMAT_DATETIME\").replace(/:SS/, \"\");\n\t\tconst dateFormat = BX.message(\"FORMAT_DATE\");\n\t\tthis._timeFormat = BX.date.convertBitrixFormat(BX.util.trim(datetimeFormat.replace(dateFormat, \"\")));\n\t\t//\n\t\tthis._year = (new Date()).getFullYear();\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\n\t\tthis._isStubMode = BX.prop.getBoolean(this._settings, \"isStubMode\", false);\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\t\tthis._userId = BX.prop.getInteger(this._settings, \"userId\", 0);\n\t\tthis._serviceUrl = BX.prop.getString(this._settings, \"serviceUrl\", \"\");\n\n\t\tthis.doInitialize();\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tlayout()\n\t{\n\t}\n\n\tisStubMode()\n\t{\n\t\treturn this._isStubMode;\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._readOnly;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this._userId;\n\t}\n\n\tgetServiceUrl()\n\t{\n\t\treturn this._serviceUrl;\n\t}\n\n\trefreshLayout()\n\t{\n\t}\n\n\tgetManager()\n\t{\n\t\treturn this._manager;\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._manager.getOwnerInfo();\n\t}\n\n\treload()\n\t{\n\t\tconst currentUrl = this.getSetting(\"currentUrl\");\n\t\tconst ajaxId = this.getSetting(\"ajaxId\");\n\t\tif (ajaxId !== \"\")\n\t\t{\n\t\t\tBX.ajax.insertToNode(BX.util.add_url_param(currentUrl, {bxajaxid: ajaxId}), \"comp_\" + ajaxId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twindow.location = currentUrl;\n\t\t}\n\t}\n\n\tgetUserTimezoneOffset()\n\t{\n\t\tif (!this._userTimezoneOffset)\n\t\t{\n\t\t\tthis._userTimezoneOffset = parseInt(BX.message(\"USER_TZ_OFFSET\"));\n\t\t\tif (isNaN(this._userTimezoneOffset))\n\t\t\t{\n\t\t\t\tthis._userTimezoneOffset = 0;\n\t\t\t}\n\t\t}\n\t\treturn this._userTimezoneOffset;\n\t}\n\n\tgetServerTimezoneOffset()\n\t{\n\t\tif (!this._serverTimezoneOffset)\n\t\t{\n\t\t\tthis._serverTimezoneOffset = parseInt(BX.message(\"SERVER_TZ_OFFSET\"));\n\t\t\tif (isNaN(this._serverTimezoneOffset))\n\t\t\t{\n\t\t\t\tthis._serverTimezoneOffset = 0;\n\t\t\t}\n\t\t}\n\t\treturn this._serverTimezoneOffset;\n\t}\n\n\tformatTime(time, now, utc)\n\t{\n\t\treturn BX.date.format(this._timeFormat, time, now, utc);\n\t}\n\n\tformatDate(date)\n\t{\n\t\treturn (\n\t\t\tBX.date.format(\n\t\t\t\t[\n\t\t\t\t\t[\"today\", \"today\"],\n\t\t\t\t\t[\"tommorow\", \"tommorow\"],\n\t\t\t\t\t[\"yesterday\", \"yesterday\"],\n\t\t\t\t\t[\"\", (date.getFullYear() === this._year) ? \"j F\" : \"j F Y\"]\n\t\t\t\t],\n\t\t\t\tdate\n\t\t\t)\n\t\t);\n\t}\n\n\tcutOffText(text, length)\n\t{\n\t\tif (!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif (length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whitespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif (whitespaceOffset > 0)\n\t\t{\n\t\t\toffset += whitespaceOffset;\n\t\t}\n\t\treturn text.substring(0, offset) + \"...\";\n\t}\n}\n","import Stream from \"../stream\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class EntityChat extends Stream\n{\n\tstatic LayoutType = {\n\t\tnone: 0,\n\t\tinvitation:  1,\n\t\tsummary: 2,\n\t}\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._data = null;\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\n\t\tthis._wrapper = null;\n\t\tthis._contentWrapper = null;\n\t\tthis._messageWrapper = null;\n\t\tthis._messageDateNode = null;\n\t\tthis._messageTexWrapper = null;\n\t\tthis._messageTextNode = null;\n\t\tthis._userWrapper = null;\n\t\tthis._extraUserCounter = null;\n\n\t\tthis._openChatHandler = BX.delegate(this.onOpenChat, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._data = BX.prop.getObject(this._settings, \"data\", {});\n\t}\n\n\tgetData()\n\t{\n\t\treturn this._data;\n\t}\n\n\tsetData(data)\n\t{\n\t\tthis._data = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\tisEnabled()\n\t{\n\t\treturn BX.prop.getBoolean(this._data, \"ENABLED\", true);\n\t}\n\n\t/**\n\t * @private\n\t * @return {boolean}\n\t */\n\tisRestricted()\n\t{\n\t\treturn BX.prop.getBoolean(this._data, \"IS_RESTRICTED\", false);\n\t}\n\n\t/**\n\t * @private\n\t * @return {void}\n\t */\n\tapplyLockScript()\n\t{\n\t\tconst lockScript = BX.prop.getString(this._data, \"LOCK_SCRIPT\", null);\n\t\tif (BX.Type.isString(lockScript) && lockScript !== '')\n\t\t{\n\t\t\teval(lockScript);\n\t\t}\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn BX.prop.getInteger(this._data, \"CHAT_ID\", 0);\n\t}\n\n\tgetUserId()\n\t{\n\t\tconst userId = parseInt(top.BX.message(\"USER_ID\"));\n\t\treturn !isNaN(userId) ? userId : 0;\n\t}\n\n\tgetMessageData()\n\t{\n\t\treturn BX.prop.getObject(this._data, \"MESSAGE\", {});\n\t}\n\n\tsetMessageData(data)\n\t{\n\t\tthis._data[\"MESSAGE\"] = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\tgetUserInfoData()\n\t{\n\t\treturn BX.prop.getObject(this._data, \"USER_INFOS\", {});\n\t}\n\n\tsetUserInfoData(data)\n\t{\n\t\tthis._data[\"USER_INFOS\"] = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\thasUserInfo(userId)\n\t{\n\t\treturn userId > 0 && BX.type.isPlainObject(this.getUserInfoData()[userId]);\n\t}\n\n\tgetUserInfo(userId)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\treturn userId > 0 && BX.type.isPlainObject(userInfos[userId]) ? userInfos[userId] : null;\n\t}\n\n\tremoveUserInfo(userId)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\tif(userId > 0 && BX.type.isPlainObject(userInfos[userId]))\n\t\t{\n\t\t\tdelete userInfos[userId];\n\t\t}\n\t}\n\n\tsetUnreadMessageCounter(userId, counter)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\tif(userId > 0 && BX.type.isPlainObject(userInfos[userId]))\n\t\t{\n\t\t\tuserInfos[userId][\"counter\"] = counter;\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tif(!this.isEnabled() || this.isStubMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._wrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-section crm-entity-stream-section-live-im\" } });\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"div\", { props: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-live-im\" } })\n\t\t);\n\n\t\tthis._contentWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-content-live-im-detail\" } });\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"div\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-event\" },\n\t\t\t\t\t\t\t\t\tchildren: [ this._contentWrapper ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._userWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-avatars\" } });\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-users\" },\n\t\t\t\t\tchildren: [ this._userWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._extraUserCounter = BX.create(\"div\",{ props: { className: \"crm-entity-stream-live-im-user-counter\" } });\n\t\tthis._contentWrapper.appendChild(this._extraUserCounter);\n\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\t\tif(this.getChatId() > 0)\n\t\t{\n\t\t\tthis.renderSummary();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.renderInvitation();\n\t\t}\n\n\t\tBX.bind(this._contentWrapper, \"click\", this._openChatHandler);\n\t\tBX.addCustomEvent(\"onPullEvent-im\", this.onChatEvent.bind(this));\n\t}\n\n\trefreshLayout()\n\t{\n\t\tBX.cleanNode(this._contentWrapper);\n\t\tthis._userWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-avatars\" } });\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-users\" },\n\t\t\t\t\tchildren: [ this._userWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._extraUserCounter = BX.create(\"div\",{ props: { className: \"crm-entity-stream-live-im-user-counter\" } });\n\t\tthis._contentWrapper.appendChild(this._extraUserCounter);\n\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\t\tif(this.getChatId() > 0)\n\t\t{\n\t\t\tthis.renderSummary();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.renderInvitation();\n\t\t}\n\t}\n\n\trenderInvitation()\n\t{\n\t\tthis._layoutType = EntityChat.LayoutType.invitation;\n\t\tthis.refreshUsers();\n\n\t\tthis._messageTextNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-invite-text\" } });\n\t\tthis._contentWrapper.appendChild(this._messageTextNode);\n\n\t\tthis._messageTextNode.innerHTML = this.getMessage(\"invite\");\n\t}\n\n\trenderSummary()\n\t{\n\t\tthis._layoutType = EntityChat.LayoutType.summary;\n\t\tthis.refreshUsers();\n\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-separator\" } })\n\t\t);\n\n\t\tthis._messageWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-messanger\" } });\n\t\tthis._contentWrapper.appendChild(this._messageWrapper);\n\n\t\tthis._messageDateNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-time\" } });\n\t\tthis._messageWrapper.appendChild(this._messageDateNode);\n\n\t\tthis._messageTexWraper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message\" } });\n\t\tthis._messageWrapper.appendChild(this._messageTexWraper);\n\n\t\tthis._messageTextNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message-text\" } });\n\t\tthis._messageTexWraper.appendChild(this._messageTextNode);\n\n\t\tthis._messageCounterNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message-counter\" } });\n\t\tthis._messageWrapper.appendChild(this._messageCounterNode);\n\n\t\tthis.refreshSummary();\n\t}\n\n\trefreshUsers()\n\t{\n\t\tBX.cleanNode(this._userWrapper);\n\n\t\tconst infos = this.getUserInfoData();\n\t\tconst list = Object.values(infos);\n\n\t\tif(list.length === 0)\n\t\t{\n\t\t\tthis._userWrapper.appendChild(\n\t\t\t\tBX.create(\"span\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-user-avatar ui-icon ui-icon-common-user\" },\n\t\t\t\t\t\tchildren: [ BX.create(\"i\") ]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst count = list.length >= 3 ? 3 : list.length;\n\t\t\tfor(let i = 0; i < count; i++)\n\t\t\t{\n\t\t\t\tconst info = list[i];\n\n\t\t\t\tconst icon = BX.create(\"i\");\n\t\t\t\tconst imageUrl = BX.prop.getString(info, \"avatar\", \"\");\n\t\t\t\tif(imageUrl !== \"\")\n\t\t\t\t{\n\t\t\t\t\ticon.style.backgroundImage = \"url(\" +  imageUrl + \")\";\n\t\t\t\t}\n\n\t\t\t\tthis._userWrapper.appendChild(\n\t\t\t\t\tBX.create(\"span\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-user-avatar ui-icon ui-icon-common-user\" },\n\t\t\t\t\t\t\tchildren: [ icon ]\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif(this._layoutType === EntityChat.LayoutType.summary)\n\t\t{\n\t\t\tif(list.length > 3)\n\t\t\t{\n\t\t\t\tthis._extraUserCounter.display = \"\";\n\t\t\t\tthis._extraUserCounter.innerHTML = \"+\" + (list.length - 3).toString();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(this._extraUserCounter.innerHTML !== \"\")\n\t\t\t\t{\n\t\t\t\t\tthis._extraUserCounter.innerHTML = \"\";\n\t\t\t\t}\n\t\t\t\tthis._extraUserCounter.display = \"none\";\n\t\t\t}\n\t\t}\n\t\telse //if(this._layoutType === EntityChat.LayoutType.invitation)\n\t\t{\n\t\t\tif(this._extraUserCounter.innerHTML !== \"\")\n\t\t\t{\n\t\t\t\tthis._extraUserCounter.innerHTML = \"\";\n\t\t\t}\n\t\t\tthis._extraUserCounter.display = \"none\";\n\n\t\t\tthis._userWrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { props: { className: \"crm-entity-stream-live-im-user-invite-btn\" } })\n\t\t\t);\n\t\t}\n\t}\n\n\trefreshSummary()\n\t{\n\t\tif(this._layoutType !== EntityChat.LayoutType.summary)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst message = this.getMessageData();\n\n\t\t//region Message Date\n\t\tconst isoDate = BX.prop.getString(message, \"date\", \"\");\n\t\tif(isoDate === \"\")\n\t\t{\n\t\t\tthis._messageDateNode.innerHTML = \"\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst remoteDate = (new Date(isoDate)).getTime() / 1000 + this.getServerTimezoneOffset() + this.getUserTimezoneOffset();\n\t\t\tconst localTime = (new Date).getTime() / 1000 + this.getServerTimezoneOffset() + this.getUserTimezoneOffset();\n\t\t\tthis._messageDateNode.innerHTML = this.formatTime(remoteDate, localTime, true);\n\t\t}\n\t\t//endregion\n\n\t\t//region Message Text\n\t\tlet text = BX.prop.getString(message, \"text\", \"\");\n\t\tconst params = BX.prop.getObject(message, \"params\", {});\n\t\tif(text === \"\")\n\t\t{\n\t\t\tthis._messageTextNode.innerHTML = \"\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(typeof(top.BX.MessengerCommon) !== \"undefined\")\n\t\t\t{\n\t\t\t\ttext = top.BX.MessengerCommon.purifyText(text, params);\n\t\t\t}\n\t\t\tthis._messageTextNode.innerHTML = text;\n\t\t}\n\t\t//endregion\n\n\t\t//region Unread Message Counter\n\t\tlet counter = 0;\n\t\tconst userId = this.getUserId();\n\t\tif(userId > 0)\n\t\t{\n\t\t\tcounter = BX.prop.getInteger(\n\t\t\t\tBX.prop.getObject(\n\t\t\t\t\tBX.prop.getObject(this._data, \"USER_INFOS\", {}),\n\t\t\t\t\tuserId,\n\t\t\t\t\tnull\n\t\t\t\t),\n\t\t\t\t\"counter\",\n\t\t\t\t0\n\t\t\t);\n\t\t}\n\n\t\tthis._messageCounterNode.innerHTML = counter.toString();\n\t\tthis._messageCounterNode.style.display = counter > 0 ? \"\" : \"none\";\n\t\t//endregion\n\t}\n\n\trefreshUsersAnimated()\n\t{\n\t\tBX.removeClass(this._userWrapper, 'crm-entity-stream-live-im-message-show');\n\t\tBX.addClass(this._userWrapper, 'crm-entity-stream-live-im-message-hide');\n\n\t\twindow.setTimeout(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tthis.refreshUsers();\n\t\t\t\twindow.setTimeout(\n\t\t\t\t\tfunction()\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._userWrapper, 'crm-entity-stream-live-im-message-hide');\n\t\t\t\t\t\tBX.addClass(this._userWrapper, 'crm-entity-stream-live-im-message-show');\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\t50\n\t\t\t\t);\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\trefreshSummaryAnimated()\n\t{\n\t\tBX.removeClass(this._messageWrapper, 'crm-entity-stream-live-im-message-show');\n\t\tBX.addClass(this._messageWrapper, 'crm-entity-stream-live-im-message-hide');\n\n\t\twindow.setTimeout(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tthis.refreshSummary();\n\t\t\t\twindow.setTimeout(\n\t\t\t\t\tfunction()\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._messageWrapper, 'crm-entity-stream-live-im-message-hide');\n\t\t\t\t\t\tBX.addClass(this._messageWrapper, 'crm-entity-stream-live-im-message-show');\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\t50\n\t\t\t\t);\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\tonOpenChat(e)\n\t{\n\t\tif(typeof(top.BXIM) === \"undefined\")\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isRestricted())\n\t\t{\n\t\t\tthis.applyLockScript();\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\n\t\tconst chatId = this.getChatId();\n\t\tif(chatId > 0 && this.hasUserInfo(this.getUserId()))\n\t\t{\n\t\t\tslug = \"chat\" + chatId.toString();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst ownerInfo = this.getOwnerInfo();\n\t\t\tconst entityId = BX.prop.getInteger(ownerInfo, \"ENTITY_ID\", 0);\n\t\t\tconst entityTypeName = BX.prop.getString(ownerInfo, \"ENTITY_TYPE_NAME\", \"\");\n\n\t\t\tif(entityTypeName !== \"\" && entityId > 0)\n\t\t\t{\n\t\t\t\tslug = \"crm|\" + entityTypeName + \"|\" + entityId.toString();\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\ttop.BXIM.openMessengerSlider(slug, { RECENT: \"N\", MENU: \"N\" });\n\t\t}\n\t}\n\n\tonChatEvent(command, params, extras)\n\t{\n\t\tconst chatId = this.getChatId();\n\t\tif(chatId <= 0 || chatId !== BX.prop.getInteger(params, \"chatId\", 0))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(command === \"chatUserAdd\")\n\t\t{\n\t\t\tthis.setUserInfoData(BX.mergeEx(this.getUserInfoData(), BX.prop.getObject(params, \"users\", {})));\n\t\t\tthis.refreshUsersAnimated();\n\t\t}\n\t\telse if(command === \"chatUserLeave\")\n\t\t{\n\t\t\tthis.removeUserInfo(BX.prop.getInteger(params, \"userId\", 0));\n\t\t\tthis.refreshUsersAnimated();\n\t\t}\n\t\telse if(command === \"messageChat\")\n\t\t{\n\t\t\t//Message was added.\n\t\t\tthis.setMessageData(BX.prop.getObject(params, \"message\", {}));\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), BX.prop.getInteger(params, \"counter\", 0));\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t\telse if(command === \"messageUpdate\" || command === \"messageDelete\")\n\t\t{\n\t\t\t//Message was modified or removed.\n\t\t\tif(command === \"messageDelete\")\n\t\t\t{\n\t\t\t\t//HACK: date is not in ISO format\n\t\t\t\tdelete params[\"date\"];\n\t\t\t}\n\n\t\t\tconst message = this.getMessageData();\n\t\t\tif(BX.prop.getInteger(message, \"id\", 0) === BX.prop.getInteger(params, \"id\", 0))\n\t\t\t{\n\t\t\t\tthis.setMessageData(BX.mergeEx(message, params));\n\t\t\t\tthis.refreshSummaryAnimated();\n\t\t\t}\n\t\t}\n\t\telse if(command === \"readMessageChat\")\n\t\t{\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), 0);\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t\telse if(command === \"unreadMessageChat\")\n\t\t{\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), BX.prop.getInteger(params, \"counter\", 0));\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\treturn BX.prop.getString(EntityChat.messages, name, name);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new EntityChat();\n\t\tself.initialize(id, settings);\n\t\tEntityChat.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n\tstatic messages = {};\n}\n","import Manager from \"../manager\";\n\n/** @memberof BX.Crm.Timeline.Tools */\nexport default class MenuBar\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._ownerInfo = null;\n\t\tthis._container = null;\n\t\tthis._activityEditor = null;\n\t\tthis._commentEditor = null;\n\t\tthis._waitEditor = null;\n\t\tthis._smsEditor = null;\n\t\tthis._zoomEditor = null;\n\t\tthis._readOnly = false;\n\n\t\tthis._menu = null;\n\t\tthis._manager = null;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new MenuBar();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._ownerInfo = BX.prop.getObject(this._settings, \"ownerInfo\");\n\t\tif (!this._ownerInfo)\n\t\t{\n\t\t\tthrow \"MenuBar. A required parameter 'ownerInfo' is missing.\";\n\t\t}\n\n\t\tthis._activityEditor = BX.prop.get(this._settings, \"activityEditor\", null);\n\n\t\tthis._commentEditor = BX.prop.get(this._settings, \"commentEditor\");\n\t\tthis._waitEditor = BX.prop.get(this._settings, \"waitEditor\");\n\t\tthis._smsEditor = BX.prop.get(this._settings, \"smsEditor\");\n\t\tthis._zoomEditor = BX.prop.get(this._settings, \"zoomEditor\");\n\t\tthis._restEditor = BX.prop.get(this._settings, \"restEditor\");\n\t\tthis._manager = BX.prop.get(this._settings, \"manager\");\n\n\t\tif (!(this._manager instanceof Manager))\n\t\t{\n\t\t\tthrow \"BX.CrmTimeline. Manager instance is not found.\";\n\t\t}\n\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\t\tthis._menu = BX.Main.interfaceButtonsManager.getById(\n\t\t\tBX.prop.getString(this._settings, \"menuId\", (this._ownerInfo['ENTITY_TYPE_NAME'] + \"_menu\").toLowerCase())\n\t\t);\n\n\t\tBX.addCustomEvent(this._manager.getId() + \"_menu\", function (id) {\n\t\t\tthis.setActiveItemById(id);\n\t\t}.bind(this));\n\t\tthis._activeItem = this._menu.getActive();\n\t}\n\n\treset()\n\t{\n\t\tlet firstId = null;\n\t\tthis._menu.getAllItems().forEach(function (item) {\n\t\t\tif (firstId === null)\n\t\t\t{\n\t\t\t\tconst id = item.dataset.id;\n\t\t\t\tif ([\"comment\", \"wait\", \"sms\", \"zoom\"].indexOf(id) >= 0 && this[(\"_\" + id + \"Editor\")])\n\t\t\t\t{\n\t\t\t\t\tfirstId = id;\n\t\t\t\t}\n\t\t\t}\n\t\t}.bind(this));\n\t\tthis.setActiveItemById(firstId || \"comment\");\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tsetActiveItemById(id)\n\t{\n\t\tif (this.processItemSelection(id) === true)\n\t\t{\n\t\t\tconst currentDiv = this._menu.getItemById(id);\n\t\t\tif (currentDiv && this._activeItem !== currentDiv)\n\t\t\t{\n\t\t\t\tconst wasActiveInMoreMenu = this._menu.isActiveInMoreMenu();\n\t\t\t\tBX.addClass(currentDiv, this._menu.classes.itemActive);\n\n\t\t\t\tif (this._menu.getItemData)\n\t\t\t\t{\n\t\t\t\t\tconst currentDivData = this._menu.getItemData(currentDiv);\n\t\t\t\t\tcurrentDivData['IS_ACTIVE'] = true;\n\t\t\t\t\tif (BX.type.isDomNode(this._activeItem))\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._activeItem, this._menu.classes.itemActive);\n\t\t\t\t\t\tconst activeItemData = this._menu.getItemData(this._activeItem);\n\t\t\t\t\t\tactiveItemData['IS_ACTIVE'] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// Old approach\n\t\t\t\t\tlet isActiveData = {};\n\t\t\t\t\ttry\n\t\t\t\t\t{\n\t\t\t\t\t\tisActiveData = JSON.parse(currentDiv.dataset.item);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (err)\n\t\t\t\t\t{\n\t\t\t\t\t\tisActiveData = {};\n\t\t\t\t\t}\n\t\t\t\t\tisActiveData.IS_ACTIVE = true;\n\t\t\t\t\tcurrentDiv.dataset.item = JSON.stringify(isActiveData);\n\t\t\t\t\tlet wasActiveData = {};\n\t\t\t\t\tif (BX.type.isDomNode(this._activeItem))\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._activeItem, this._menu.classes.itemActive);\n\t\t\t\t\t\ttry\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twasActiveData = JSON.parse(this._activeItem.dataset.item);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch (err)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twasActiveData = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\twasActiveData.IS_ACTIVE = false;\n\t\t\t\t\t\tthis._activeItem.dataset.item = JSON.stringify(wasActiveData);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst isActiveInMoreMenu = this._menu.isActiveInMoreMenu();\n\t\t\t\tif (isActiveInMoreMenu || wasActiveInMoreMenu)\n\t\t\t\t{\n\t\t\t\t\tconst submenu = this._menu[\"getSubmenu\"] ? this._menu.getSubmenu() :\n\t\t\t\t\t\tBX.PopupMenu.getMenuById(\"main_buttons_popup_\" +\n\t\t\t\t\t\t\tString(this._ownerInfo['ENTITY_TYPE_NAME']).toLowerCase() + \"_menu\");\n\t\t\t\t\tif (submenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tsubmenu.getMenuItems().forEach(function (menuItem) {\n\t\t\t\t\t\t\tconst container = menuItem.getContainer();\n\t\t\t\t\t\t\tif (isActiveInMoreMenu && container.title === currentDiv.title)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.addClass(container, this._menu.classes.itemActive);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (wasActiveInMoreMenu && container.title === this._activeItem.title)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.removeClass(container, this._menu.classes.itemActive);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}.bind(this));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isActiveInMoreMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.addClass(this._menu.getMoreButton(), this._menu.classes.itemActive);\n\t\t\t\t\t}\n\t\t\t\t\telse if (wasActiveInMoreMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._menu.getMoreButton(), this._menu.classes.itemActive);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._activeItem = currentDiv;\n\t\t\t}\n\t\t}\n\t\tthis._menu.closeSubmenu();\n\t}\n\n\tprocessItemSelection(menuId)\n\t{\n\t\tif (this._readOnly)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet planner = null;\n\t\tconst action = menuId;\n\t\tif (action === \"call\")\n\t\t{\n\t\t\tplanner = new BX.Crm.Activity.Planner();\n\t\t\tplanner.showEdit(\n\t\t\t\t{\n\t\t\t\t\t\"TYPE_ID\": BX.CrmActivityType.call,\n\t\t\t\t\t\"OWNER_TYPE_ID\": this._ownerInfo['ENTITY_TYPE_ID'],\n\t\t\t\t\t\"OWNER_ID\": this._ownerInfo['ENTITY_ID']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif (action === \"meeting\")\n\t\t{\n\t\t\tplanner = new BX.Crm.Activity.Planner();\n\t\t\tplanner.showEdit(\n\t\t\t\t{\n\t\t\t\t\t\"TYPE_ID\": BX.CrmActivityType.meeting,\n\t\t\t\t\t\"OWNER_TYPE_ID\": this._ownerInfo['ENTITY_TYPE_ID'],\n\t\t\t\t\t\"OWNER_ID\": this._ownerInfo['ENTITY_ID']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (action === \"email\")\n\t\t{\n\t\t\tthis._activityEditor.addEmail(\n\t\t\t\t{\n\t\t\t\t\t\"ownerType\": this._ownerInfo['ENTITY_TYPE_NAME'],\n\t\t\t\t\t\"ownerID\": this._ownerInfo['ENTITY_ID'],\n\t\t\t\t\t\"ownerUrl\": this._ownerInfo['SHOW_URL'],\n\t\t\t\t\t\"ownerTitle\": this._ownerInfo['TITLE'],\n\t\t\t\t\t\"subject\": \"\"\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (action === \"delivery\")\n\t\t{\n\t\t\tthis._activityEditor.addDelivery(\n\t\t\t\t{\n\t\t\t\t\t\"ownerType\": this._ownerInfo['ENTITY_TYPE_NAME'],\n\t\t\t\t\t\"ownerID\": this._ownerInfo['ENTITY_ID'],\n\t\t\t\t\t\"orderList\": this._ownerInfo['ORDER_LIST']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (action === \"task\")\n\t\t{\n\t\t\tthis._activityEditor.addTask(\n\t\t\t\t{\n\t\t\t\t\t\"ownerType\": this._ownerInfo['ENTITY_TYPE_NAME'],\n\t\t\t\t\t\"ownerID\": this._ownerInfo['ENTITY_ID']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if ([\"comment\", \"wait\", \"sms\", \"zoom\"].indexOf(action) >= 0 && this[(\"_\" + action + \"Editor\")])\n\t\t{\n\t\t\tif (this._commentEditor)\n\t\t\t{\n\t\t\t\tthis._commentEditor.setVisible(action === \"comment\");\n\t\t\t}\n\t\t\tif (this._waitEditor)\n\t\t\t{\n\t\t\t\tthis._waitEditor.setVisible(action === \"wait\");\n\t\t\t}\n\t\t\tif (this._smsEditor)\n\t\t\t{\n\t\t\t\tthis._smsEditor.setVisible(action === \"sms\");\n\t\t\t}\n\t\t\tif (this._zoomEditor)\n\t\t\t{\n\t\t\t\tthis._zoomEditor.setVisible(action === \"zoom\");\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\telse if (action === \"visit\")\n\t\t{\n\t\t\tconst visitParameters = this._manager.getSetting(\"visitParameters\");\n\t\t\tvisitParameters['OWNER_TYPE'] = this._ownerInfo['ENTITY_TYPE_NAME'];\n\t\t\tvisitParameters['OWNER_ID'] = this._ownerInfo['ENTITY_ID'];\n\t\t\tBX.CrmActivityVisit.create(visitParameters).showEdit();\n\t\t}\n\t\telse if (action.match(/^activity_rest_/))\n\t\t{\n\t\t\tif (this._restEditor)\n\t\t\t{\n\t\t\t\tthis._restEditor.action(action);\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Tools */\nexport default class AudioPlaybackRateSelector\n{\n\tconstructor(params)\n\t{\n\t\tthis.name = params.name || 'crm-timeline-audio-playback-rate-selector';\n\t\tthis.menuId = this.name + '-menu';\n\t\tif(BX.Type.isArray(params.availableRates))\n\t\t{\n\t\t\tthis.availableRates = params.availableRates;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.availableRates = [1, 1.5, 2, 3];\n\t\t}\n\t\tthis.currentRate = this.normalizeRate(params.currentRate);\n\t\tthis.textMessageCode = params.textMessageCode;\n\t\tthis.renderedItems = [];\n\t\tthis.players = [];\n\t}\n\n\tisRateCurrent(rateDescription, rate)\n\t{\n\t\treturn ((rateDescription.rate && rate === rateDescription.rate) || rate === rateDescription);\n\t}\n\n\tnormalizeRate(rate)\n\t{\n\t\trate = parseFloat(rate);\n\t\tlet i = 0;\n\t\tconst length = this.availableRates.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tif(this.isRateCurrent(this.availableRates[i], rate))\n\t\t\t{\n\t\t\t\treturn rate;\n\t\t\t}\n\t\t}\n\n\t\treturn (this.availableRates[0].rate || this.availableRates[0]);\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tconst selectedRate = this.getRate();\n\n\t\treturn this.availableRates.map(function(item) {\n\t\t\treturn {\n\t\t\t\ttext: (item.text || item) + '',\n\t\t\t\thtml: (item.html || item) + '',\n\t\t\t\tclassName: (this.isRateCurrent(item, selectedRate)) ? 'menu-popup-item-text-active' : null,\n\t\t\t\tonclick: function() {\n\t\t\t\t\tthis.setRate(item.rate || item)\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t}.bind(this))\n\t}\n\n\tgetPopup(node)\n\t{\n\t\tlet popupMenu = BX.Main.MenuManager.getMenuById(this.menuId);\n\t\tif(popupMenu)\n\t\t{\n\t\t\tconst popupWindow = popupMenu.getPopupWindow();\n\t\t\tif (popupWindow)\n\t\t\t{\n\t\t\t\tpopupWindow.setBindElement(node);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpopupMenu = BX.Main.MenuManager.create({\n\t\t\t\tid: this.menuId,\n\t\t\t\tbindElement: node,\n\t\t\t\titems: this.getMenuItems(),\n\t\t\t\tclassName: 'crm-audio-cap-speed-popup'\n\t\t\t});\n\t\t}\n\n\t\treturn popupMenu;\n\t}\n\n\tgetRate()\n\t{\n\t\treturn this.normalizeRate(this.currentRate);\n\t}\n\n\tsetRate(rate)\n\t{\n\t\tthis.getPopup().destroy();\n\n\t\trate = this.normalizeRate(rate);\n\t\tif(this.currentRate === rate)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.currentRate = rate;\n\t\tBX.userOptions.save(\"crm\", this.name, 'rate', rate);\n\n\t\tfor(let i = 0, length = this.renderedItems.length; i < length; i++)\n\t\t{\n\t\t\tconst textNode = this.renderedItems[i].querySelector('.crm-audio-cap-speed-text');\n\t\t\tif(textNode)\n\t\t\t{\n\t\t\t\ttextNode.innerHTML = this.getText();\n\t\t\t}\n\t\t}\n\n\t\tfor(let i = 0, length = this.players.length; i < length; i++)\n\t\t{\n\t\t\tthis.players[i].vjsPlayer.playbackRate(this.getRate());\n\t\t}\n\t}\n\n\tgetText()\n\t{\n\t\tlet text;\n\n\t\tif(this.textMessageCode)\n\t\t{\n\t\t\ttext = BX.Loc.getMessage(this.textMessageCode);\n\t\t}\n\t\tif(!text)\n\t\t{\n\t\t\ttext = '#RATE#';\n\t\t}\n\n\t\treturn text.replace('#RATE#', '<span>' + this.getRate() + 'x</span>');\n\t}\n\n\trender()\n\t{\n\t\tconst item = BX.Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'crm-audio-cap-speed-wrapper'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tBX.Dom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'crm-audio-cap-speed',\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.Dom.create('div', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'crm-audio-cap-speed-text'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: this.getText()\n\t\t\t\t\t\t})\n\t\t\t\t\t],\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tclick: function (event) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.getPopup(event.target).show()\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\t\tthis.renderedItems.push(item);\n\n\t\treturn item;\n\t}\n\n\taddPlayer(player)\n\t{\n\t\tif(BX.Fileman.Player && player instanceof BX.Fileman.Player)\n\t\t{\n\t\t\tthis.players.push(player);\n\t\t}\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Tools */\nexport default class SchedulePostponeController\n{\n\tconstructor()\n\t{\n\t\tthis._item = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\t\tthis._item = BX.prop.get(this._settings, \"item\", null);\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"title\");\n\t}\n\n\tgetCommandList()\n\t{\n\t\treturn(\n\t\t\t[\n\t\t\t\t{ name: \"postpone_hour_1\", title: this.getMessage(\"forOneHour\") },\n\t\t\t\t{ name: \"postpone_hour_2\", title: this.getMessage(\"forTwoHours\") },\n\t\t\t\t{ name: \"postpone_hour_3\", title: this.getMessage(\"forThreeHours\") },\n\t\t\t\t{ name: \"postpone_day_1\", title: this.getMessage(\"forOneDay\") },\n\t\t\t\t{ name: \"postpone_day_2\", title: this.getMessage(\"forTwoDays\") },\n\t\t\t\t{ name: \"postpone_day_3\", title: this.getMessage(\"forThreeDays\") }\n\t\t\t]\n\t\t);\n\t}\n\n\tprocessCommand(command)\n\t{\n\t\tif(command.indexOf(\"postpone\") !== 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet offset = 0;\n\t\tif(command === \"postpone_hour_1\")\n\t\t{\n\t\t\toffset = 3600;\n\t\t}\n\t\telse if(command === \"postpone_hour_2\")\n\t\t{\n\t\t\toffset = 7200;\n\t\t}\n\t\telse if(command === \"postpone_hour_3\")\n\t\t{\n\t\t\toffset = 10800;\n\t\t}\n\t\telse if(command === \"postpone_day_1\")\n\t\t{\n\t\t\toffset = 86400;\n\t\t}\n\t\telse if(command === \"postpone_day_2\")\n\t\t{\n\t\t\toffset = 172800;\n\t\t}\n\t\telse if(command === \"postpone_day_3\")\n\t\t{\n\t\t\toffset = 259200;\n\t\t}\n\n\t\tif(offset > 0 && this._item)\n\t\t{\n\t\t\tthis._item.postpone(offset);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = SchedulePostponeController.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new SchedulePostponeController();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Scheduled from \"../scheduled\";\nimport {Item as ItemType} from \"../../types\";\nimport Item from \"../../item\";\nimport SchedulePostponeController from \"../../tools/schedule-postpone-controller\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Activity extends Scheduled\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._postponeController = null;\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.activity;\n\t}\n\n\tisDone()\n\t{\n\t\tconst status = BX.prop.getInteger(this.getAssociatedEntityData(), \"STATUS\");\n\t\treturn (status ===  BX.CrmActivityStatus.completed || status ===  BX.CrmActivityStatus.autoCompleted);\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tif(this.isDone() === isDone)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.setActivityCompleted(\n\t\t\t\tid,\n\t\t\t\tisDone,\n\t\t\t\tBX.delegate(this.onSetAsDoneCompleted, this)\n\t\t\t);\n\t\t}\n\t}\n\n\tpostpone(offset)\n\t{\n\t\tconst id = this.getSourceId();\n\t\tif(id > 0 && offset > 0)\n\t\t{\n\t\t\tthis._activityEditor.postponeActivity(\n\t\t\t\tid,\n\t\t\t\toffset,\n\t\t\t\tBX.delegate(this.onPosponeCompleted, this)\n\t\t\t);\n\t\t}\n\t}\n\n\tview()\n\t{\n\t\tconst id = BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.viewActivity(id);\n\t\t}\n\t}\n\n\tedit()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.editActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getRemoveMessage()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\treturn this.getMessage('removeConfirm');\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tconst activityEditor = this._activityEditor;\n\t\t\t\tconst item = activityEditor.getItemById(id);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tactivityEditor.deleteActivity(id, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst activityType = activityEditor.getSetting('ownerType', '');\n\t\t\t\t\tconst activityId = activityEditor.getSetting('ownerID', '');\n\n\t\t\t\t\tconst serviceUrl = BX.util.add_url_param(activityEditor.getSetting('serviceUrl', ''),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\taction: 'get_activity',\n\t\t\t\t\t\t\townertype: activityType,\n\t\t\t\t\t\t\townerid: activityId\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tBX.ajax({\n\t\t\t\t\t\t'url': serviceUrl,\n\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t'dataType': 'json',\n\t\t\t\t\t\t'data':\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'ACTION' : 'GET_ACTIVITY',\n\t\t\t\t\t\t\t\t'ID': id,\n\t\t\t\t\t\t\t\t'OWNER_TYPE': activityType,\n\t\t\t\t\t\t\t\t'OWNER_ID': activityId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\tonsuccess: BX.delegate(\n\t\t\t\t\t\t\tfunction(data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(typeof(data['ACTIVITY']) !== 'undefined')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tactivityEditor._handleActivityChange(data['ACTIVITY']);\n\t\t\t\t\t\t\t\t\twindow.setTimeout(BX.delegate(this.remove ,this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonfailure: function(data){}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetDeadline()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"DEADLINE_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn new Date(time.getTime() + 1000 * Item.getUserTimezoneOffset());\n\t}\n\n\tmarkAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tthis.getAssociatedEntityData()[\"STATUS\"] = isDone ? BX.CrmActivityStatus.completed : BX.CrmActivityStatus.waiting;\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"from\" : \"to\");\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\treturn \"\";\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn ((!!this.getDeadline() && this.canPostpone()) || this.canComplete());\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst isDone = this.isDone();\n\t\tconst subject = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst title = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"TYPE\", \"\") !== \"\"\n\t\t\t? BX.prop.getString(communication, \"VALUE\", \"\") : \"\";\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"}\n\t\t\t}\n\t\t);\n\t\theaderWrapper.appendChild(BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"crm-entity-stream-content-event-title\"\n\t\t\t\t\t},\n\t\t\t\ttext: this.getTypeDescription(direction)\n\t\t\t}\n\t\t));\n\n\t\tconst statusNode = this.getStatusNode();\n\t\tif (statusNode)\n\t\t{\n\t\t\theaderWrapper.appendChild(statusNode);\n\t\t}\n\t\theaderWrapper.appendChild(this._deadlineNode);\n\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: subject\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: this.cutOffText(description, 128)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst additionalDetails = this.prepareDetailNodes();\n\t\tif(BX.type.isArray(additionalDetails))\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tconst length = additionalDetails.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(additionalDetails[i]);\n\t\t\t}\n\t\t}\n\n\t\tconst members = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}}\n\t\t);\n\n\t\tif(title !== '')\n\t\t{\n\t\t\tmembers.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getPrepositionText(direction) + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(showUrl !== '')\n\t\t\t{\n\t\t\t\tmembers.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: showUrl },\n\t\t\t\t\t\t\ttext: title\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmembers.appendChild(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValue !== '')\n\t\t{\n\t\t\tconst communicationNode = this.prepareCommunicationNode(communicationValue);\n\t\t\tif(communicationNode)\n\t\t\t{\n\t\t\t\tmembers.appendChild(communicationNode);\n\t\t\t}\n\t\t}\n\n\t\tdetailWrapper.appendChild(members);\n\t\t//endregion\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tgetStatusNode()\n\t{\n\t\treturn null;\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn BX.create(\"SPAN\", { text: \" \" + communicationValue });\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t\treturn [];\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isEditable())\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.edit, this)});\n\t\t\t}\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\t\t}\n\n\t\tconst handler = BX.delegate(this.onContextMenuItemSelect, this);\n\n\t\tif(!this._postponeController)\n\t\t{\n\t\t\tthis._postponeController = SchedulePostponeController.create(\"\", { item: this });\n\t\t}\n\n\t\tconst postponeMenu =\n\t\t\t{\n\t\t\t\tid: \"postpone\",\n\t\t\t\ttext: this._postponeController.getTitle(),\n\t\t\t\titems: []\n\t\t\t};\n\n\t\tconst commands = this._postponeController.getCommandList();\n\t\tlet i = 0;\n\t\tconst length = commands.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst command = commands[i];\n\t\t\tpostponeMenu.items.push(\n\t\t\t\t{\n\t\t\t\t\tid: command[\"name\"],\n\t\t\t\t\ttext: command[\"title\"],\n\t\t\t\t\tonclick: handler\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tmenuItems.push(postponeMenu);\n\t\treturn menuItems;\n\t}\n\n\tonContextMenuItemSelect(e, item)\n\t{\n\t\tthis.closeContextMenu();\n\t\tif(this._postponeController)\n\t\t{\n\t\t\tthis._postponeController.processCommand(item.id);\n\t\t}\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Email extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-email\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-email\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tBX.CrmScheduleEmailAction.create(\n\t\t\t\t\"email\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('emailRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Email();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Call extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-call';\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-call\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tBX.CrmScheduleCallAction.create(\n\t\t\t\t\"call\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._schedule.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst callTypeText = callInfo !== null ? BX.prop.getString(callInfo, \"CALL_TYPE_TEXT\", \"\") : \"\";\n\t\tif(callTypeText !== \"\")\n\t\t{\n\t\t\treturn callTypeText;\n\t\t}\n\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tconst messageName = (direction === BX.CrmActivityDirection.incoming) ? 'incomingCallRemove' : 'outgoingCallRemove';\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage(messageName).replace(\"#TITLE#\", title);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Call();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Call from \"./call\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class CallTracker extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetStatusNode()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\n\t\tif (!callInfo)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tif (!BX.prop.getBoolean(callInfo, \"HAS_STATUS\", false))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst isSuccessfull = BX.prop.getBoolean(callInfo, \"SUCCESSFUL\", false);\n\t\tconst statusText = BX.prop.getString(callInfo, \"STATUS_TEXT\", \"\");\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: isSuccessfull\n\t\t\t\t\t\t\t? \"crm-entity-stream-content-event-successful\"\n\t\t\t\t\t\t\t: \"crm-entity-stream-content-event-missing\"\n\t\t\t\t\t},\n\t\t\t\ttext: statusText\n\t\t\t}\n\t\t)\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new CallTracker();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Meeting extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-meeting\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetPrepositionText()\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('meetingRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"meeting\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Meeting();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Task extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-planned-task\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-task\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"task\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('taskRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Task();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class StoreDocument extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-planned-store-document\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-store-document\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"storeDocument\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('taskRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst isDone = this.isDone();\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"}\n\t\t\t}\n\t\t);\n\t\theaderWrapper.appendChild(BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"crm-entity-stream-content-event-title\"\n\t\t\t\t\t},\n\t\t\t\ttext: this.getTypeDescription(direction)\n\t\t\t}\n\t\t));\n\n\t\tconst statusNode = this.getStatusNode();\n\t\tif (statusNode)\n\t\t{\n\t\t\theaderWrapper.appendChild(statusNode);\n\t\t}\n\t\theaderWrapper.appendChild(this._deadlineNode);\n\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"SPAN\", { text: this.getMessage(\"storeDocumentDescription\") }),\n\t\t\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\t\thref: \"#\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: BX.delegate(function (e) {\n\t\t\t\t\t\t\t\t\ttop.BX.Helper.show('redirect=detail&code=14828480');\n\t\t\t\t\t\t\t\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: \" \" + BX.message('CRM_TIMELINE_DETAILS'),\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst additionalDetails = this.prepareDetailNodes();\n\t\tif(BX.type.isArray(additionalDetails))\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tconst length = additionalDetails.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(additionalDetails[i]);\n\t\t\t}\n\t\t}\n\t\t//endregion\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new StoreDocument();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class WebForm extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-crmForm\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetPrepositionText()\n\t{\n\t\treturn this.getMessage(\"from\");\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"webform\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WebForm();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Scheduled from \"../scheduled\";\nimport {Item as ItemType} from \"../../types\";\nimport Item from \"../../item\";\nimport SchedulePostponeController from \"../../tools/schedule-postpone-controller\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Wait extends Scheduled\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._postponeController = null;\n\t}\n\t\n\tgetTypeId()\n\t{\n\t\treturn ItemType.wait;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-wait\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-wait\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tisCounterEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tgetDeadline()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"DEADLINE_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn new Date(time.getTime() + 1000 * Item.getUserTimezoneOffset());\n\t}\n\n\tisDone()\n\t{\n\t\treturn (BX.prop.getString(this.getAssociatedEntityData(), \"COMPLETED\", \"N\") ===  \"Y\");\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tif(this.isDone() === isDone)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = this.getAssociatedEntityId();\n\t\tif(id > 0)\n\t\t{\n\t\t\tconst editor = this._schedule.getManager().getWaitEditor();\n\t\t\tif(editor)\n\t\t\t{\n\t\t\t\teditor.complete(\n\t\t\t\t\tid,\n\t\t\t\t\tisDone,\n\t\t\t\t\tBX.delegate(this.onSetAsDoneCompleted, this)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tpostpone(offset)\n\t{\n\t\tconst id = this.getAssociatedEntityId();\n\t\tif(id > 0 && offset > 0)\n\t\t{\n\t\t\tconst editor = this._schedule.getManager().getWaitEditor();\n\t\t\tif(editor)\n\t\t\t{\n\t\t\t\teditor.postpone(\n\t\t\t\t\tid,\n\t\t\t\t\toffset,\n\t\t\t\t\tBX.delegate(this.onPosponeCompleted, this)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn !!this.getDeadline() && this.canPostpone();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst isDone = this.isDone();\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\tdescription = BX.util.trim(description);\n\t\t\tdescription = BX.util.strip_tags(description);\n\t\t\tdescription = this.cutOffText(description, 512);\n\t\t\tdescription = BX.util.nl2br(description);\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\t\t\t\ttext: this.getMessage(\"wait\")\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._deadlineNode\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\thtml: description\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst members = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}}\n\t\t);\n\n\t\tdetailWrapper.appendChild(members);\n\t\t//endregion\n\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = BX.delegate(this.onContextMenuItemSelect, this);\n\n\t\tif(!this._postponeController)\n\t\t{\n\t\t\tthis._postponeController = SchedulePostponeController.create(\"\", { item: this });\n\t\t}\n\n\t\tconst postponeMenu =\n\t\t\t{\n\t\t\t\tid: \"postpone\",\n\t\t\t\ttext: this._postponeController.getTitle(),\n\t\t\t\titems: []\n\t\t\t};\n\n\t\tconst commands = this._postponeController.getCommandList();\n\t\tlet i = 0;\n\t\tconst length = commands.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst command = commands[i];\n\t\t\tpostponeMenu.items.push(\n\t\t\t\t{\n\t\t\t\t\tid: command[\"name\"],\n\t\t\t\t\ttext: command[\"title\"],\n\t\t\t\t\tonclick: handler\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tmenuItems.push(postponeMenu);\n\t\treturn menuItems;\n\t}\n\n\tonContextMenuItemSelect(e, item)\n\t{\n\t\tthis.closeContextMenu();\n\t\tif(this._postponeController)\n\t\t{\n\t\t\tthis._postponeController.processCommand(item.id);\n\t\t}\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"wait\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Request extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-robot\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"activityRequest\");\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Request();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Rest extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-rest\";\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst wrapper = super.prepareContent(options);\n\t\tconst data = this.getAssociatedEntityData();\n\n\t\tif (data['APP_TYPE'] && data['APP_TYPE']['ICON_SRC'])\n\t\t{\n\t\t\tconst iconNode = wrapper.querySelector('[class=\"' + this.getIconClassName() + '\"]');\n\t\t\tif (iconNode)\n\t\t\t{\n\t\t\t\ticonNode.style.backgroundImage = \"url('\" +  data['APP_TYPE']['ICON_SRC'] + \"')\";\n\t\t\t\ticonNode.style.backgroundPosition = \"center center\";\n\t\t\t}\n\t\t}\n\n\t\treturn wrapper;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['NAME'])\n\t\t{\n\t\t\treturn entityData['APP_TYPE']['NAME'];\n\t\t}\n\n\t\treturn this.getMessage(\"restApplication\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \".//activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class OpenLine extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._button = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn this._button;\n\t}\n\n\tonClick()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t}\n\t\t);\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OpenLine.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Activity from \"./activity\";\nimport {OpenLine as OpenLineAction} from \"../../actions/openline\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class OpenLine extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-IM\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-IM\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tOpenLineAction.create(\n\t\t\t\t\"openline\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._schedule.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"openLine\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM\"}}\n\t\t);\n\n\t\tconst messageWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM-messages\"}}\n\t\t);\n\t\twrapper.appendChild(messageWrapper);\n\n\t\tconst openLineData = BX.prop.getObject(this.getAssociatedEntityData(), \"OPENLINE_INFO\", null);\n\t\tif(openLineData)\n\t\t{\n\t\t\tconst messages = BX.prop.getArray(openLineData, \"MESSAGES\", []);\n\t\t\tlet i = 0;\n\t\t\tconst length = messages.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst message = messages[i];\n\t\t\t\tconst isExternal = BX.prop.getBoolean(message, \"IS_EXTERNAL\", true);\n\n\t\t\t\tmessageWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tclassName: isExternal\n\t\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-detail-IM-message-incoming\"\n\t\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-detail-IM-message-outgoing\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: BX.prop.getString(message, \"MESSAGE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn [ wrapper ];\n\t}\n\n\tview()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this.getAssociatedEntityData(), \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\nimport Item from \"../../item\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Zoom extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-zoom\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-zoom\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"zoom\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst isDone = this.isDone();\n\t\tconst subject = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst title = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"TYPE\", \"\") !== \"\"\n\t\t\t? BX.prop.getString(communication, \"VALUE\", \"\") : \"\";\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-event-title\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttext: this.getTypeDescription(direction)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._deadlineNode\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tif (entityData['ZOOM_INFO'])\n\t\t{\n\t\t\tconst topic = entityData['ZOOM_INFO']['TOPIC'];\n\t\t\tconst duration = entityData['ZOOM_INFO']['DURATION'];\n\t\t\tconst startTimeStamp = BX.parseDate(\n\t\t\t\tentityData['ZOOM_INFO']['CONF_START_TIME'],\n\t\t\t\tfalse,\n\t\t\t\t\"YYYY-MM-DD\",\n\t\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t\t);\n\t\t\tconst date = new Date(startTimeStamp.getTime() + 1000 * Item.getUserTimezoneOffset());\n\t\t\tconst detailZoomMessage = BX.create(\"span\",\n\t\t\t\t{\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedMessage\")\n\t\t\t\t\t\t.replace(\"#CONFERENCE_TITLE#\", topic)\n\t\t\t\t\t\t.replace(\"#DATE_TIME#\", this.formatDateTime(date))\n\t\t\t\t\t\t.replace(\"#DURATION#\", duration)\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomInfoLink = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thref: entityData['ZOOM_INFO']['CONF_URL'],\n\t\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\t},\n\t\t\t\t\ttext: entityData['ZOOM_INFO']['CONF_URL']\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomInfo = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-zoom-info\"},\n\t\t\t\t\tchildren: [detailZoomMessage, detailZoomInfoLink]\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdetailWrapper.appendChild(detailZoomInfo);\n\n\t\t\tconst detailZoomCopyInviteLink = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'ui-link ui-link-dashed',\n\t\t\t\t\t\t\"data-url\": entityData['ZOOM_INFO']['CONF_URL']\n\t\t\t\t\t},\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedCopyInviteLink\"),\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.clipboard.bindCopyClick(detailZoomCopyInviteLink, {\n\t\t\t\ttext: entityData['ZOOM_INFO']['CONF_URL'],\n\t\t\t});\n\n\t\t\tconst detailZoomStartConferenceButton = BX.create(\"BUTTON\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: 'ui-btn ui-btn-sm ui-btn-primary'},\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedStartConference\"),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t\"click\": function () {\n\t\t\t\t\t\t\twindow.open(entityData['ZOOM_INFO']['CONF_URL']);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomCopyInviteLinkWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-zoom-link-wrapper\"},\n\t\t\t\t\tchildren: [detailZoomCopyInviteLink]\n\t\t\t\t}\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(detailZoomCopyInviteLinkWrapper);\n\t\t\tdetailWrapper.appendChild(detailZoomStartConferenceButton);\n\t\t}\n\n\t\tconst additionalDetails = this.prepareDetailNodes();\n\t\tif(BX.type.isArray(additionalDetails))\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tconst length = additionalDetails.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(additionalDetails[i]);\n\t\t\t}\n\t\t}\n\n\t\t//endregion\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Zoom();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Item\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\trun()\n\t{\n\t\tthis._node = this._initialItem.getWrapper();\n\t\tconst originalPosition = BX.pos(this._node);\n\t\tthis._initialYPosition = originalPosition.top;\n\t\tthis._initialXPosition = originalPosition.left;\n\t\tthis._initialWidth = this._node.offsetWidth;\n\t\tthis._initialHeight = this._node.offsetHeight;\n\n\t\tthis._anchorYPosition = BX.pos(this._anchor).top;\n\n\t\tthis.createStub();\n\t\tthis.createGhost();\n\t\tthis.moveGhost();\n\t}\n\n\tcreateStub()\n\t{\n\t\tthis._stub = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-shadow\" },\n\t\t\t\tchildren :\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon\" } }),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\tstyle: { height: this._initialHeight + \"px\" }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tthis._node.parentNode.insertBefore(this._stub, this._node);\n\t}\n\n\tcreateGhost()\n\t{\n\t\tthis._ghostNode = this._node;\n\t\tthis._ghostNode.style.position = \"absolute\";\n\t\tthis._ghostNode.style.width = this._initialWidth + \"px\";\n\t\tthis._ghostNode.style.height = this._initialHeight + \"px\";\n\t\tthis._ghostNode.style.top = this._initialYPosition + \"px\";\n\t\tthis._ghostNode.style.left = this._initialXPosition + \"px\";\n\t\tdocument.body.appendChild(this._ghostNode);\n\t\tsetTimeout(BX.proxy(function (){BX.addClass(this._ghostNode, \"crm-entity-stream-section-casper\" )}, this), 20);\n\t}\n\n\tmoveGhost()\n\t{\n\t\tconst node = this._ghostNode;\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {top: this._initialYPosition},\n\t\t\tfinish: {top: this._anchorYPosition},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tnode.style.top = state.top + \"px\";\n\t\t\t}, this)\n\t\t});\n\t\tsetTimeout( BX.proxy(function () {\n\t\t\tmovingEvent.animate();\n\t\t\tnode.style.boxShadow = \"\";\n\t\t}, this), 500);\n\n\t\tconst placeEventAnim = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {height: 0},\n\t\t\tfinish: {height: this._initialHeight + 20},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tif (BX.type.isFunction(this._events[\"complete\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"complete\"]();\n\t\t\t\t}\n\n\t\t\t\tthis.addHistoryItem();\n\t\t\t\tthis.removeGhost();\n\t\t\t}, this)\n\t\t});\n\t\tsetTimeout(function (){placeEventAnim.animate()}, 500);\n\t}\n\n\taddHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\n\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\n\t\tthis._finalItemHeight = this._anchor.offsetHeight - node.offsetHeight;\n\t\tthis._anchor.style.height = 0;\n\t\tnode.style.marginBottom = this._finalItemHeight + \"px\";\n\t}\n\n\tremoveGhost()\n\t{\n\t\tconst ghostNode = this._ghostNode;\n\t\tconst finalNode = this._finalItem.getWrapper();\n\n\t\tghostNode.style.overflow = \"hidden\";\n\t\tconst hideCasperItem = new BX.easing({\n\t\t\tduration: 70,\n\t\t\tstart: {opacity: 100, height: ghostNode.offsetHeight, marginBottom: this._finalItemHeight},\n\t\t\tfinish: {opacity: 0, height: finalNode.offsetHeight, marginBottom: 20},\n\t\t\t// transition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tghostNode.style.opacity = state.opacity / 100;\n\t\t\t\tghostNode.style.height = state.height + \"px\";\n\t\t\t\tfinalNode.style.marginBottom = state.marginBottom + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tghostNode.remove();\n\t\t\t\tfinalNode.style.marginBottom = \"\";\n\t\t\t\tthis.collapseStub();\n\n\t\t\t}, this)\n\t\t});\n\t\thideCasperItem.animate();\n\t}\n\n\tcollapseStub()\n\t{\n\t\tconst removePlannedEvent = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {opacity: 100, height: this._initialHeight, marginBottom: 15},\n\t\t\tfinish: {opacity: 0, height: 0, marginBottom: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._stub.style.height = state.height + \"px\";\n\t\t\t\tthis._stub.style.marginBottom = state.marginBottom + \"px\";\n\t\t\t\tthis._stub.style.opacity = state.opacity / 100;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.inited = false\n\t\t\t}, this)\n\n\t\t});\n\t\tremovePlannedEvent.animate();\n\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Item();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Shift\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._anchor = null;\n\t\tthis._nodeParent  = null;\n\t\tthis._startPosition = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(node, anchor, startPosition, shadowNode, events)\n\t{\n\t\tthis._node = node;\n\t\tthis._shadowNode = shadowNode;\n\t\tthis._anchor = anchor;\n\t\tthis._nodeParent  = node.parentNode;\n\t\tthis._startPosition = startPosition;\n\t\tthis._events = BX.type.isPlainObject(events) ? events : {};\n\n\t}\n\n\trun()\n\t{\n\t\tthis._anchorPosition = BX.pos(this._anchor);\n\n\t\tsetTimeout(\n\t\t\tBX.proxy(\n\t\t\t\tfunction (){\n\t\t\t\t\tBX.addClass(this._node, \"crm-entity-stream-section-casper\" )\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t),\n\t\t\t0\n\t\t);\n\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: 1500,\n\t\t\tstart: {top: this._startPosition.top, height: 0},\n\t\t\tfinish: {top: this._anchorPosition.top, height: this._startPosition.height + 20},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._node.style.top = state.top + \"px\";\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.finish();\n\t\t\t}, this)\n\t\t});\n\t\tmovingEvent.animate();\n\t}\n\n\tfinish()\n\t{\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t\tif( this._shadowNode !== false )\n\t\t{\n\t\t\t// this._stub.height = 0;\n\t\t}\n\t}\n\n\tstatic create(node, anchor, startPosition, shadowNode, events)\n\t{\n\t\tconst self = new Shift();\n\t\tself.initialize(node, anchor, startPosition, shadowNode, events);\n\t\treturn self;\n\t}\n}\n","import Shift from \"./shift\";\n\n/** @memberof BX.Crm.Timeline.Animation */\nexport default class ItemNew\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\taddHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\n\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\n\t}\n\n\trun()\n\t{\n\t\tthis._node = this._initialItem.getWrapper();\n\t\tthis.createStub();\n\n\t\tBX.addClass(this._node, 'crm-entity-stream-section-animate-start');\n\n\t\tthis._startPosition = BX.pos(this._stub);\n\n\t\tthis._node.style.position = \"absolute\";\n\t\tthis._node.style.width = this._startPosition.width + \"px\";\n\t\tthis._node.style.height = this._startPosition.height + \"px\";\n\t\tthis._node.style.top = this._startPosition.top + \"px\";\n\t\tthis._node.style.left = this._startPosition.left + \"px\";\n\t\tthis._node.style.zIndex = 960;\n\n\n\t\tdocument.body.appendChild(this._node);\n\n\t\tconst shift = Shift.create(\n\t\t\tthis._node,\n\t\t\tthis._anchor,\n\t\t\tthis._startPosition,\n\t\t\tthis._stub,\n\t\t\t{complete: BX.delegate(this.finish, this)}\n\t\t);\n\t\tshift.run();\n\t}\n\n\tcreateStub()\n\t{\n\t\tthis._stub = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-shadow\" },\n\t\t\t\tchildren :\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon\" } }),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\tstyle: { height: this._initialItem._wrapper.clientHeight + \"px\" }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tthis._node.parentNode.insertBefore(this._stub, this._node);\n\t}\n\n\tfinish()\n\t{\n\t\tconst stubContainer = this._stub.querySelector('.crm-entity-stream-section-content');\n\n\t\tthis._anchor.style.height = 0;\n\t\t//this._anchor.parentNode.insertBefore(this._node, this._anchor.nextSibling);\n\n\t\tsetTimeout(\n\t\t\tBX.delegate(function() {\n\t\t\t\tBX.removeClass(this._node, 'crm-entity-stream-section-animate-start');\n\t\t\t}, this),\n\t\t\t0\n\t\t);\n\n\t\tthis._node.style.opacity = 0;\n\n\t\tsetTimeout( BX.delegate(\n\t\t\tfunction() {\n\t\t\t\tstubContainer.style.height = 0;\n\t\t\t\tstubContainer.style.opacity = 0;\n\t\t\t\tstubContainer.style.paddingTop = 0;\n\t\t\t\tstubContainer.style.paddingBottom = 0;\n\t\t\t},\n\t\t\tthis\n\t\t), 120 );\n\n\t\tsetTimeout( BX.delegate(\n\t\t\tfunction() {\n\t\t\t\tBX.remove(this._stub);\n\t\t\t\tBX.remove(this._node);\n\t\t\t\tthis.addHistoryItem();\n\n\t\t\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"complete\"]();\n\t\t\t\t}\n\t\t\t},\n\t\t\tthis\n\t\t), 420 );\n\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ItemNew();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Stream from \"../stream\";\nimport Activity from \"../items/scheduled/activity\";\nimport Email from \"../items/scheduled/email\";\nimport Call from \"../items/scheduled/call\";\nimport CallTracker from \"../items/scheduled/call-tracker\";\nimport Meeting from \"../items/scheduled/meeting\";\nimport Task from \"../items/scheduled/task\";\nimport StoreDocument from \"../items/scheduled/store-document\";\nimport WebForm from \"../items/scheduled/webform\";\nimport Wait from \"../items/scheduled/wait\";\nimport Request from \"../items/scheduled/request\";\nimport Rest from \"../items/scheduled/rest\";\nimport OpenLine from \"../items/scheduled/openline\";\nimport Zoom from \"../items/scheduled/zoom\";\nimport Item from \"../animations/item\";\nimport ItemNew from \"../animations/item-new\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class Schedule extends Stream\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._history = null;\n\t\tthis._wrapper = null;\n\t\tthis._anchor = null;\n\t\tthis._stub = null;\n\t\tthis._timeFormat = \"\";\n\t}\n\n\tdoInitialize()\n\t{\n\t\tconst datetimeFormat = BX.message(\"FORMAT_DATETIME\").replace(/:SS/, \"\");\n\t\tconst dateFormat = BX.message(\"FORMAT_DATE\");\n\t\tconst timeFormat = BX.util.trim(datetimeFormat.replace(dateFormat, \"\"));\n\t\tthis._timeFormat = BX.date.convertBitrixFormat(timeFormat);\n\n\t\tif(!this.isStubMode())\n\t\t{\n\t\t\tlet itemData = this.getSetting(\"itemData\");\n\t\t\tif(!BX.type.isArray(itemData))\n\t\t\t{\n\t\t\t\titemData = [];\n\t\t\t}\n\n\t\t\tlet i, length, item;\n\t\t\tfor(i = 0, length = itemData.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this.createItem(itemData[i]);\n\t\t\t\tif(item)\n\t\t\t\t{\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tconst label = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-planned-label\"},\n\t\t\t\ttext: this.getMessage(\"planned\")\n\t\t\t}\n\t\t);\n\n\t\tconst wrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned-label\";\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: wrapperClassName },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\t\tchildren: [ label ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(this.isStubMode())\n\t\t{\n\t\t\tthis.addStub();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst length = this._items.length;\n\t\t\tif(length === 0)\n\t\t\t{\n\t\t\t\tthis.addStub();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor(let i = 0; i < length; i++)\n\t\t\t\t{\n\t\t\t\t\tconst item = this._items[i];\n\t\t\t\t\titem.setContainer(this._wrapper);\n\t\t\t\t\titem.layout();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t\tBX.onCustomEvent('Schedule:onBeforeRefreshLayout', [this]);\n\t\tconst length = this._items.length;\n\t\tif(length === 0)\n\t\t{\n\t\t\tthis.addStub();\n\t\t\tif(this._history && this._history.hasContent())\n\t\t\t{\n\t\t\t\tBX.removeClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.addClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t\t}\n\n\t\t\tconst stubIcon = this._stub.querySelector(\".crm-entity-stream-section-icon\");\n\t\t\tif(stubIcon)\n\t\t\t{\n\t\t\t\tif(this._manager.isStubCounterEnabled())\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(stubIcon, \"crm-entity-stream-section-counter\");\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(stubIcon, \"crm-entity-stream-section-counter\");\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tlet i, item;\n\t\tif(this._history && this._history.hasContent())\n\t\t{\n\t\t\tfor(i = 0;  i < length; i++)\n\t\t\t{\n\t\t\t\titem = this._items[i];\n\t\t\t\tif(item.isTerminated())\n\t\t\t\t{\n\t\t\t\t\titem.markAsTerminated(false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(length > 1)\n\t\t\t{\n\t\t\t\tfor(i = 0;  i < (length - 1); i++)\n\t\t\t\t{\n\t\t\t\t\titem = this._items[i];\n\t\t\t\t\tif(item.isTerminated())\n\t\t\t\t\t{\n\t\t\t\t\t\titem.markAsTerminated(false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._items[length - 1].markAsTerminated(true);\n\t\t}\n\t}\n\n\tformatDateTime(time)\n\t{\n\t\tconst now = new Date();\n\t\treturn BX.date.format(\n\t\t\t[\n\t\t\t\t[ \"today\", \"today, \" + this._timeFormat ],\n\t\t\t\t[ \"tommorow\", \"tommorow, \" + this._timeFormat ],\n\t\t\t\t[ \"yesterday\", \"yesterday, \" + this._timeFormat ],\n\t\t\t\t[ \"\" , (time.getFullYear() === now.getFullYear() ? \"j F \" : \"j F Y \") + this._timeFormat ]\n\t\t\t],\n\t\t\ttime,\n\t\t\tnow\n\t\t);\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\tif(this._history && this._history.getItemCount() > 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\treturn this.getLastItem() === item;\n\t}\n\n\tgetLastItem()\n\t{\n\t\treturn this._items.length > 0 ? this._items[this._items.length - 1] : null;\n\t}\n\n\tcalculateItemIndex(item)\n\t{\n\t\tlet i, length;\n\t\tconst time = item.getDeadline();\n\t\tif(time)\n\t\t{\n\t\t\t//Item has deadline\n\t\t\tfor(i = 0, length = this._items.length; i < length; i++)\n\t\t\t{\n\t\t\t\tconst curTime = this._items[i].getDeadline();\n\t\t\t\tif(!curTime || time <= curTime)\n\t\t\t\t{\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//Item has't deadline\n\t\t\tconst sourceId = item.getSourceId();\n\t\t\tfor(i = 0, length = this._items.length; i < length; i++)\n\t\t\t{\n\t\t\t\tif(this._items[i].getDeadline())\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif(sourceId <= this._items[i].getSourceId())\n\t\t\t\t{\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this._items.length;\n\t}\n\n\tgetItemCount()\n\t{\n\t\treturn this._items.length;\n\t}\n\n\tgetItems()\n\t{\n\t\treturn this._items;\n\t}\n\n\tgetItemByAssociatedEntity($entityTypeId, entityId)\n\t{\n\t\tif(!BX.type.isNumber($entityTypeId))\n\t\t{\n\t\t\t$entityTypeId = parseInt($entityTypeId);\n\t\t}\n\n\t\tif(!BX.type.isNumber(entityId))\n\t\t{\n\t\t\tentityId = parseInt(entityId);\n\t\t}\n\n\t\tif(isNaN($entityTypeId) || $entityTypeId <= 0 || isNaN(entityId) || entityId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tfor(let i = 0, length = this._items.length; i < length; i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif(item.getAssociatedEntityTypeId() === $entityTypeId && item.getAssociatedEntityId() === entityId)\n\t\t\t{\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetItemByData(itemData)\n\t{\n\t\tif(!BX.type.isPlainObject(itemData))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.getItemByAssociatedEntity(\n\t\t\tBX.prop.getInteger(itemData, \"ASSOCIATED_ENTITY_TYPE_ID\", 0),\n\t\t\tBX.prop.getInteger(itemData, \"ASSOCIATED_ENTITY_ID\", 0)\n\t\t);\n\t}\n\n\tgetItemIndex(item)\n\t{\n\t\tfor(let i = 0, l = this._items.length; i < l; i++)\n\t\t{\n\t\t\tif(this._items[i] === item)\n\t\t\t{\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\n\tgetItemByIndex(index)\n\t{\n\t\treturn index < this._items.length ? this._items[index] : null;\n\t}\n\n\tremoveItemByIndex(index)\n\t{\n\t\tif(index < this._items.length)\n\t\t{\n\t\t\tthis._items.splice(index, 1);\n\t\t}\n\t}\n\n\tcreateItem(data)\n\t{\n\t\tconst entityTypeID = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0);\n\t\tconst entityID = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_ID\", 0);\n\t\tconst entityData = BX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {});\n\t\tconst itemId = BX.CrmEntityType.resolveName(entityTypeID) + \"_\" + entityID.toString();\n\n\t\tif(entityTypeID === BX.CrmEntityType.enumeration.wait)\n\t\t{\n\t\t\treturn Wait.create(\n\t\t\t\titemId,\n\t\t\t\t{\n\t\t\t\t\tschedule: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse// if(entityTypeID === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst typeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\n\t\t\tif(typeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\treturn Email.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\treturn Call.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\treturn Meeting.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\treturn Task.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t\t{\n\t\t\t\t\treturn WebForm.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"CRM_REQUEST\")\n\t\t\t\t{\n\t\t\t\t\treturn Request.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"IMOPENLINES_SESSION\")\n\t\t\t\t{\n\t\t\t\t\treturn OpenLine.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"ZOOM\")\n\t\t\t\t{\n\t\t\t\t\treturn Zoom.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"REST_APP\")\n\t\t\t\t{\n\t\t\t\t\treturn Rest.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === 'CRM_DELIVERY')\n\t\t\t\t{\n\t\t\t\t\treturn Activity.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data,\n\t\t\t\t\t\t\tvueComponent: BX.Crm.Timeline.DeliveryActivity,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === 'CRM_CALL_TRACKER')\n\t\t\t\t{\n\t\t\t\t\treturn CallTracker.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data,\n\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === 'STORE_DOCUMENT')\n\t\t\t\t{\n\t\t\t\t\treturn StoreDocument.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddItem(item, index)\n\t{\n\t\tif(!BX.type.isNumber(index) || index < 0)\n\t\t{\n\t\t\tindex = this.calculateItemIndex(item);\n\t\t}\n\n\t\tif(index < this._items.length)\n\t\t{\n\t\t\tthis._items.splice(index, 0, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._items.push(item);\n\t\t}\n\n\t\tthis.removeStub();\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tthis._anchor = BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section crm-entity-stream-section-shadow\" } });\n\t\tif(index >= 0 && index < this._items.length)\n\t\t{\n\t\t\tthis._wrapper.insertBefore(this._anchor, this._items[index].getWrapper());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._wrapper.appendChild(this._anchor);\n\t\t}\n\t\treturn this._anchor;\n\t}\n\n\tdeleteItem(item)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.clearLayout();\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\trefreshItem(item)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.removeItemByIndex(index);\n\n\t\tconst newItem = this.createItem(item.getData());\n\t\tconst newIndex = this.calculateItemIndex(newItem);\n\t\tif(newIndex === index)\n\t\t{\n\t\t\tthis.addItem(item, newIndex);\n\t\t\titem.refreshLayout();\n\t\t\titem.addWrapperClass(\"crm-entity-stream-section-updated\", 1000);\n\t\t\treturn;\n\t\t}\n\n\t\tconst anchor = this.createAnchor(newIndex);\n\t\tthis.addItem(newItem, newIndex);\n\t\tnewItem.layout({ add: false });\n\n\t\tconst animation = Item.create(\n\t\t\t\"\",\n\t\t\t{\n\t\t\t\tinitialItem: item,\n\t\t\t\tfinalItem: newItem,\n\t\t\t\tanchor: anchor\n\t\t\t}\n\t\t);\n\t\tanimation.run();\n\t}\n\n\ttransferItemToHistory(item, historyItemData)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\n\t\tconst historyItem = this._history.createItem(historyItemData);\n\t\tthis._history.addItem(historyItem, 0);\n\t\thistoryItem.layout({ add: false });\n\n\t\tconst animation = ItemNew.create(\n\t\t\t\"\",\n\t\t\t{\n\t\t\t\tinitialItem: item,\n\t\t\t\tfinalItem: historyItem,\n\t\t\t\tanchor: this._history.createAnchor(),\n\t\t\t\tevents: {complete: BX.delegate(this.onTransferComplete, this)}\n\t\t\t}\n\t\t);\n\t\tanimation.run();\n\t}\n\n\tonTransferComplete()\n\t{\n\t\tthis._history.refreshLayout();\n\n\t\tif(this._items.length === 0)\n\t\t{\n\t\t\tthis.addStub();\n\t\t}\n\t}\n\n\tonItemMarkedAsDone(item, params)\n\t{\n\t}\n\n\taddStub()\n\t{\n\t\tif(!this._stub)\n\t\t{\n\t\t\tconst stubClassName = \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-notTask\";\n\t\t\tlet stubIconClassName = \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\n\t\t\tlet stubMessage = this.getMessage(\"stub\");\n\n\t\t\tconst ownerTypeId = this._manager.getOwnerTypeId();\n\t\t\tif(ownerTypeId === BX.CrmEntityType.enumeration.lead)\n\t\t\t{\n\t\t\t\tstubMessage = this.getMessage(\"leadStub\");\n\t\t\t}\n\t\t\telse if(ownerTypeId === BX.CrmEntityType.enumeration.deal)\n\t\t\t{\n\t\t\t\tstubMessage = this.getMessage(\"dealStub\");\n\t\t\t}\n\n\t\t\tif(this._manager.isStubCounterEnabled())\n\t\t\t{\n\t\t\t\tstubIconClassName += \" crm-entity-stream-section-counter\";\n\t\t\t}\n\n\t\t\tthis._stub = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: stubClassName },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: stubIconClassName } }),\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: stubMessage\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._wrapper.appendChild(this._stub);\n\t\t}\n\n\t\tif(this._history && this._history.getItemCount() > 0)\n\t\t{\n\t\t\tBX.removeClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t}\n\t}\n\n\tremoveStub()\n\t{\n\t\tif(this._stub)\n\t\t{\n\t\t\tthis._stub = BX.remove(this._stub);\n\t\t}\n\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Schedule.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Schedule();\n\t\tself.initialize(id, settings);\n\t\tSchedule.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Modification extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Modification.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-info\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tconst contentChildren = [];\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"START_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detain-info-status\"},\n\t\t\t\t\t\ttext: this.getTextDataParam(\"START_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",{ attrs: { className: \"crm-entity-stream-content-detail-info-separator-icon\" } })\n\t\t\t);\n\t\t}\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"FINISH_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-info-status\" },\n\t\t\t\t\t\ttext: this.getTextDataParam(\"FINISH_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-info\" },\n\t\t\t\t\t\t\t\t\tchildren: contentChildren\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Modification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Conversion extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Conversion.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-convert crm-entity-stream-section-history\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-convert\" } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tcontent.appendChild(header);\n\n\t\tconst entityNodes = [];\n\t\tconst entityInfos = this.getArrayDataParam(\"ENTITIES\");\n\t\tlet i = 0;\n\t\tconst length = entityInfos.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst entityInfo = entityInfos[i];\n\n\t\t\tlet entityNode;\n\t\t\tif(BX.prop.getString(entityInfo, 'SHOW_URL', \"\") === \"\")\n\t\t\t{\n\t\t\t\tentityNode = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-convert\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-status-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.CrmEntityType.getNotFoundMessage(entityInfo['ENTITY_TYPE_ID'])\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tentityNode = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-convert\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-status-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: entityInfo['ENTITY_TYPE_CAPTION']\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tBX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-convert-separator-icon\" } }),\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref: entityInfo['SHOW_URL']\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: entityInfo['TITLE']\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\tentityNodes.push(entityNode);\n\t\t}\n\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: entityNodes\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Conversion();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import HistoryActivity from \"./history-activity\";\nimport {HistoryEmail} from \"../actions/email\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Email extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst emailInfo = BX.prop.getObject(entityData, \"EMAIL_INFO\", null);\n\t\tconst statusText = emailInfo !== null ? BX.prop.getString(emailInfo, \"STATUS_TEXT\", \"\") : \"\";\n\t\tconst error = emailInfo !== null ? BX.prop.getBoolean(emailInfo, \"STATUS_ERROR\", false) : false;\n\t\tconst className = !error ? \"crm-entity-stream-content-event-skipped\" : \"crm-entity-stream-content-event-missing\";\n\t\tif(statusText !== \"\")\n\t\t{\n\t\t\theader.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: className},\n\t\t\t\t\t\ttext: statusText\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\t\treturn header;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tmenuItems.push({id: \"view\", text: this.getMessage(\"menuView\"), onclick: BX.delegate(this.view, this)});\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\treply()\n\t{\n\t}\n\n\treplyAll()\n\t{\n\t}\n\n\tforward()\n\t{\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('emailRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-email\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-email\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(outerWrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-email\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: [ detailWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//TODO: Add status text\n\t\t/*\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-content-detail-email-read-status\" } })\n\t\t);\n\t\t*/\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-email-to\"}}\n\t\t);\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValue !== \"\")\n\t\t{\n\t\t\tif(communicationTitle !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" }));\n\t\t\t}\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-address\" },\n\t\t\t\t\t\ttext: communicationValue\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-fragment\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\twrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn outerWrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tHistoryEmail.create(\n\t\t\t\t\"email\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Email();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \".//activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class Call extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._menu = null;\n\t\tthis._isMenuShown = false;\n\t\tthis._menuItems = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn null;\n\t}\n\n\tonClick(e)\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"telephonyNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet phone = \"\";\n\t\tconst itemData = this.getItemData();\n\t\tconst phones = BX.prop.getArray(itemData, \"PHONE\", []);\n\n\t\tif(phones.length === 1)\n\t\t{\n\t\t\tthis.addCall(phones[0]['VALUE']);\n\t\t}\n\t\telse if(phones.length > 1)\n\t\t{\n\t\t\tthis.showMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\t\tif(communication)\n\t\t\t{\n\t\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"PHONE\")\n\t\t\t\t{\n\t\t\t\t\tphone = BX.prop.getString(communication, \"VALUE\");\n\t\t\t\t\tif(phone)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.addCall(phone);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tshowMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.prepareMenuItems();\n\n\t\tif(!this._menuItems || this._menuItems.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\n\t\tthis._menu = new BX.PopupMenuWindow(\n\t\t\tthis._id,\n\t\t\tthis._container,\n\t\t\tthis._menuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu.popupWindow.show();\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tprepareMenuItems()\n\t{\n\t\tif(this._menuItems)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemData = this.getItemData();\n\t\tconst phones = BX.prop.getArray(itemData, \"PHONE\", []);\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\t\tthis._menuItems = [];\n\n\t\tif(phones.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet i = 0;\n\t\tconst l = phones.length;\n\t\tfor(; i < l; i++)\n\t\t{\n\t\t\tconst value = BX.prop.getString(phones[i], \"VALUE\");\n\t\t\tconst formattedValue = BX.prop.getString(phones[i], \"VALUE_FORMATTED\");\n\t\t\tconst complexName = BX.prop.getString(phones[i], \"COMPLEX_NAME\");\n\t\t\tconst itemText = (complexName ? complexName + ': ' : '') + (formattedValue ? formattedValue : value);\n\n\t\t\tif(value !== \"\")\n\t\t\t{\n\t\t\t\tthis._menuItems.push({ id: value, text:  itemText, onclick: handler});\n\t\t\t}\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\t\tthis.addCall(item.id);\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu.popupWindow.destroy();\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._menu = null;\n\t}\n\n\taddCall(phone)\n\t{\n\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\tlet entityTypeId = parseInt(BX.prop.getString(communication, \"ENTITY_TYPE_ID\", \"0\"));\n\t\tif(isNaN(entityTypeId))\n\t\t{\n\t\t\tentityTypeId = 0;\n\t\t}\n\n\t\tlet entityId = parseInt(BX.prop.getString(communication, \"ENTITY_ID\", \"0\"));\n\t\tif(isNaN(entityId))\n\t\t{\n\t\t\tentityId = 0;\n\t\t}\n\n\t\tlet ownerTypeId = 0;\n\t\tlet ownerId = 0;\n\n\t\tconst ownerInfo = BX.prop.getObject(this._settings, \"ownerInfo\");\n\t\tif(ownerInfo)\n\t\t{\n\t\t\townerTypeId = BX.prop.getInteger(ownerInfo, \"ENTITY_TYPE_ID\", 0);\n\t\t\townerId = BX.prop.getInteger(ownerInfo, \"ENTITY_ID\", 0);\n\t\t}\n\n\t\tif(ownerTypeId <= 0 || ownerId <= 0)\n\t\t{\n\t\t\townerTypeId = BX.prop.getInteger(this._entityData, \"OWNER_TYPE_ID\", 0);\n\t\t\townerId = BX.prop.getInteger(this._entityData, \"OWNER_ID\", \"0\");\n\t\t}\n\n\t\tif(ownerTypeId <= 0 || ownerId <= 0)\n\t\t{\n\t\t\townerTypeId = entityTypeId;\n\t\t\townerId = entityId;\n\t\t}\n\n\t\tlet activityId = parseInt(BX.prop.getString(this._entityData, \"ID\", \"0\"));\n\t\tif(isNaN(activityId))\n\t\t{\n\t\t\tactivityId = 0;\n\t\t}\n\n\t\tconst params =\n\t\t\t{\n\t\t\t\t\"ENTITY_TYPE_NAME\": BX.CrmEntityType.resolveName(entityTypeId),\n\t\t\t\t\"ENTITY_ID\": entityId,\n\t\t\t\t\"AUTO_FOLD\": true\n\t\t\t};\n\t\tif(ownerTypeId !== entityTypeId || ownerId !== entityId)\n\t\t{\n\t\t\tparams[\"BINDINGS\"] = [ { \"OWNER_TYPE_NAME\": BX.CrmEntityType.resolveName(ownerTypeId), \"OWNER_ID\": ownerId } ];\n\t\t}\n\n\t\tif(activityId > 0)\n\t\t{\n\t\t\tparams[\"SRC_ACTIVITY_ID\"] = activityId;\n\t\t}\n\n\t\twindow.top['BXIM'].phoneTo(phone, params);\n\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Call.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic messages = {};\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class HistoryCall extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._button = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn this._button;\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t}\n\t\t);\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryCall();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n\nexport class ScheduleCall extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ScheduleCall();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import {HistoryCall} from \"../actions/call\";\nimport HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Call extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._playerDummyClickHandler = BX.delegate(this.onPlayerDummyClick, this);\n\t\tthis._playerWrapper = null;\n\t\tthis._transcriptWrapper = null;\n\t\tthis._mediaFileInfo = null;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst callTypeText = callInfo !== null ? BX.prop.getString(callInfo, \"CALL_TYPE_TEXT\", \"\") : \"\";\n\t\tif(callTypeText !== \"\")\n\t\t{\n\t\t\treturn callTypeText;\n\t\t}\n\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\t//Position is important\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst hasCallInfo = callInfo !== null;\n\t\tconst isSuccessfull = hasCallInfo ? BX.prop.getBoolean(callInfo, \"SUCCESSFUL\", false) : false;\n\t\tconst statusText = hasCallInfo ? BX.prop.getString(callInfo, \"STATUS_TEXT\", \"\") : \"\";\n\n\t\tif(hasCallInfo && statusText.length)\n\t\t{\n\t\t\theader.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tclassName: isSuccessfull\n\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-event-successful\"\n\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-event-missing\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: statusText\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\t\tconst communicationValueFormatted = BX.prop.getString(communication, \"FORMATTED_VALUE\", communicationValue);\n\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst hasCallInfo = callInfo !== null;\n\t\tconst durationText = hasCallInfo ? BX.prop.getString(callInfo, \"DURATION_TEXT\", \"\") : \"\";\n\t\tconst hasTranscript = hasCallInfo ? BX.prop.getBoolean(callInfo, \"HAS_TRANSCRIPT\", \"\") : \"\";\n\t\tconst isTranscriptPending = hasCallInfo ? BX.prop.getBoolean(callInfo, \"TRANSCRIPT_PENDING\", \"\") : \"\";\n\t\tconst callId = hasCallInfo ? BX.prop.getString(callInfo, \"CALL_ID\", \"\") : \"\";\n\t\tconst callComment = hasCallInfo ? BX.prop.getString(callInfo, \"COMMENT\", \"\") : \"\";\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-call\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-call\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(outerWrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareMultilineCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(hasCallInfo)\n\t\t{\n\t\t\tconst callInfoWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"}\n\t\t\t\t}\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(callInfoWrapper);\n\n\t\t\tthis._mediaFileInfo = BX.prop.getObject(entityData, \"MEDIA_FILE_INFO\", null);\n\t\t\tif(this._mediaFileInfo !== null)\n\t\t\t{\n\t\t\t\tthis._playerWrapper = this._history.getManager().renderAudioDummy(durationText, this._playerDummyClickHandler);\n\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\tthis._playerWrapper\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t\t}\n\n\t\t\tif(hasTranscript)\n\t\t\t{\n\t\t\t\tthis._transcriptWrapper = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-audio-transcript-wrap-container\"},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: function(e)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(BX.Voximplant && BX.Voximplant.Transcript)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.Voximplant.Transcript.create({\n\t\t\t\t\t\t\t\t\t\tcallId: callId\n\t\t\t\t\t\t\t\t\t}).show();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-icon\"}\t}),\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-conversation\"}, text: BX.message(\"CRM_TIMELINE_CALL_TRANSCRIPT\") } )\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._transcriptWrapper);\n\t\t\t}\n\t\t\telse if(isTranscriptPending)\n\t\t\t{\n\t\t\t\tthis._transcriptWrapper = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-audio-transcript-wrap-container-pending\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-icon-pending\"}, html: '<svg class=\"crm-transcript-loader-circular\" viewBox=\"25 25 50 50\"><circle class=\"crm-transcript-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"></circle></svg>'}),\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-conversation\"}, text: BX.message(\"CRM_TIMELINE_CALL_TRANSCRIPT_PENDING\") } )\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._transcriptWrapper);\n\t\t\t}\n\n\t\t\tif(callComment)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\t\t\ttext: callComment\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t\t}\n\t\t}\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-contact-info\"}\n\t\t\t}\n\t\t);\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValueFormatted !== \"\")\n\t\t{\n\t\t\tif(communicationTitle !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" }));\n\t\t\t}\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-address\" },\n\t\t\t\t\t\ttext: communicationValueFormatted\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\twrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn outerWrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tHistoryCall.create(\n\t\t\t\t\"call\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._history.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst messageName = (direction === BX.CrmActivityDirection.incoming) ? 'incomingCallRemove' : 'outgoingCallRemove';\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage(messageName).replace(\"#TITLE#\", title);\n\t}\n\n\tonPlayerDummyClick(e)\n\t{\n\t\tconst stubNode = this._playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif(stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._history.getManager().loadMediaPlayer(\n\t\t\t\"history_\" + this.getId(),\n\t\t\tthis._mediaFileInfo[\"URL\"],\n\t\t\tthis._mediaFileInfo[\"TYPE\"],\n\t\t\tthis._playerWrapper,\n\t\t\tthis._mediaFileInfo[\"DURATION\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Call();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Meeting extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper()\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-meeting\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-meeting\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" + communicationValue }));\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('meetingRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Meeting();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Task extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-task\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-task\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('taskRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Task();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class WebForm extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-crmForm\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-crmForm\" } })\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WebForm();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Sms extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareMessageStatusLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareMessageStatusLayout()\n\t{\n\t\treturn this._messageStatusNode = BX.create(\"SPAN\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\t\tconst smsInfo = BX.prop.getObject(entityData, \"SMS_INFO\", {});\n\n\t\tconst wrapperClassName = \"crm-entity-stream-section-sms\";\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history\" + \" \" + wrapperClassName}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-sms\" } })\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tconst messageWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-sms\"}});\n\n\t\tif (smsInfo.senderId)\n\t\t{\n\t\t\tconst senderId = smsInfo.senderId;\n\t\t\tlet senderName = smsInfo.senderShortName;\n\t\t\tif (senderId === 'rest' && smsInfo.fromName)\n\t\t\t{\n\t\t\t\tsenderName = smsInfo.fromName;\n\t\t\t}\n\n\t\t\tconst messageSenderWrapper = BX.create(\"DIV\", {\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-sms-status\"},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.message('CRM_TIMELINE_SMS_SENDER') + ' ',\n\t\t\t\t\tBX.create('STRONG', {text: senderName})\n\t\t\t\t]\n\t\t\t});\n\t\t\tif (senderId !== 'rest' && smsInfo.fromName)\n\t\t\t{\n\t\t\t\tmessageSenderWrapper.innerHTML += ' '+BX.message('CRM_TIMELINE_SMS_FROM')+' ';\n\t\t\t\tmessageSenderWrapper.appendChild(BX.create('STRONG', {text: smsInfo.fromName}));\n\t\t\t}\n\t\t\tmessageWrapper.appendChild(messageSenderWrapper);\n\t\t}\n\n\t\tif (smsInfo.statusId !== '')\n\t\t{\n\t\t\tthis.setMessageStatus(smsInfo.statusId, smsInfo.errorText);\n\t\t}\n\n\t\tconst bodyText = BX.util.htmlspecialchars(entityData['DESCRIPTION_RAW']).replace(/\\r\\n|\\r|\\n/g, \"<br/>\");\n\t\tconst messageBodyWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-sms-fragment\"}});\n\t\tmessageBodyWrapper.appendChild(BX.create('SPAN', {html: bodyText}));\n\n\t\tmessageWrapper.appendChild(messageBodyWrapper);\n\t\tdetailWrapper.appendChild(messageWrapper);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-content-detail-contact-info\"},\n\t\t\ttext: BX.message('CRM_TIMELINE_SMS_TO') + ' '\n\t\t});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" + communicationValue }));\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tsetMessageStatus(status, errorText)\n\t{\n\t\tstatus = parseInt(status);\n\t\tif (isNaN(status) || !this._messageStatusNode)\n\t\t\treturn;\n\n\t\tconst statuses = this.getSetting('smsStatusDescriptions', {});\n\t\tif (statuses.hasOwnProperty(status))\n\t\t{\n\t\t\tthis._messageStatusNode.textContent = statuses[status];\n\t\t\tthis.setMessageStatusErrorText(errorText);\n\n\t\t\tconst statusSemantic = this.getMessageStatusSemantic(status);\n\t\t\tthis.setMessageStatusSemantic(statusSemantic);\n\t\t}\n\t}\n\n\tsetMessageStatusSemantic(semantic)\n\t{\n\t\tconst classMap =\n\t\t\t{\n\t\t\t\tprocess: 'crm-entity-stream-content-event-process',\n\t\t\t\tsuccess: 'crm-entity-stream-content-event-successful',\n\t\t\t\tfailure: 'crm-entity-stream-content-event-missing'\n\t\t\t};\n\n\t\tfor (let checkSemantic in classMap)\n\t\t{\n\t\t\tconst fn = (checkSemantic === semantic) ? 'addClass' : 'removeClass';\n\t\t\tBX[fn](this._messageStatusNode, classMap[checkSemantic]);\n\t\t}\n\t}\n\n\tsetMessageStatusErrorText(errorText)\n\t{\n\t\tif (!errorText)\n\t\t{\n\t\t\tthis._messageStatusNode.removeAttribute('title');\n\t\t\tBX.removeClass(this._messageStatusNode,'crm-entity-stream-content-event-error-tip');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._messageStatusNode.setAttribute('title', errorText);\n\t\t\tBX.addClass(this._messageStatusNode,'crm-entity-stream-content-event-error-tip');\n\t\t}\n\t}\n\n\tgetMessageStatusSemantic(status)\n\t{\n\t\tconst semantics = this.getSetting('smsStatusSemantics', {});\n\t\treturn semantics.hasOwnProperty(status) ? semantics[status] : 'failure';\n\t}\n\n\tsubscribe()\n\t{\n\t\tif (!BX.CrmSmsWatcher)\n\t\t\treturn;\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst smsInfo = BX.prop.getObject(entityData, \"SMS_INFO\", {});\n\n\t\tif (smsInfo.id)\n\t\t{\n\t\t\tBX.CrmSmsWatcher.subscribeOnMessageUpdate(\n\t\t\t\tsmsInfo.id,\n\t\t\t\tthis.onMessageUpdate.bind(this)\n\t\t\t);\n\t\t}\n\t}\n\n\tonMessageUpdate(message)\n\t{\n\t\tif (message.STATUS_ID)\n\t\t{\n\t\t\tthis.setMessageStatus(message.STATUS_ID, message.EXEC_ERROR);\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Sms();\n\t\tself.initialize(id, settings);\n\t\tself.subscribe();\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Request extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\t//var entityData = this.getAssociatedEntityData();\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today crm-entity-stream-section-robot\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-robot\" } })\n\t\t);\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Request();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\nimport {OpenLine as OpenLineAction} from \"../actions/openline\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class OpenLine extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-IM\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-IM\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tconst entityDetailWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM\"}}\n\t\t);\n\t\tdetailWrapper.appendChild(entityDetailWrapper);\n\n\t\tconst messageWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM-messages\"}}\n\t\t);\n\t\tentityDetailWrapper.appendChild(messageWrapper);\n\n\t\tconst openLineData = BX.prop.getObject(this.getAssociatedEntityData(), \"OPENLINE_INFO\", null);\n\t\tif(openLineData)\n\t\t{\n\t\t\tconst messages = BX.prop.getArray(openLineData, \"MESSAGES\", []);\n\t\t\tlet i = 0;\n\t\t\tconst length = messages.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst message = messages[i];\n\t\t\t\tconst isExternal = BX.prop.getBoolean(message, \"IS_EXTERNAL\", true);\n\n\t\t\t\tmessageWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tclassName: isExternal\n\t\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-detail-IM-message-incoming\"\n\t\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-detail-IM-message-outgoing\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: BX.prop.getString(message, \"MESSAGE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tOpenLineAction.create(\n\t\t\t\t\"openline\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._history.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tview()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this.getAssociatedEntityData(), \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Rest extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['NAME'])\n\t\t{\n\t\t\treturn entityData['APP_TYPE']['NAME'];\n\t\t}\n\n\t\treturn super.getTypeDescription();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\t//var entityData = this.getAssociatedEntityData();\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today crm-entity-stream-section-rest\"}});\n\n\t\tconst iconNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-rest\"}});\n\n\t\twrapper.appendChild(iconNode);\n\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['ICON_SRC'])\n\t\t{\n\t\t\tif (iconNode)\n\t\t\t{\n\t\t\t\ticonNode.style.backgroundImage = \"url('\" +  entityData['APP_TYPE']['ICON_SRC'] + \"')\";\n\t\t\t\ticonNode.style.backgroundPosition = \"center center\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Visit extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._playerDummyClickHandler = BX.delegate(this.onPlayerDummyClick, this);\n\t\tthis._playerWrapper = null;\n\t\tthis._transcriptWrapper = null;\n\t\tthis._mediaFileInfo = null;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst visitInfo = BX.prop.getObject(entityData, \"VISIT_INFO\", {});\n\t\tconst recordLength = BX.prop.getInteger(visitInfo, \"RECORD_LENGTH\", 0);\n\t\tconst recordLengthFormatted = BX.prop.getString(visitInfo, \"RECORD_LENGTH_FORMATTED_FULL\", \"\");\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: (recordLength > 0 ? recordLengthFormatted + ', ' + BX.message('CRM_TIMELINE_VISIT_AT') + ' ' : '') + this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst visitInfo = BX.prop.getObject(entityData, \"VISIT_INFO\", {});\n\t\tconst recordLength = BX.prop.getInteger(visitInfo, \"RECORD_LENGTH\", 0);\n\t\tconst recordLengthFormatted = BX.prop.getString(visitInfo, \"RECORD_LENGTH_FORMATTED_SHORT\", \"\");\n\t\tconst vkProfile = BX.prop.getString(visitInfo, \"VK_PROFILE\", \"\");\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-visit\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-visit\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail crm-entity-stream-content-detail-call-inline\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(detailWrapper);\n\n\t\tthis._mediaFileInfo = BX.prop.getObject(entityData, \"MEDIA_FILE_INFO\", null);\n\t\tif(this._mediaFileInfo !== null && recordLength > 0)\n\t\t{\n\t\t\tthis._playerWrapper = this._history.getManager().renderAudioDummy(recordLengthFormatted, this._playerDummyClickHandler);\n\t\t\tdetailWrapper.appendChild(\n\t\t\t\t//crm-entity-stream-content-detail-call\n\t\t\t\tthis._playerWrapper\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t}\n\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-contact-info\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(document.createTextNode(BX.message(\"CRM_TIMELINE_VISIT_WITH\") + ' '));\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(BX.type.isNotEmptyString(vkProfile))\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(document.createTextNode(\" \"));\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"a\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-additional\",\n\t\t\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\t\t\thref: this.getVkProfileUrl(vkProfile)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: BX.message('CRM_TIMELINE_VISIT_VKONTAKTE_PROFILE')\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t)\n\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn outerWrapper;\n\t}\n\n\tonPlayerDummyClick(e)\n\t{\n\t\tconst stubNode = this._playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif(stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._history.getManager().loadMediaPlayer(\n\t\t\t\"history_\" + this.getId(),\n\t\t\tthis._mediaFileInfo[\"URL\"],\n\t\t\tthis._mediaFileInfo[\"TYPE\"],\n\t\t\tthis._playerWrapper,\n\t\t\tthis._mediaFileInfo[\"DURATION\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\tgetVkProfileUrl(profile)\n\t{\n\t\treturn 'https://vk.com/' + BX.util.htmlspecialchars(profile);\n\t}\n\n\tview()\n\t{\n\t\tif (BX.getClass('BX.Crm.Restriction.Bitrix24') && BX.Crm.Restriction.Bitrix24.isRestricted('visit'))\n\t\t{\n\t\t\treturn BX.Crm.Restriction.Bitrix24.getHandler('visit').call();\n\t\t}\n\t\tsuper.view();\n\t}\n\n\tedit()\n\t{\n\t\tif (BX.getClass('BX.Crm.Restriction.Bitrix24') && BX.Crm.Restriction.Bitrix24.isRestricted('visit'))\n\t\t{\n\t\t\treturn BX.Crm.Restriction.Bitrix24.getHandler('visit').call();\n\t\t}\n\t\tsuper.edit();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Visit();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Zoom extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._videoDummy = null;\n\t\tthis._audioDummy = null;\n\t\tthis._videoPlayer = null;\n\t\tthis._audioPlayer = null;\n\t\tthis._audioLengthElement = null;\n\t\tthis._recordings = [];\n\t\tthis._currentRecordingIndex = 0;\n\t\tthis.zoomActivitySubject = null;\n\n\t\tthis._downloadWrapper = null;\n\t\tthis._downloadSubject = null;\n\t\tthis._downloadSubjectDetail = null;\n\t\tthis._downloadVideoLink = null;\n\t\tthis._downloadSeparator = null;\n\t\tthis._downloadAudioLink = null;\n\t\tthis._playVideoLink = null;\n\t\tthis.detailZoomCopyVideoLink = null;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tif (!this._data.hasOwnProperty('PROVIDER_DATA') || this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] !== 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\theader.appendChild(this.prepareSuccessfulLayout());\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareSuccessfulLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-successful\"},\n\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_SUCCESSFUL_ACTIVITY')\n\t\t});\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tif (this._data.hasOwnProperty('PROVIDER_DATA') && this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] === 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\treturn BX.create(\"SPAN\", {\n\t\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_JOINED_CONFERENCE')\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.create(\"SPAN\", {\n\t\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_CONFERENCE_END')\n\t\t\t});\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history\"}});\n\t\tlet entityDetailWrapper;\n\t\tconst zoomData = BX.prop.getObject(this.getAssociatedEntityData(), \"ZOOM_INFO\", null);\n\t\tconst subject = BX.prop.getString(this.getAssociatedEntityData(), \"SUBJECT\", null);\n\n\t\tthis._recordings = BX.prop.getArray(zoomData, \"RECORDINGS\", []);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-zoom\" } })\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tif (this._data.hasOwnProperty('PROVIDER_DATA') && this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] === 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\tentityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: zoomData['CONF_URL']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tentityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (this._recordings.length > 0)\n\t\t\t{\n\t\t\t\tif (this._recordings.length > 1)\n\t\t\t\t{\n\t\t\t\t\t//render video parts header\n\n\t\t\t\t\tconst tabs = this._recordings.map(function (recording, index) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: index,\n\t\t\t\t\t\t\ttitle: BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD_PART\").replace(\"#NUMBER#\", index + 1),\n\t\t\t\t\t\t\ttime: recording[\"AUDIO\"] ? recording[\"AUDIO\"][\"LENGTH_FORMATTED\"] : \"\",\n\t\t\t\t\t\t\tactive: index === 0\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tconst tabsComponent = new Zoom.TabsComponent({\n\t\t\t\t\t\ttabs: tabs,\n\t\t\t\t\t});\n\t\t\t\t\ttabsComponent.eventEmitter.subscribe(\"onTabChange\", this._onTabChange.bind(this));\n\t\t\t\t\tdetailWrapper.appendChild(tabsComponent.render());\n\t\t\t\t}\n\n\t\t\t\tthis._videoDummy = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-detail-zoom-video-wrap\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-detail-zoom-video\" },\n\t\t\t\t\t\t\t\t\tevents:\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tclick: this._onVideoDummyClick.bind(this)\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-inner\"},\n\t\t\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-btn\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\tdataset: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thint: BX.message(\"CRM_TIMELINE_ZOOM_LOGIN_REQUIRED\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'hintNoIcon': 'Y'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-text\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_CLICK_TO_WATCH\")\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\n\t\t\t\tBX.UI.Hint.init(this._videoDummy);\n\n\t\t\t\tthis._audioDummy = this._history.getManager().renderAudioDummy(\"00:15\", this._onAudioDummyClick.bind(this));\n\t\t\t\tthis._audioLengthElement = this._audioDummy.querySelector('.crm-audio-cap-time');\n\n\t\t\t\tif (zoomData['RECORDINGS'][0]['VIDEO'])\n\t\t\t\t{\n\t\t\t\t\t//video download link with token valid for 24h\n\t\t\t\t\tconst videoLinkExpireTS = (zoomData['RECORDINGS'][0]['VIDEO']['END_DATE_TS'] * 1000) + (60 * 60 * 23 * 1000);\n\t\t\t\t\tif (videoLinkExpireTS < Date.now())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst videoLinkContainer = BX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-zoom-desc\",\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis._playVideoLink = BX.create(\"DIV\", {\n\t\t\t\t\t\t\thtml: BX.message(\"CRM_TIMELINE_ZOOM_PLAY_LINK_VIDEO\"),\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis._detailZoomCopyVideoLink = BX.create(\"A\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\tclassName: 'ui-link ui-link-dashed',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_COPY_PASSWORD\")\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tvideoLinkContainer.appendChild(this._playVideoLink);\n\t\t\t\t\t\tvideoLinkContainer.appendChild(this._detailZoomCopyVideoLink);\n\t\t\t\t\t\tentityDetailWrapper.appendChild(videoLinkContainer);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tentityDetailWrapper.appendChild(this._videoDummy);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (zoomData['RECORDINGS'][0]['AUDIO'])\n\t\t\t\t{\n\t\t\t\t\tconst zoomAudioDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"},\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tzoomAudioDetailWrapper.appendChild(this._audioDummy);\n\t\t\t\t\tzoomAudioDetailWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t\t\t\tentityDetailWrapper.appendChild(zoomAudioDetailWrapper);\n\t\t\t\t}\n\n\t\t\t\tthis._downloadWrapper = BX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc\"},\n\t\t\t\t});\n\n\t\t\t\tentityDetailWrapper.appendChild(this._downloadWrapper);\n\n\t\t\t\tthis._downloadSubject = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-subject\"},\n\t\t\t\t});\n\t\t\t\tthis._downloadSubjectDetail = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-detail\"},\n\t\t\t\t});\n\t\t\t\tthis._downloadVideoLink = BX.create(\"A\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-link\"},\n\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_DOWNLOAD_VIDEO\")\n\t\t\t\t});\n\t\t\t\tthis._downloadSeparator = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-separate\"},\n\t\t\t\t\thtml: \"&mdash;\"\n\t\t\t\t});\n\t\t\t\tthis._downloadAudioLink = BX.create(\"A\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-link\"},\n\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_DOWNLOAD_AUDIO\")\n\t\t\t\t});\n\t\t\t\tthis.setCurrentRecording(0);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.zoomActivitySubject = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\t\ttext: subject\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tentityDetailWrapper.appendChild(this.zoomActivitySubject);\n\n\t\t\t\tif (zoomData['HAS_RECORDING'] === 'Y')\n\t\t\t\t{\n\t\t\t\t\tentityDetailWrapper.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-inner\"},\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-img\"},\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-text\"},\n\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD_IN_PROCESS\")\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/*else\n\t\t{\n\t\t\tdetailWrapper.appendChild(BX.create(\"span\", {text: \"456\"}));\n\n\t\t\tvar entityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: BX.prop.getString(zoomData, \"CONF_URL\", \"\")\n\t\t\t\t}\n\t\t\t);\n\t\t}*/\n\t\t//Content //todo\n\n\n\t\tif(entityDetailWrapper)\n\t\t{\n\t\t\tdetailWrapper.appendChild(entityDetailWrapper);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\t_onVideoDummyClick()\n\t{\n\t\tBX.UI.Hint.hide();\n\t\tconst recording = this._recordings[this._currentRecordingIndex][\"VIDEO\"];\n\t\tif(!recording)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._videoPlayer = this._history.getManager().loadMediaPlayer(\n\t\t\t\"zoom_video_\" + this.getId(),\n\t\t\trecording[\"DOWNLOAD_URL\"],\n\t\t\t\"video/mp4\",\n\t\t\tthis._videoDummy,\n\t\t\trecording[\"LENGTH\"],\n\t\t\t{\n\t\t\t\tvideo: true,\n\t\t\t\tskin: \"\",\n\t\t\t\twidth: 480,\n\t\t\t\theight: 270\n\t\t\t}\n\t\t);\n\t}\n\n\t_onAudioDummyClick()\n\t{\n\t\tconst recording = this._recordings[this._currentRecordingIndex][\"AUDIO\"];\n\t\tif(!recording)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._audioPlayer = this._history.getManager().loadMediaPlayer(\n\t\t\t\"zoom_audio_\" + this.getId(),\n\t\t\trecording[\"DOWNLOAD_URL\"],\n\t\t\t\"audio/mp4\",\n\t\t\tthis._audioDummy,\n\t\t\trecording[\"LENGTH\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\t_onTabChange(event)\n\t{\n\t\tthis.setCurrentRecording(event.data.tabId);\n\t}\n\n\tsetCurrentRecording(recordingIndex)\n\t{\n\t\tthis._currentRecordingIndex = recordingIndex;\n\t\tconst videoRecording = this._recordings[this._currentRecordingIndex][\"VIDEO\"];\n\t\tconst audioRecording = this._recordings[this._currentRecordingIndex][\"AUDIO\"];\n\n\t\tif(videoRecording)\n\t\t{\n\t\t\tthis._videoDummy.hidden = false;\n\t\t\tif(this._videoPlayer)\n\t\t\t{\n\t\t\t\tthis._videoPlayer.pause();\n\t\t\t\tthis._videoPlayer.setSource(videoRecording[\"DOWNLOAD_URL\"]);\n\t\t\t\tthis._downloadVideoLink.href = videoRecording[\"DOWNLOAD_URL\"];\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._videoDummy.hidden = true;\n\t\t}\n\n\t\tif(audioRecording)\n\t\t{\n\t\t\tthis._audioDummy.hidden = false;\n\t\t\tif(this._audioPlayer)\n\t\t\t{\n\t\t\t\tthis._audioPlayer.pause();\n\t\t\t\tthis._audioPlayer.setSource(audioRecording[\"DOWNLOAD_URL\"]);\n\t\t\t}\n\t\t\tthis._downloadAudioLink.href = audioRecording[\"DOWNLOAD_URL\"];\n\t\t\tthis._audioLengthElement.innerText = audioRecording[\"LENGTH_FORMATTED\"];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._audioDummy.hidden = true;\n\t\t}\n\n\t\tBX.clean(this._downloadWrapper);\n\t\tif(audioRecording || videoRecording)\n\t\t{\n\t\t\tconst lengthHuman = audioRecording ? audioRecording[\"LENGTH_HUMAN\"] : videoRecording[\"LENGTH_HUMAN\"];\n\t\t\tthis._downloadWrapper.appendChild(this._downloadSubject);\n\t\t\tthis._downloadSubject.innerHTML = BX.util.htmlspecialchars(BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD\").replace(\"#DURATION#\", lengthHuman)) + \" &mdash; \"\n\t\t\tthis._downloadWrapper.appendChild(this._downloadSubjectDetail);\n\t\t}\n\t\tif (videoRecording)\n\t\t{\n\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadVideoLink);\n\t\t\tthis._downloadVideoLink.href = videoRecording['DOWNLOAD_URL'];\n\t\t\tif (audioRecording)\n\t\t\t{\n\t\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadSeparator);\n\t\t\t}\n\n\t\t\tif (this._playVideoLink)\n\t\t\t{\n\t\t\t\tthis._playVideoLink.lastElementChild.href = videoRecording[\"PLAY_URL\"];\n\t\t\t\tthis._downloadVideoLink.href = videoRecording[\"PLAY_URL\"];\n\t\t\t}\n\t\t\tif (this._detailZoomCopyVideoLink)\n\t\t\t{\n\t\t\t\tBX.clipboard.bindCopyClick(this._detailZoomCopyVideoLink, {\n\t\t\t\t\ttext: videoRecording['PASSWORD'],\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (audioRecording)\n\t\t{\n\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadAudioLink);\n\t\t\tthis._downloadAudioLink.href = audioRecording['DOWNLOAD_URL'];\n\t\t}\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Zoom();\n\t\tself.initialize(id, settings);\n\n\t\t//todo: remove debug\n\t\tif(!window['zoom'])\n\t\t{\n\t\t\twindow['zoom'] = [];\n\t\t}\n\t\twindow['zoom'].push(self);\n\t\treturn self;\n\t}\n}\n\nZoom.TabsComponent = class\n{\n\tconstructor(config)\n\t{\n\t\tthis.tabs = BX.prop.getArray(config, \"tabs\", []);\n\t\tthis.elements = {\n\t\t\tcontainer: null,\n\t\t\ttabs: {}\n\t\t};\n\t\tthis.eventEmitter = new BX.Event.EventEmitter(this, 'Zoom.TabsComponent');\n\t}\n\n\trender()\n\t{\n\t\tif(this.elements.container)\n\t\t{\n\t\t\treturn this.elements.container;\n\t\t}\n\n\t\tthis.elements.container = BX.create(\"DIV\", {\n\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-wrapper\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-list\"},\n\t\t\t\t\tchildren: this.tabs.map(this._renderTab, this)\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t\treturn this.elements.container;\n\t}\n\n\t_renderTab(tabDescription)\n\t{\n\t\tconst tabId = tabDescription.id;\n\t\tthis.elements.tabs[tabId] = BX.create(\"DIV\", {\n\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section\" + (tabDescription.active ? \" crm-entity-stream-content-detail-zoom-section-active\": \"\")},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-inner\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-title\"},\n\t\t\t\t\t\t\ttext: tabDescription.title\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-time\"},\n\t\t\t\t\t\t\ttext: tabDescription.time\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tclick: function()\n\t\t\t\t{\n\t\t\t\t\tthis.setActiveTab(tabDescription.id)\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\t\treturn this.elements.tabs[tabId];\n\t}\n\n\tsetActiveTab(tabId)\n\t{\n\t\tif(!this.elements.tabs[tabId])\n\t\t{\n\t\t\tthrow new Error (\"Tab \" + tabId + \" is not found\");\n\t\t}\n\t\tfor (let id in this.elements.tabs)\n\t\t{\n\t\t\tif(!this.elements.tabs.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tid = Number.parseInt(id, 10);\n\t\t\tif (id === tabId)\n\t\t\t{\n\t\t\t\tthis.elements.tabs[id].classList.add(\"crm-entity-stream-content-detail-zoom-section-active\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.elements.tabs[id].classList.remove(\"crm-entity-stream-content-detail-zoom-section-active\");\n\t\t\t}\n\t\t}\n\t\tthis.eventEmitter.emit(\"onTabChange\", {\n\t\t\ttabId: tabId\n\t\t});\n\t}\n};\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class OrderCreation extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"OrderCreation. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\tlet msg = this.getMessage(BX.CrmEntityType.resolveName(this.getAssociatedEntityTypeId()).toLowerCase());\n\t\tif(!BX.type.isNotEmptyString(msg))\n\t\t{\n\t\t\tmsg = this.getTextDataParam(\"TITLE\");\n\t\t}\n\n\t\treturn msg;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createOrderEntity\";\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tlet statusMessage = '';\n\t\tlet statusClass = '';\n\t\tconst fields = this.getObjectDataParam('FIELDS');\n\n\t\tif (BX.prop.get(fields, 'DONE') === 'Y')\n\t\t{\n\t\t\tstatusMessage = this.getMessage(\"done\");\n\t\t\tstatusClass = \"crm-entity-stream-content-event-done\";\n\t\t}\n\t\telse if (BX.prop.get(fields, 'CANCELED') === 'Y')\n\t\t{\n\t\t\tstatusMessage = this.getMessage(\"canceled\");\n\t\t\tstatusClass = \"crm-entity-stream-content-event-canceled\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (BX.prop.get(fields, 'PAID') === 'Y')\n\t\t\t{\n\t\t\t\tstatusMessage = this.getMessage(\"paid\");\n\t\t\t\tstatusClass = \"crm-entity-stream-content-event-paid\";\n\t\t\t}\n\t\t\telse if (BX.prop.get(fields, 'PAID') === 'N')\n\t\t\t{\n\t\t\t\tstatusMessage = this.getMessage(\"unpaid\");\n\t\t\t\tstatusClass = \"crm-entity-stream-content-event-not-paid\";\n\t\t\t}\n\t\t}\n\n\t\treturn [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\tevents: { click: this._headerClickHandler },\n\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t}\n\t\t\t),\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: statusClass },\n\t\t\t\t\ttext: statusMessage\n\t\t\t\t}\n\t\t\t),\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tlet title = BX.util.htmlspecialchars(BX.prop.getString(entityData, \"TITLE\", \"\"));\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\", \"\");\n\t\tif(legend !== \"\")\n\t\t{\n\t\t\ttitle += \" \" + legend;\n\t\t}\n\t\tconst nodes = [];\n\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tif(showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\thtml: title\n\t\t\t\t}));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\thtml: title\n\t\t\t\t}));\n\t\t\t\tnodes.push(BX.create(\"A\", { attrs: { href: showUrl }, text: this.getMessage('urlOrderLink') }));\n\t\t\t}\n\t\t}\n\t\treturn nodes;\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-store\";\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history\";\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: this.getIconClassName() } }));\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-content\" }, children: [ contentWrapper ] }\n\t\t\t)\n\t\t);\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(header);\n\n\t\tcontentWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: this.prepareContentDetails()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OrderCreation.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OrderCreation();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class OrderModification extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OrderModification.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tgetStatusInfo()\n\t{\n\t\tconst statusInfo = {};\n\t\tlet value = null;\n\t\tlet classCode = null;\n\t\tconst fieldName = this.getTextDataParam(\"CHANGED_ENTITY\");\n\t\tconst fields = this.getObjectDataParam('FIELDS');\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tif (fieldName === BX.CrmEntityType.names.order)\n\t\t{\n\t\t\tif (BX.prop.get(fields, 'ORDER_CANCELED') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"canceled\";\n\t\t\t\tclassCode  = \"not-paid\";\n\t\t\t}\n\t\t\telse if (BX.prop.get(fields, 'ORDER_DONE') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"done\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"VIEWED\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"viewed\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"SENT\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"sent\";\n\t\t\t\tclassCode  = \"sent\";\n\t\t\t}\n\t\t}\n\t\tif (fieldName === BX.CrmEntityType.names.orderpayment)\n\t\t{\n\t\t\tconst psStatusCode = BX.prop.get(fields, 'STATUS_CODE', false);\n\t\t\tif (psStatusCode)\n\t\t\t{\n\t\t\t\tif (psStatusCode === 'ERROR')\n\t\t\t\t{\n\t\t\t\t\tvalue = \"orderPaymentError\";\n\t\t\t\t\tclassCode = \"payment-error\";\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"VIEWED\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"viewed\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"SENT\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"sent\";\n\t\t\t\tclassCode  = \"sent\";\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvalue = BX.prop.get(fields, 'ORDER_PAID') === 'Y' ? \"paid\" : \"unpaid\";\n\t\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_PAID') === 'Y' ? \"paid\" : \"not-paid\";\n\t\t\t}\n\t\t}\n\t\telse if (fieldName === BX.CrmEntityType.names.ordershipment && BX.prop.get(fields, 'ORDER_DEDUCTED', false))\n\t\t{\n\t\t\tvalue = BX.prop.get(fields, 'ORDER_DEDUCTED') === 'Y' ? \"deducted\" : \"unshipped\";\n\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_DEDUCTED') === 'Y' ? \"shipped\" : \"not-shipped\";\n\t\t}\n\t\telse if (fieldName === BX.CrmEntityType.names.ordershipment && BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY', false))\n\t\t{\n\t\t\tvalue = BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY') === 'Y' ? \"allowedDelivery\" : \"disallowedDelivery\";\n\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY') === 'Y' ? \"allowed-delivery\" : \"disallowed-delivery\";\n\t\t}\n\n\t\tif (value)\n\t\t{\n\t\t\tstatusInfo.className = \"crm-entity-stream-content-event-\" + classCode;\n\t\t\tstatusInfo.message = this.getMessage(value);\n\t\t}\n\n\t\treturn statusInfo;\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tconst children = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\tconst statusInfo = this.getStatusInfo();\n\t\tif (BX.type.isNotEmptyObject(statusInfo))\n\t\t{\n\t\t\tchildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: statusInfo.className },\n\t\t\t\t\t\ttext: statusInfo.message\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t}\n\t\tchildren.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t));\n\t\treturn children;\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst htmlTitle = BX.prop.getString(entityData, \"HTML_TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tconst nodes = [];\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-description\"}});\n\n\t\t\tif(showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: title + \" \" + htmlTitle}));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (htmlTitle === \"\")\n\t\t\t\t{\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"A\", {attrs: {href: showUrl}, text: title}));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: title + \" \"}));\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"A\", {attrs: {href: showUrl}, text: htmlTitle}));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\n\t\t\tconst sublegend = BX.prop.getString(entityData, \"SUBLEGEND\", '');\n\t\t\tif (sublegend !== '')\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"BR\"));\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: \" \" + sublegend}));\n\t\t\t}\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareViewedContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tconst nodes = [];\n\n\t\tif (title !== \"\")\n\t\t{\n\t\t\tconst sublegend = BX.prop.getString(entityData, \"SUBLEGEND\", '');\n\t\t\tif (sublegend !== \"\")\n\t\t\t{\n\t\t\t\tconst descriptionNode = BX.create(\"DIV\", {\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\t\ttext: sublegend,\n\t\t\t\t});\n\t\t\t\tnodes.push(descriptionNode);\n\t\t\t}\n\n\n\t\t\tif(entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId())\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"A\", { attrs: { href: showUrl }, text: title }));\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareSentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst showUrl = BX.prop.getString(entityData, 'SHOW_URL', '');\n\t\tconst destination = BX.prop.getString(entityData, 'DESTINATION_TITLE', '');\n\t\tconst nodes = [];\n\n\t\tif (title !== \"\")\n\t\t{\n\t\t\tconst detailNode = BX.create('DIV', {attrs: {className: 'crm-entity-stream-content-detail-description'}});\n\t\t\tif(showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create('A', { attrs: { href: showUrl }, text: title }));\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\n\t\t\tif (destination)\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create('SPAN', {\n\t\t\t\t\tattrs: { className: 'crm-entity-stream-content-detail-order-destination' },\n\t\t\t\t\ttext: destination,\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tnodes.push(detailNode);\n\n\t\t\tconst sliderLinkNode = BX.create('A', {\n\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\ttext: this.getMessage('orderPaymentProcess'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: BX.proxy(this.startSalescenterApplication, this),\n\t\t\t\t},\n\t\t\t});\n\t\t\tnodes.push(sliderLinkNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tstartSalescenterApplication()\n\t{\n\t\tBX.loadExt('salescenter.manager').then(function()\n\t\t{\n\t\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\t\townerTypeId = BX.prop.get(fields, 'OWNER_TYPE_ID', BX.CrmEntityType.enumeration.deal);\n\t\t\tlet ownerId = BX.prop.get(fields, 'OWNER_ID', 0);\n\t\t\tconst paymentId = BX.prop.get(fields, 'PAYMENT_ID', 0),\n\t\t\t\tshipmentId = BX.prop.get(fields, 'SHIPMENT_ID', 0),\n\t\t\t\torderId = BX.prop.get(fields, 'ORDER_ID', 0)\n\t\t\t;\n\n\t\t\t// compatibility\n\t\t\tif (!ownerId)\n\t\t\t{\n\t\t\t\townerId = BX.prop.get(fields, 'DEAL_ID', 0);\n\t\t\t}\n\n\t\t\tBX.Salescenter.Manager.openApplication({\n\t\t\t\tdisableSendButton: '',\n\t\t\t\tcontext: 'deal',\n\t\t\t\townerTypeId: ownerTypeId,\n\t\t\t\townerId: ownerId,\n\t\t\t\tmode: ownerTypeId === BX.CrmEntityType.enumeration.deal ? 'payment_delivery' : 'payment',\n\t\t\t\ttemplateMode: 'view',\n\t\t\t\torderId: orderId,\n\t\t\t\tpaymentId: paymentId,\n\t\t\t\tshipmentId: shipmentId,\n\t\t\t});\n\t\t}.bind(this));\n\t}\n\n\tpreparePaidPaymentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData(),\n\t\t\ttitle = BX.prop.getString(entityData, \"TITLE\"),\n\t\t\tdate = BX.prop.getString(entityData, \"DATE\", \"\"),\n\t\t\tpaySystemName = BX.prop.getString(entityData, \"PAY_SYSTEM_NAME\", \"\"),\n\t\t\tsum = BX.prop.getString(entityData, 'SUM', ''),\n\t\t\tcurrency = BX.prop.getString(entityData, 'CURRENCY', ''),\n\t\t\tnodes = [];\n\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tconst paymentDetail = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-payment\"}});\n\t\t\tpaymentDetail.appendChild(\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-value\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-text\"},\n\t\t\t\t\t\t\thtml: sum,\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-currency\"},\n\t\t\t\t\t\t\thtml: currency,\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tconst logotip = BX.prop.getString(entityData, \"LOGOTIP\", null);\n\t\t\tif (logotip)\n\t\t\t{\n\t\t\t\tpaymentDetail.appendChild(\n\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-logo\"},\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tbackgroundImage: \"url(\" + encodeURI(logotip) + \")\",\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\tnodes.push(paymentDetail);\n\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\ttext: date\n\t\t\t\t\t}),\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description-info\"},\n\t\t\t\t\t\ttext: this.getMessage('orderPaySystemTitle')\n\t\t\t\t\t}),\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\ttext: paySystemName\n\t\t\t\t\t}),\n\t\t\t\t]\n\t\t\t});\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\tisPaid = BX.prop.get(fields, 'ORDER_PAID') === 'Y',\n\t\t\tisClick = BX.prop.get(fields, 'PAY_SYSTEM_CLICK') === 'Y',\n\t\t\tisManualContinuePay = BX.prop.get(fields, 'MANUAL_CONTINUE_PAY') === 'Y',\n\t\t\tisManualAddCheck = BX.prop.get(fields, 'NEED_MANUAL_ADD_CHECK') === 'Y',\n\t\t\tentityId = this.getAssociatedEntityTypeId();\n\n\t\tif (entityId === BX.CrmEntityType.enumeration.orderpayment && isPaid)\n\t\t{\n\t\t\treturn this.preparePaidPaymentContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.orderpayment && isClick)\n\t\t{\n\t\t\treturn this.prepareClickedPaymentContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.order && isManualContinuePay)\n\t\t{\n\t\t\treturn this.prepareManualContinuePayContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.orderpayment && isManualAddCheck)\n\t\t{\n\t\t\treturn this.prepareManualAddCheck();\n\t\t}\n\n\t\treturn this.prepareItemOrderContent();\n\t}\n\n\tprepareItemOrderContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst isViewed = BX.prop.getString(entityData, \"VIEWED\", '') === 'Y';\n\t\tconst isSent = BX.prop.getString(entityData, \"SENT\", '') === 'Y';\n\t\tconst fields = this.getObjectDataParam('FIELDS');\n\t\tconst psStatusCode = BX.prop.get(fields, 'STATUS_CODE', false);\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t});\n\n\t\tlet contentChildren = null;\n\t\tif (isViewed)\n\t\t{\n\t\t\tcontentChildren = this.prepareViewedContentDetails();\n\t\t}\n\t\telse if (isSent)\n\t\t{\n\t\t\tcontentChildren = this.prepareSentContentDetails();\n\t\t}\n\t\telse if (psStatusCode === 'ERROR')\n\t\t{\n\t\t\tcontentChildren = this.prepareErrorPaymentContentDetails();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontentChildren = this.prepareContentDetails();\n\t\t}\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tpreparePaidPaymentContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-wallet' } })\n\t\t);\n\n\t\tconst header = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\ttext: this.getMessage('orderPaymentSuccessTitle')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\theader.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst headerWrap = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\tchildren: header\n\t\t});\n\n\t\tconst contentChildren = this.preparePaidPaymentContentDetails();\n\t\tcontent.appendChild(headerWrap);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareErrorPaymentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData(),\n\t\t\tdate = BX.prop.getString(entityData, 'DATE', ''),\n\t\t\tfields = this.getObjectDataParam('FIELDS'),\n\t\t\tpaySystemName = BX.prop.getString(fields, 'PAY_SYSTEM_NAME', ''),\n\t\t\tpaySystemError = BX.prop.getString(fields, 'STATUS_DESCRIPTION', ''),\n\t\t\tnodes = [];\n\n\t\tconst descriptionNode = BX.create('DIV', {\n\t\t\tattrs: {className: 'crm-entity-stream-content-detail-description'},\n\t\t\tchildren: [\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\ttext: date\n\t\t\t\t}),\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: {className: 'crm-entity-stream-content-detail-description-info'},\n\t\t\t\t\ttext: this.getMessage('orderPaySystemTitle')\n\t\t\t\t}),\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\ttext: paySystemName\n\t\t\t\t}),\n\t\t\t]\n\t\t});\n\t\tnodes.push(descriptionNode);\n\n\t\tconst errorDetailNode = BX.create('DIV', {\n\t\t\tattrs: {className: 'crm-entity-stream-content-event-payment-initiate-pay-error'},\n\t\t\ttext: this.getMessage('orderPaymentStatusErrorReason').replace(\"#PAYSYSTEM_ERROR#\", paySystemError),\n\t\t});\n\n\t\tnodes.push(errorDetailNode);\n\n\t\treturn nodes;\n\t}\n\n\tprepareClickedPaymentContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst header = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\theader.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst headerWrap = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\tchildren: header\n\t\t});\n\n\t\tconst contentChildren = this.prepareClickedPaymentContentDetails();\n\t\tcontent.appendChild(headerWrap);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareClickedPaymentContentDetails()\n\t{\n\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\tpaySystemName = BX.prop.getString(fields, 'PAY_SYSTEM_NAME', ''),\n\t\t\tnodes = [];\n\n\t\tif(paySystemName !== '')\n\t\t{\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-description\"}});\n\t\t\tdescriptionNode.appendChild(\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-clicked-description-info\" },\n\t\t\t\t\ttext: this.getMessage('orderPaymentPaySystemClick')\n\t\t\t\t})\n\t\t\t);\n\t\t\tdescriptionNode.appendChild(\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-clicked-description-name\" },\n\t\t\t\t\ttext: paySystemName\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareManualContinuePayContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-advice'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-advice' } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-advice-info\"},\n\t\t\ttext: this.getMessage('orderManualContinuePay'),\n\t\t});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-advice-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareManualAddCheck()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'crm-entity-stream-section crm-entity-stream-section-advice'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-advice'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst htmlTitle = this.getMessage('orderManualAddCheck').replace(\"#HREF#\", showUrl);\n\t\tconst content = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"crm-entity-stream-advice-info\",\n\t\t\t\t},\n\t\t\t\thtml: htmlTitle,\n\t\t\t}\n\t\t);\n\n\t\tconst link = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"crm-entity-stream-advice-info\",\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\t\thref: \"#\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: BX.delegate(function (e) {\n\t\t\t\t\t\t\t\t\ttop.BX.Helper.show('redirect=detail&code=13742126');\n\t\t\t\t\t\t\t\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: this.getMessage('orderManualAddCheckHelpLink'),\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"crm-entity-stream-advice-content\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [ content, link ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-icon-store';\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OrderModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import OrderCreation from \"./order-creation\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class StoreDocumentCreation extends OrderCreation\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"StoreDocumentCreation. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\tif (docType === 'A')\n\t\t{\n\t\t\treturn this.getMessage('arrivalDocument');\n\t\t}\n\t\tif (docType === 'S')\n\t\t{\n\t\t\treturn this.getMessage('storeAdjustmentDocument');\n\t\t}\n\t\tif (docType === 'M')\n\t\t{\n\t\t\treturn this.getMessage('movingDocument');\n\t\t}\n\t\tif (docType === 'D')\n\t\t{\n\t\t\treturn this.getMessage('deductDocument');\n\t\t}\n\t\tif (docType === 'W')\n\t\t{\n\t\t\treturn this.getMessage('shipmentDocument');\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createStoreDocumentEntity\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\", \"\");\n\t\tconst nodes = [];\n\n\t\tif(title === '')\n\t\t{\n\t\t\treturn nodes;\n\t\t}\n\n\t\tconst titleNode = BX.create('span', {text: title});\n\t\tconst nodeText = title;\n\n\t\tconst titleTemplate = BX.prop.getString(this._data, 'TITLE_TEMPLATE', '');\n\t\tif (titleTemplate)\n\t\t{\n\t\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\t\tif (docType === 'W')\n\t\t\t{\n\t\t\t\tif (this.getOwnerTypeId() === BX.CrmEntityType.enumeration.deal)\n\t\t\t\t{\n\t\t\t\t\tconst documentDetailUrl = BX.prop.getString(this._data, 'DETAIL_LINK', '');\n\t\t\t\t\tconst documentLinkTag = '<a href=\"' + documentDetailUrl + '\">' + title + '</a>';\n\t\t\t\t\ttitleNode.innerHTML = titleTemplate.replace('#TITLE#', documentLinkTag);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitleNode.innerHTML = titleTemplate.replace('#TITLE#', title);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttitleNode.innerHTML = titleTemplate.replace('#TITLE#', title);\n\t\t\t}\n\t\t}\n\n\t\tnodes.push(BX.create(\"DIV\", {\n\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\tchildren: [titleNode],\n\t\t}));\n\n\t\treturn nodes;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = StoreDocumentCreation.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new StoreDocumentCreation();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Modification from \"./modification\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class StoreDocumentModification extends Modification\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"StoreDocumentModification. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst error = this.getTextDataParam(\"ERROR\");\n\t\tif (error === 'CONDUCT')\n\t\t{\n\t\t\treturn this.getMessage('conductError');\n\t\t}\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst field = this.getTextDataParam(\"FIELD\");\n\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\tif (docType === 'A')\n\t\t{\n\t\t\tif (field === 'STATUS')\n\t\t\t{\n\t\t\t\treturn this.getMessage('arrivalDocument');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.getMessage('arrivalModification');\n\t\t\t}\n\t\t}\n\t\tif (docType === 'S')\n\t\t{\n\t\t\tif (field === 'STATUS')\n\t\t\t{\n\t\t\t\treturn this.getMessage('storeAdjustmentDocument');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.getMessage('storeAdjustmentModification');\n\t\t\t}\n\t\t}\n\t\tif (docType === 'M')\n\t\t{\n\t\t\tif (field === 'STATUS')\n\t\t\t{\n\t\t\t\treturn this.getMessage('movingDocument');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.getMessage('movingModification');\n\t\t\t}\n\t\t}\n\t\tif (docType === 'D')\n\t\t{\n\t\t\tif (field === 'STATUS')\n\t\t\t{\n\t\t\t\treturn this.getMessage('deductDocument');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.getMessage('deductModification');\n\t\t\t}\n\t\t}\n\t\tif (docType === 'W')\n\t\t{\n\t\t\tif (field === 'STATUS')\n\t\t\t{\n\t\t\t\treturn this.getMessage('shipmentDocument');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.getMessage('shipmentModification');\n\t\t\t}\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tgetStatusInfo()\n\t{\n\t\tconst statusInfo = {};\n\t\tconst statusName = this.getTextDataParam('STATUS_TITLE');\n\t\tconst classCode = this.getTextDataParam('STATUS_CLASS');\n\t\t{\n\t\t\tstatusInfo.message = statusName;\n\t\t\tstatusInfo.className = \"crm-entity-stream-content-event-\" + classCode;\n\t\t}\n\n\t\treturn statusInfo;\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tconst children = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\tconst statusInfo = this.getStatusInfo();\n\t\tif (BX.type.isNotEmptyObject(statusInfo))\n\t\t{\n\t\t\tchildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: statusInfo.className },\n\t\t\t\t\t\ttext: statusInfo.message\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t}\n\t\tchildren.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t));\n\t\treturn children;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t}\n\t\t);\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\", \"\");\n\t\tconst error = this.getTextDataParam(\"ERROR\");\n\t\tconst contentChildren = [];\n\n\t\tif(error)\n\t\t{\n\t\t\tconst errorMessage = this.getTextDataParam(\"ERROR_MESSAGE\");\n\t\t\tcontentChildren.push(BX.create(\"DIV\", {\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\tchildren: errorMessage\n\t\t\t}));\n\t\t}\n\t\telse if(title !== \"\")\n\t\t{\n\t\t\tconst titleNode = BX.create('span', {text: title});\n\t\t\tconst nodeText = title;\n\n\t\t\tconst titleTemplate = BX.prop.getString(this._data, 'TITLE_TEMPLATE', '');\n\t\t\tif (titleTemplate)\n\t\t\t{\n\t\t\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\t\t\tif (docType === 'W')\n\t\t\t\t{\n\t\t\t\t\tif (this.getOwnerTypeId() === BX.CrmEntityType.enumeration.deal)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst documentDetailUrl = BX.prop.getString(this._data, 'DETAIL_LINK', '');\n\t\t\t\t\t\tconst documentLinkTag = '<a href=\"' + documentDetailUrl + '\">' + title + '</a>';\n\t\t\t\t\t\ttitleNode.innerHTML = titleTemplate.replace('#TITLE#', documentLinkTag);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttitleNode.innerHTML = titleTemplate.replace('#TITLE#', title);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitleNode.innerHTML = titleTemplate.replace('#TITLE#', title);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcontentChildren.push(BX.create(\"DIV\", {\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\tchildren: [titleNode],\n\t\t\t}));\n\t\t}\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-info\" },\n\t\t\t\t\t\t\t\t\tchildren: contentChildren\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = StoreDocumentModification.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new StoreDocumentModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import OrderModification from \"./order-modification\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class ExternalNoticeModification extends OrderModification\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-icon-restApp';\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ExternalNoticeModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import ExternalNoticeModification from \"./external-notice-modification\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class ExternalNoticeStatusModification extends ExternalNoticeModification\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst nodes = [];\n\t\tconst contentChildren = [];\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"START_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detain-info-status\"},\n\t\t\t\t\t\ttext: this.getTextDataParam(\"START_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",{ attrs: { className: \"crm-entity-stream-content-detail-info-separator-icon\" } })\n\t\t\t);\n\t\t}\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"FINISH_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-info-status\" },\n\t\t\t\t\t\ttext: this.getTextDataParam(\"FINISH_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\tnodes.push(BX.create(\"DIV\",\t{\n\t\t\tattrs: { className: \"crm-entity-stream-content-detail-info\" },\n\t\t\tchildren: contentChildren\n\t\t}));\n\n\t\treturn nodes;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ExternalNoticeStatusModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class OrderCheck extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"OrderCheck. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\tlet result = this.getMessage('orderCheck');\n\n\t\tconst checkName = this.getTextDataParam('CHECK_NAME');\n\t\tif (checkName !== '')\n\t\t{\n\t\t\tresult += ' \"' + checkName + '\"';\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createOrderEntity\";\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tlet statusMessage = '';\n\t\tlet statusClass = '';\n\t\tlet title = this.getTitle();\n\n\t\tif (this.getTextDataParam(\"SENDED\") !== '')\n\t\t{\n\t\t\ttitle = this.getMessage('sendedTitle');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstatusMessage = this.getMessage(\"printed\");\n\t\t\tstatusClass = \"crm-entity-stream-content-event-successful\";\n\t\t\tif (this.getTextDataParam(\"PRINTED\") !== 'Y')\n\t\t\t{\n\t\t\t\tstatusMessage = this.getMessage(\"unprinted\");\n\t\t\t\tstatusClass = \"crm-entity-stream-content-event-missing\";\n\t\t\t}\n\t\t}\n\n\t\treturn [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { click: this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: title\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t),\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: statusClass },\n\t\t\t\t\ttext: statusMessage\n\t\t\t\t}\n\t\t\t),\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst title = this.getTextDataParam(\"TITLE\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", '');\n\t\tconst nodes = [];\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tconst isSended = this.getTextDataParam(\"SENDED\") !== '';\n\t\t\tconst className = isSended\n\t\t\t\t? 'crm-entity-stream-content-detail-order'\n\t\t\t\t: 'crm-entity-stream-content-detail-description'\n\t\t\t;\n\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {attrs: {className: className}});\n\t\t\tif (showUrl !== \"\")\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"A\", {\n\t\t\t\t\tattrs: { href: showUrl},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: BX.delegate(function(e) {\n\t\t\t\t\t\t\tBX.Crm.Page.openSlider(showUrl, { width: 500 });\n\t\t\t\t\t\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t\t\t\t\t\t}, this)\n\t\t\t\t\t},\n\t\t\t\t\ttext: title\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tconst legend = this.getTextDataParam(\"LEGEND\");\n\t\t\tlet legendNode;\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tlegendNode = BX.create(\"SPAN\", { html: \" \" + legend });\n\t\t\t}\n\n\t\t\tif (isSended)\n\t\t\t{\n\t\t\t\tnodes.push(descriptionNode);\n\t\t\t\tif (legendNode)\n\t\t\t\t{\n\t\t\t\t\tnodes.push(legendNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (legendNode)\n\t\t\t\t{\n\t\t\t\t\tdescriptionNode.appendChild(legendNode);\n\t\t\t\t}\n\t\t\t\tnodes.push(descriptionNode);\n\t\t\t}\n\t\t}\n\n\t\tconst checkUrl = this.getTextDataParam(\"CHECK_URL\");\n\t\tif (checkUrl)\n\t\t{\n\t\t\tnodes.push(\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: 'crm-entity-stream-content-detail-payment-info' },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"A\", { attrs: { href: checkUrl, target: '_blank'}, text: this.getMessage('urlLink') })\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-createOrderEntity\";\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: this.getIconClassName() } }));\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-content\" }, children: [ contentWrapper ] }\n\t\t\t)\n\t\t);\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(header);\n\n\t\tcontentWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: this.prepareContentDetails()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OrderCheck.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OrderCheck();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class FinalSummaryDocuments extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = FinalSummaryDocuments.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage('title');\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tconst children = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\tchildren.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t));\n\n\t\treturn children;\n\t}\n\n\tcreateCheckBlock(check)\n\t{\n\t\tconst blockNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-notice\"}});\n\t\tblockNode.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"a\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { href: check.URL, target: '_blank' },\n\t\t\t\t\ttext: check.TITLE\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn blockNode;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-payment\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-content\"}});\n\n\t\tconst contentItem = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t});\n\t\tcontentItem.appendChild(header);\n\n\t\tconst data = this.getData();\n\n\t\tif (data.RESULT)\n\t\t{\n\t\t\tconst summaryOptions = {\n\t\t\t\t'OWNER_ID': data.ASSOCIATED_ENTITY_ID,\n\t\t\t\t'OWNER_TYPE_ID': data.ASSOCIATED_ENTITY_TYPE_ID,\n\t\t\t\t'PARENT_CONTEXT': this,\n\t\t\t\t'CONTEXT': BX.CrmEntityType.resolveName(data.ASSOCIATED_ENTITY_TYPE_ID).toLowerCase(),\n\t\t\t\t'IS_WITH_ORDERS_MODE': false,\n\t\t\t};\n\t\t\tconst timelineSummaryDocuments = new BX.Crm.TimelineSummaryDocuments(summaryOptions);\n\n\t\t\tconst options = data.RESULT.TIMELINE_SUMMARY_OPTIONS;\n\t\t\ttimelineSummaryDocuments.setOptions(options);\n\t\t\tconst nodes = [\n\t\t\t\ttimelineSummaryDocuments.render(),\n\t\t\t];\n\n\t\t\tcontentItem.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\t\t\tchildren: nodes\n\t\t\t\t\t})\n\t\t\t);\n\n\t\t\tcontent.appendChild(contentItem);\n\t\t}\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-icon-complete';\n\t}\n\n\tstartSalescenterApplication(orderId, options)\n\t{\n\t\tif (options === undefined)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.loadExt('salescenter.manager').then(function()\n\t\t{\n\t\t\tBX.Salescenter.Manager.openApplication(options);\n\t\t}.bind(this));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new FinalSummaryDocuments();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import FinalSummaryDocuments from \"./final-summary-documents\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class FinalSummary extends FinalSummaryDocuments\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-payment\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-content\"}});\n\n\t\tconst contentItem = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t});\n\t\tcontentItem.appendChild(header);\n\n\t\tconst data = this.getData();\n\n\t\tif (data.RESULT)\n\t\t{\n\t\t\tconst summaryOptions = {\n\t\t\t\t'OWNER_ID': data.ASSOCIATED_ENTITY_ID,\n\t\t\t\t'OWNER_TYPE_ID': data.ASSOCIATED_ENTITY_TYPE_ID,\n\t\t\t\t'PARENT_CONTEXT': this,\n\t\t\t\t'CONTEXT': BX.CrmEntityType.resolveName(data.ASSOCIATED_ENTITY_TYPE_ID).toLowerCase(),\n\t\t\t\t'IS_WITH_ORDERS_MODE': true,\n\t\t\t};\n\t\t\tconst timelineSummaryDocuments = new BX.Crm.TimelineSummaryDocuments(summaryOptions);\n\n\t\t\tconst options = data.RESULT.TIMELINE_SUMMARY_OPTIONS;\n\t\t\ttimelineSummaryDocuments.setOptions(options);\n\t\t\tconst nodes = [\n\t\t\t\ttimelineSummaryDocuments.render(),\n\t\t\t];\n\n\t\t\tcontentItem.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\t\t\tchildren: nodes\n\t\t\t\t\t})\n\t\t\t);\n\n\t\t\tcontent.appendChild(contentItem);\n\t\t}\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new FinalSummary();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryItem from \"./history\";\nimport {Item as ItemType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Creation extends HistoryItem\n{\n\tstatic messages = {};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Creation();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif (!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Creation. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst typeId = BX.prop.getInteger(entityData, \"TYPE_ID\");\n\t\t\tconst title = this.getMessage(typeId === BX.CrmActivityType.task ? \"task\" : \"activity\");\n\t\t\treturn title.replace(/#TITLE#/gi, this.cutOffText(BX.prop.getString(entityData, \"SUBJECT\")), 64);\n\t\t}\n\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.storeDocument)\n\t\t{\n\t\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\t\tif (docType === 'A')\n\t\t\t{\n\t\t\t\treturn this.getMessage('arrivalDocument');\n\t\t\t}\n\t\t\tif (docType === 'S')\n\t\t\t{\n\t\t\t\treturn this.getMessage('storeAdjustmentDocument');\n\t\t\t}\n\t\t\tif (docType === 'M')\n\t\t\t{\n\t\t\t\treturn this.getMessage('movingDocument');\n\t\t\t}\n\t\t\tif (docType === 'D')\n\t\t\t{\n\t\t\t\treturn this.getMessage('deductDocument');\n\t\t\t}\n\t\t\tif (docType === 'W')\n\t\t\t{\n\t\t\t\treturn this.getMessage('shipmentDocument');\n\t\t\t}\n\n\t\t\treturn '';\n\t\t}\n\n\t\tconst entityTypeName = BX.CrmEntityType.resolveName(this.getAssociatedEntityTypeId()).toLowerCase();\n\t\tlet msg = this.getMessage(entityTypeName);\n\t\tconst isMessageNotFound = (msg === entityTypeName);\n\t\tif (!BX.type.isNotEmptyString(msg) || isMessageNotFound)\n\t\t{\n\t\t\tmsg = this.getTextDataParam(\"TITLE\");\n\t\t}\n\n\t\treturn msg;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createEntity\";\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif (\n\t\t\tentityTypeId === BX.CrmEntityType.enumeration.ordershipment\n\t\t\t|| entityTypeId === BX.CrmEntityType.enumeration.orderpayment\n\t\t)\n\t\t{\n\t\t\tconst data = this.getData();\n\t\t\tdata.TYPE_CATEGORY_ID = ItemType.modification;\n\t\t\tif (data.hasOwnProperty('ASSOCIATED_ENTITY'))\n\t\t\t{\n\t\t\t\tdata.ASSOCIATED_ENTITY.HTML_TITLE = '';\n\t\t\t}\n\n\t\t\tconst createOrderEntityItem = this._history.createOrderEntityItem(data);\n\t\t\treturn createOrderEntityItem.prepareContent();\n\t\t}\n\n\t\treturn super.prepareContent();\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst link = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\thtml: this.cutOffText(BX.prop.getString(entityData, \"DESCRIPTION_RAW\"), 128)\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.bind(link, \"click\", this._headerClickHandler);\n\n\t\t\treturn [link];\n\t\t}\n\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\", \"\");\n\t\tlet htmlTitle = BX.prop.getString(entityData, \"HTML_TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\n\t\tif (\n\t\t\tentityTypeId === BX.CrmEntityType.enumeration.deal\n\t\t\t&& BX.prop.getObject(entityData, \"ORDER\", null)\n\t\t)\n\t\t{\n\t\t\tconst orderData = BX.prop.getObject(entityData, \"ORDER\", null);\n\t\t\thtmlTitle = this.getMessage('dealOrderTitle')\n\t\t\t\t.replace(\"#ORDER_ID#\", orderData.ID)\n\t\t\t\t.replace(\"#DATE_TIME#\", orderData.ORDER_DATE)\n\t\t\t\t.replace(\"#HREF#\", orderData.SHOW_URL)\n\t\t\t\t.replace(\"#PRICE_WITH_CURRENCY#\", orderData.SUM)\n\t\t\t;\n\t\t}\n\n\t\tif (title !== \"\" || htmlTitle !== \"\")\n\t\t{\n\t\t\tconst nodes = [];\n\t\t\tif (showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tconst spanAttrs = (htmlTitle !== \"\") ? {html: htmlTitle} : {text: title};\n\t\t\t\tnodes.push(BX.create(\"SPAN\", spanAttrs));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet linkAttrs = {attrs: {href: showUrl}, text: title};\n\t\t\t\tif (htmlTitle !== \"\")\n\t\t\t\t{\n\t\t\t\t\tlinkAttrs = {attrs: {href: showUrl}, html: htmlTitle};\n\t\t\t\t}\n\t\t\t\tnodes.push(BX.create(\"A\", linkAttrs));\n\t\t\t}\n\n\t\t\tconst legend = this.getTextDataParam(\"LEGEND\");\n\t\t\tif (legend !== \"\")\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"BR\"));\n\t\t\t\tnodes.push(BX.create(\"SPAN\", {text: legend}));\n\t\t\t}\n\n\t\t\tconst baseEntityData = this.getObjectDataParam(\"BASE\");\n\t\t\tconst baseEntityInfo = BX.prop.getObject(baseEntityData, \"ENTITY_INFO\");\n\t\t\tif (baseEntityInfo)\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"BR\"));\n\t\t\t\tnodes.push(BX.create(\"SPAN\", {text: BX.prop.getString(baseEntityData, \"CAPTION\") + \": \"}));\n\t\t\t\tnodes.push(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {href: BX.prop.getString(baseEntityInfo, \"SHOW_URL\", \"#\")},\n\t\t\t\t\t\t\ttext: BX.prop.getString(baseEntityInfo, \"TITLE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn nodes;\n\t\t}\n\t\treturn [];\n\t}\n\n\tview()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif (id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.viewActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Creation.messages;\n\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Restoration extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-restoreEntity\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\treturn title !== \"\" ?  [ BX.create(\"SPAN\", { text: title }) ] : [];\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Restoration.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Restoration();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Relation extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage('title');\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createEntity\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet link = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tif (link.indexOf('/') !== 0)\n\t\t{\n\t\t\tlink = '#';\n\t\t}\n\n\t\tconst content =\n\t\t\tthis.getMessage('contentTemplate')\n\t\t\t\t.replace('#ENTITY_TYPE_CAPTION#', BX.Text.encode(BX.prop.getString(entityData, 'ENTITY_TYPE_CAPTION', '')))\n\t\t\t\t.replace('#LEGEND#', '')\n\t\t\t\t.replace('#LINK#', BX.Text.encode(link))\n\t\t\t\t.replace('#LINK_TITLE#', BX.Text.encode(BX.prop.getString(entityData, \"TITLE\", '')))\n\t\t;\n\n\t\tconst nodes = [];\n\t\tnodes.push(\n\t\t\tBX.create('SPAN', { html: content })\n\t\t);\n\n\t\treturn nodes;\n\t}\n}\n","import Relation from \"./relation\"\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Link extends Relation\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-link\";\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Link.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Link();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Relation from \"./relation\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Unlink extends Relation\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-unlink\";\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Unlink.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Unlink();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\nimport {Mark as MarkType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Mark extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Mark. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Mark.messages;\n\t\tif (m.hasOwnProperty(name))\n\t\t{\n\t\t\treturn m[name];\n\t\t}\n\n\t\treturn super.getMessage(name);\n\t}\n\n\tgetTitle()\n\t{\n\t\tlet title = \"\";\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityTypeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\t\tconst activityProviderId = BX.prop.getString(entityData, \"PROVIDER_ID\", '');\n\n\t\t\tif(entityTypeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\") +\n\t\t\t\t\t\t\"SuccessMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\") +\n\t\t\t\t\t\t\"RenewMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\") +\n\t\t\t\t\t\t\"SuccessMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\") +\n\t\t\t\t\t\t\"RenewMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"meetingSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"meetingRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"taskSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"taskRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tif (activityProviderId === 'CRM_REQUEST')\n\t\t\t\t{\n\t\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = this.getMessage(\"requestSuccessMark\");\n\t\t\t\t\t}\n\t\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = this.getMessage(\"requestRenewMark\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"webformSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"webformRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.deal)\n\t\t{\n\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"dealSuccessMark\");\n\t\t\t}\n\t\t\telse if(typeCategoryId === MarkType.failed)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"dealFailedMark\");\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"orderSuccessMark\");\n\t\t\t}\n\t\t\telse if(typeCategoryId === MarkType.failed)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"orderFailedMark\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (BX.CrmEntityType.isDefined(associatedEntityTypeId))\n\t\t\t{\n\t\t\t\tif (typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage('entitySuccessMark');\n\t\t\t\t}\n\t\t\t\telse if (typeCategoryId === MarkType.failed)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage('entityFailedMark');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { href: \"#\", className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tconst wrapper = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-completed\"}}\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityTypeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tlet iconClassName = \"crm-entity-stream-section-icon\";\n\t\t\tif(entityTypeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-email\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-call\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-meeting\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-task\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\t\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t\t{\n\t\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-crmForm\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\t\t\tcontent.appendChild(header);\n\n\n\t\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t\t{attrs: {className: \"crm-entity-stream-content-detail\"}}\n\t\t\t);\n\t\t\tcontent.appendChild(detailWrapper);\n\n\t\t\tdetailWrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\t\ttext: this.cutOffText(BX.prop.getString(entityData, \"SUBJECT\", \"\"), 128)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tconst summary = this.getTextDataParam(\"SUMMARY\");\n\t\t\tif(summary !== \"\")\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\t\t\ttext: summary\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } }));\n\t\t\tcontent.appendChild(header);\n\t\t\tcontent.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\t\ttext: this.cutOffText(this.getTextDataParam(\"MESSAGE\"), 128)\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } }));\n\t\t\tcontent.appendChild(header);\n\n\t\t\tconst innerWrapper = BX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst associatedEntityTitle = this.cutOffText(BX.prop.getString(entityData, \"TITLE\", \"\"), 128);\n\n\t\t\tif (BX.CrmEntityType.isDefined(associatedEntityTypeId))\n\t\t\t{\n\t\t\t\tlet link = BX.prop.getString(entityData, 'SHOW_URL', '');\n\t\t\t\tif (link.indexOf('/') !== 0)\n\t\t\t\t{\n\t\t\t\t\tlink = '#';\n\t\t\t\t}\n\n\t\t\t\tconst contentTemplate =\n\t\t\t\t\tthis.getMessage('entityContentTemplate')\n\t\t\t\t\t\t.replace('#ENTITY_TYPE_CAPTION#', BX.Text.encode(BX.prop.getString(entityData, 'ENTITY_TYPE_CAPTION', '')))\n\t\t\t\t\t\t.replace('#LINK#', BX.Text.encode(link))\n\t\t\t\t\t\t.replace('#LINK_TITLE#', BX.Text.encode(associatedEntityTitle))\n\t\t\t\t;\n\n\t\t\t\tinnerWrapper.appendChild(\n\t\t\t\t\tBX.create(\n\t\t\t\t\t\t'SPAN',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: contentTemplate\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tinnerWrapper.innerText = associatedEntityTitle;\n\t\t\t}\n\n\t\t\tcontent.appendChild(innerWrapper);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tview()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.viewActivity(id);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\t\tif(showUrl !== \"\")\n\t\t\t{\n\t\t\t\tBX.Crm.Page.open(showUrl);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Mark();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\nimport {EditorMode} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Comment extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._isCollapsed = false;\n\t\tthis._isMenuShown = false;\n\t\tthis._isFixed = false;\n\t\tthis._hasFiles = false;\n\t\tthis._postForm = null;\n\t\tthis._editor = null;\n\t\tthis._commentMessage = '';\n\t\tthis._mode = EditorMode.view;\n\t\tthis._streamContentEventBlock = '';\n\t\tthis._playerWrappers = {};\n\t\tBX.Event.EventEmitter.subscribe(\n\t\t\t\"BX.Disk.Files:onShowFiles\",\n\t\t\tBX.delegate(this.addPlayer, this)\n\t\t);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tthis._hasFiles = (this.getTextDataParam(\"HAS_FILES\") === 'Y');\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"comment\");\n\t}\n\n\tonPlayerDummyClick(file)\n\t{\n\t\tconst playerWrapper = this._playerWrappers[file.id];\n\t\tconst stubNode = playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif (stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(\n\t\t\tthis._history.getManager().loadMediaPlayer(\n\t\t\t\t\"history_\" + this.getId() + '_' + file.id,\n\t\t\t\tfile.url,\n\t\t\t\t'audio/mp3',\n\t\t\t\tplayerWrapper,\n\t\t\t\tnull,\n\t\t\t\t{\n\t\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\taddPlayer(event)\n\t{\n\t\tif (event.data.entityValueId === parseInt(this.getId(), 10))\n\t\t{\n\t\t\tthis.files = event.data.files;\n\t\t\tevent.data.files.forEach(function(file){\n\t\t\t\tif (file.extension === 'mp3')\n\t\t\t\t{\n\t\t\t\t\tif (this._playerWrappers[file.id])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst callInfoWrapper = BX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tthis._streamContentEventBlock.appendChild(callInfoWrapper);\n\t\t\t\t\tthis._playerWrappers[file.id] = this._history.getManager().renderAudioDummy(\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tthis.onPlayerDummyClick.bind(this, file)\n\t\t\t\t\t);\n\n\t\t\t\t\tthis._playerWrappers[file.id].firstElementChild.classList.add(\"crm-audio-cap-wrap-without-duration-text\");\n\n\t\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\t\tthis._playerWrappers[file.id]\n\t\t\t\t\t);\n\t\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\t\tthis._history.getManager().getAudioPlaybackRateSelector().render()\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-comment\"}\n\t\t\t}\n\t\t);\n\n\t\tif (this.isReadOnly())\n\t\t{\n\t\t\tBX.addClass(wrapper, \"crm-entity-stream-section-comment-read-only\");\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-comment\" } }\n\t\t\t)\n\t\t);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tthis._streamContentEventBlock = BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-content-event\" } });\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tthis._streamContentEventBlock.appendChild(header);\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\tconst detailChildren = [];\n\t\tif (this._mode !== EditorMode.edit)\n\t\t{\n\t\t\tthis._commentWrapper = BX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" }\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.html(this._commentWrapper, this.getTextDataParam(\"COMMENT\", \"\"));\n\t\t\tdetailChildren.push(this._commentWrapper);\n\n\t\t\tif (!this.isReadOnly())\n\t\t\t{\n\t\t\t\tBX.bind(this._commentWrapper, \"click\", BX.delegate(this.switchToEditMode, this));\n\t\t\t\tBX.bind(header, \"click\", BX.delegate(this.switchToEditMode, this));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\n\t\t\tdetailChildren.push(this._editorContainer);\n\n\t\t\tconst buttons = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-comment-edit-btn-container\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"button\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {className: \"ui-btn ui-btn-xs ui-btn-primary\"},\n\t\t\t\t\t\t\t\t\thtml: this.getMessage(\"send\"),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.save, this)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tBX.create(\"a\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {className: \"ui-btn ui-btn-xs ui-btn-link\"},\n\t\t\t\t\t\t\t\t\thtml: this.getMessage(\"cancel\"),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.switchToViewMode, this)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdetailChildren.push(buttons);\n\t\t}\n\n\t\tthis._streamContentEventBlock.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: detailChildren\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tthis._streamContentEventBlock.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\t\tconst cleanText = this.getTextDataParam(\"TEXT\", \"\");\n\t\tconst _hasInlineAttachment = (this.getTextDataParam(\"HAS_INLINE_ATTACHMENT\", \"\") === 'Y');\n\t\tif ((cleanText.length <= 128 && !_hasInlineAttachment) || this._mode === EditorMode.edit)\n\t\t{\n\t\t\tthis._isCollapsed = false;\n\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"crm-entity-stream-section-content\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tthis._streamContentEventBlock\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._isCollapsed = true;\n\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content crm-entity-stream-section-content-collapsed\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tthis._streamContentEventBlock\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\twrapper.querySelector(\".crm-entity-stream-content-event\").appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content-expand-btn-container\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-section-content-expand-btn\",\n\t\t\t\t\t\t\t\t\t\t\t\thref: \"#\"\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tevents:\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.onExpandButtonClick, this)\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"expand\")\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (this._mode === EditorMode.view && this._hasFiles)\n\t\t{\n\t\t\tthis._textLoaded = false;\n\t\t\tthis._fileBlock = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-files-inner\" },\n\t\t\t\t\tchildren: [BX.create(\"DIV\", { attrs: { className: \"crm-timeline-wait\" }})]\n\t\t\t\t});\n\t\t\twrapper.querySelector(\".crm-entity-stream-section-content\").appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-files\" },\n\t\t\t\t\t\tchildren: [this._fileBlock]\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tBX.ready(BX.delegate(function() {\n\t\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\t\tthis.loadContent(this._fileBlock, \"GET_FILE_BLOCK\")\n\t\t\t\t} ,this), 100);\n\t\t\t},this));\n\t\t}\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif (this._mode === EditorMode.view && BX.type.isDomNode(this._commentWrapper))\n\t\t{\n\t\t\tthis.registerImages(this._commentWrapper);\n\t\t\tif (!BX.getClass('BX.Disk.apiVersion'))\n\t\t\t{\n\t\t\t\tBX.viewElementBind(\n\t\t\t\t\tthis._commentWrapper,\n\t\t\t\t\t{showTitle: true},\n\t\t\t\t\tfunction(node){\n\t\t\t\t\t\treturn BX.type.isElementNode(node) && (node.getAttribute('data-bx-viewer') || node.getAttribute('data-bx-image'));\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tloadContent(node, type)\n\t{\n\t\tif (!BX.type.isDomNode(node))\n\t\t\treturn;\n\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"GET_COMMENT_CONTENT\",\n\t\t\t\t\t\t\"ID\": this.getId(),\n\t\t\t\t\t\t\"ENTITY_TYPE_ID\": this.getOwnerTypeId(),\n\t\t\t\t\t\t\"ENTITY_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"TYPE\": type\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(function(result)\n\t\t\t\t{\n\t\t\t\t\tif (BX.type.isNotEmptyString(result.ERROR) && type === 'GET_FILE_BLOCK')\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.remove(node);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (BX.type.isNotEmptyString(result.BLOCK))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst promise = BX.html(node, result.BLOCK);\n\t\t\t\t\t\tpromise.then(\n\t\t\t\t\t\t\tBX.delegate(function(){\n\t\t\t\t\t\t\t\tthis.registerImages(node);\n\t\t\t\t\t\t\t\tBX.LazyLoad.showImages();\n\t\t\t\t\t\t\t}, this)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tloadEditor()\n\t{\n\t\tthis._editorName = 'CrmTimeLineComment'+this._id + BX.util.getRandomString(4);\n\t\tif (this._postForm)\n\t\t{\n\t\t\tthis._postForm.oEditor.SetContent(this._commentMessage);\n\t\t\tthis._editor.ReInitIframe();\n\t\t\treturn;\n\t\t}\n\n\t\tconst actionData = {\n\t\t\tdata: {\n\t\t\t\tid: this._id,\n\t\t\t\tname: this._editorName\n\t\t\t}\n\t\t};\n\t\tBX.ajax.runAction(\"crm.api.timeline.loadEditor\", actionData)\n\t\t\t.then(this.onLoadEditorSuccess.bind(this))\n\t\t\t.catch(\tthis.switchToViewMode.bind(this));\n\t}\n\n\tonLoadEditorSuccess(result)\n\t{\n\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\n\t\tconst html = BX.prop.getString(BX.prop.getObject(result, \"data\", {}), \"html\", '');\n\t\tBX.html(this._editorContainer, html).then(BX.delegate(this.showEditor,this));\n\t}\n\n\tshowEditor()\n\t{\n\t\tif (LHEPostForm)\n\t\t{\n\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\tthis._postForm = LHEPostForm.getHandler(this._editorName);\n\t\t\t\tthis._editor = BXHtmlEditor.Get(this._editorName);\n\t\t\t\tBX.onCustomEvent(this._postForm.eventNode, 'OnShowLHE', [true]);\n\t\t\t\tthis._commentMessage = this._postForm.oEditor.GetContent();\n\t\t\t} ,this), 0);\n\t\t}\n\t}\n\n\tonFinishFasten()\n\t{\n\t\tthis.registerImages(this._commentWrapper);\n\t\tif (BX.type.isDomNode(this._fileBlock))\n\t\t\tthis.registerImages(this._fileBlock);\n\t\tBX.LazyLoad.showImages();\n\t}\n\n\tregisterImages(node)\n\t{\n\t\tconst commentImages = node.querySelectorAll('[data-bx-viewer=\"image\"]');\n\t\tconst commentImagesLength = commentImages.length;\n\t\tconst idsList = [];\n\t\tif (commentImagesLength > 0)\n\t\t{\n\t\t\tfor (let i = 0; i < commentImagesLength; ++i)\n\t\t\t{\n\t\t\t\tif (BX.type.isDomNode(commentImages[i]))\n\t\t\t\t{\n\t\t\t\t\tcommentImages[i].id += BX.util.getRandomString(4);\n\t\t\t\t\tidsList.push(commentImages[i].id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (idsList.length > 0)\n\t\t\t{\n\t\t\t\tBX.LazyLoad.registerImages(idsList);\n\t\t\t}\n\t\t}\n\t\tBX.LazyLoad.registerImages(idsList);\n\t}\n\n\ttoggleMode(type)\n\t{\n\t\tthis._mode = parseInt(type);\n\t\tthis._hasFiles = (this.getTextDataParam(\"HAS_FILES\") === 'Y');\n\t\tthis.refreshLayout();\n\t\tthis.closeContextMenu();\n\t}\n\n\tswitchToViewMode(e)\n\t{\n\t\t// if (LHEPostForm)\n\t\t// \tLHEPostForm.unsetHandler(this._editorName);\n\t\tthis.toggleMode(EditorMode.view);\n\t}\n\n\tswitchToEditMode(e)\n\t{\n\t\tconst tagName = e.target.tagName.toLowerCase();\n\t\tif (tagName === 'a'\n\t\t\t|| tagName === 'img'\n\t\t\t|| BX.hasClass(e.target, \"feed-con-file-changes-link-more\")\n\t\t\t|| BX.hasClass(e.target, \"feed-com-file-inline\")\n\t\t\t|| BX.type.isNotEmptyString(document.getSelection().toString())\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleMode(EditorMode.edit);\n\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\tthis.loadEditor();\n\t\t} ,this), 100);\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this._mode !== EditorMode.edit)\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.switchToEditMode, this)});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"cancel\", text: this.getMessage(\"menuCancel\"), onclick: BX.delegate(this.switchToViewMode, this)});\n\t\t\t}\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tsave(e)\n\t{\n\t\tconst attachmentList = [];\n\t\tlet text = \"\";\n\t\tif (this._postForm)\n\t\t{\n\t\t\ttext = this._postForm.oEditor.GetContent();\n\t\t\tthis._commentMessage = text;\n\t\t\tthis._postForm.eventNode\n\t\t\t\t.querySelectorAll('input[name=\"UF_CRM_COMMENT_FILES[]\"]')\n\t\t\t\t.forEach(function(input) {\n\t\t\t\t\tattachmentList.push(input.value)\n\t\t\t\t});\n\t\t}\n\n\t\tif (!BX.type.isNotEmptyString(text))\n\t\t{\n\t\t\tif (!this.emptyCommentMessage)\n\t\t\t{\n\t\t\t\tthis.emptyCommentMessage = new BX.PopupWindow(\n\t\t\t\t\t'timeline_empty_comment_' + this._id,\n\t\t\t\t\te.target,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_EMPTY_COMMENT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: {position: 'top', offset: 77},\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.emptyCommentMessage.show();\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isRequestRunning && BX.type.isNotEmptyString(text))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"UPDATE_COMMENT\",\n\t\t\t\t\t\t\"ID\": this.getId(),\n\t\t\t\t\t\t\"TEXT\": text,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ATTACHMENTS\": attachmentList\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onRequestFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getMessage('commentRemove')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove(e)\n\t{\n\t\tif(this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst history = this._history._manager.getHistory();\n\t\tconst deleteItem = history.findItemById(this._id);\n\t\tif (deleteItem instanceof Comment)\n\t\t\tdeleteItem.clearAnimate();\n\n\t\tconst fixedHistory = this._history._manager.getFixedHistory();\n\t\tconst deleteFixedItem = fixedHistory.findItemById(this._id);\n\t\tif (deleteFixedItem instanceof Comment)\n\t\t\tdeleteFixedItem.clearAnimate();\n\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"DELETE_COMMENT\",\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this.getId()\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onRemoveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onRequestFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = false;\n\t\tconst itemData = BX.prop.getObject(data, \"HISTORY_ITEM\");\n\n\t\tconst updateFixedItem = this._fixedHistory.findItemById(this._id);\n\t\tif (updateFixedItem instanceof Comment)\n\t\t{\n\t\t\tif (!BX.type.isNotEmptyString(itemData['IS_FIXED']))\n\t\t\t\titemData['IS_FIXED'] = 'Y';\n\n\t\t\tupdateFixedItem.setData(itemData);\n\t\t\tupdateFixedItem._id = BX.prop.getString(itemData, \"ID\");\n\t\t\tupdateFixedItem.switchToViewMode();\n\t\t}\n\n\t\tconst updateItem = this._history.findItemById(this._id);\n\t\tif (updateItem instanceof Comment)\n\t\t{\n\t\t\tupdateItem.setData(itemData);\n\t\t\tupdateItem._id = BX.prop.getString(itemData, \"ID\");\n\t\t\tupdateItem.switchToViewMode();\n\t\t}\n\n\t\tthis._postForm = null;\n\t}\n\n\tonRemoveSuccess(data)\n\t{\n\t}\n\n\tonRequestFailure(data)\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tonExpandButtonClick(e)\n\t{\n\t\tif(!this._wrapper)\n\t\t{\n\t\t\treturn BX.PreventDefault(e);\n\t\t}\n\n\t\tconst contentWrapper = this._wrapper.querySelector(\"div.crm-entity-stream-section-content\");\n\t\tif(!contentWrapper)\n\t\t{\n\t\t\treturn BX.PreventDefault(e);\n\t\t}\n\n\t\tif (this._hasFiles && BX.type.isDomNode(this._commentWrapper) && !this._textLoaded)\n\t\t{\n\t\t\tthis._textLoaded = true;\n\t\t\tthis.loadContent(this._commentWrapper, \"GET_TEXT\")\n\t\t}\n\t\tconst eventWrapper = contentWrapper.querySelector(\".crm-entity-stream-content-event\");\n\t\tif(this._isCollapsed)\n\t\t{\n\t\t\teventWrapper.style.maxHeight = eventWrapper.scrollHeight + 130 + \"px\";\n\t\t\tBX.removeClass(contentWrapper, \"crm-entity-stream-section-content-collapsed\");\n\t\t\tBX.addClass(contentWrapper, \"crm-entity-stream-section-content-expand\");\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\teventWrapper.style.maxHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t300\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\teventWrapper.style.maxHeight = eventWrapper.clientHeight + \"px\";\n\t\t\tBX.removeClass(contentWrapper, \"crm-entity-stream-section-content-expand\");\n\t\t\tBX.addClass(contentWrapper, \"crm-entity-stream-section-content-collapsed\");\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\teventWrapper.style.maxHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t0\n\t\t\t);\n\t\t}\n\n\t\tthis._isCollapsed = !this._isCollapsed;\n\n\t\tconst button = contentWrapper.querySelector(\"a.crm-entity-stream-section-content-expand-btn\");\n\t\tif(button)\n\t\t{\n\t\t\tbutton.innerHTML = this.getMessage(this._isCollapsed ? \"expand\" : \"collapse\");\n\t\t}\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Wait extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"wait\");\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\tdescription = BX.util.trim(description);\n\t\t\tdescription = BX.util.strip_tags(description);\n\t\t\tdescription = BX.util.nl2br(description);\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-wait\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-complete\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: description\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Sender extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetDataSetting(name)\n\t{\n\t\tconst settings = this.getObjectDataParam('SETTINGS') || {};\n\t\treturn settings[name] || null;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Sender.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getDataSetting('messageName');\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tconst self = this;\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tthis.isRemoved()\n\t\t\t\t\t?\n\t\t\t\t\tBX.create(\"SPAN\", {text: this.getTitle()})\n\t\t\t\t\t:\n\t\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\thref: \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\"click\": function (e)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (BX.SidePanel)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.open(self.getDataSetting('path'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttop.location.href = self.getDataSetting('path');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareStatusLayout()\n\t{\n\t\tlet layoutClassName, textCaption;\n\t\tif (this.getDataSetting('isError'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('error');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-missing\";\n\t\t}\n\t\telse if (this.getDataSetting('isUnsub'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('unsub');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-missing\";\n\t\t}\n\t\telse if (this.getDataSetting('isClick'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('click');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-successful\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttextCaption = this.getMessage('read');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-skipped\";\n\t\t}\n\n\t\treturn BX.create(\"SPAN\", {attrs: {className: layoutClassName}, text: textCaption});\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tif (this.getDataSetting('isError') || this.getDataSetting('isRead') || this.getDataSetting('isUnsub'))\n\t\t{\n\t\t\theader.appendChild(this.prepareStatusLayout());\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tisRemoved()\n\t{\n\t\treturn !this.getDataSetting('letterTitle');\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst description = this.isRemoved() ? this.getMessage('removed') : this.getMessage('title') + ': ' + this.getDataSetting('letterTitle');\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-wait\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-complete\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: description\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Sender();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Bizproc extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"bizproc\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-bp\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-bp\" } }\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\t\t\t\t\thtml: this.prepareContentTextHtml()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContentTextHtml()\n\t{\n\t\tconst type = this.getTextDataParam(\"TYPE\");\n\t\tif (type === 'ACTIVITY_ERROR')\n\t\t{\n\t\t\treturn '<strong>#TITLE#</strong>: #ERROR_TEXT#'\n\t\t\t\t.replace('#TITLE#', BX.util.htmlspecialchars(this.getTextDataParam(\"ACTIVITY_TITLE\")))\n\t\t\t\t.replace('#ERROR_TEXT#', BX.util.htmlspecialchars(this.getTextDataParam(\"ERROR_TEXT\")))\n\t\t}\n\n\t\tconst workflowName = this.getTextDataParam(\"WORKFLOW_TEMPLATE_NAME\");\n\t\tconst workflowStatus = this.getTextDataParam(\"WORKFLOW_STATUS_NAME\");\n\t\tif (!workflowName\n\t\t\t|| workflowStatus !== 'Created' && workflowStatus !== 'Completed' && workflowStatus !== 'Terminated'\n\t\t)\n\t\t{\n\t\t\treturn BX.util.htmlspecialchars(this.getTextDataParam(\"COMMENT\"));\n\t\t}\n\n\t\tlet label = BX.message('CRM_TIMELINE_BIZPROC_CREATED');\n\t\tif (workflowStatus === 'Completed')\n\t\t{\n\t\t\tlabel = BX.message('CRM_TIMELINE_BIZPROC_COMPLETED');\n\t\t}\n\t\telse if (workflowStatus === 'Terminated')\n\t\t{\n\t\t\tlabel = BX.message('CRM_TIMELINE_BIZPROC_TERMINATED');\n\t\t}\n\n\t\treturn BX.util.htmlspecialchars(label)\n\t\t\t.replace('#NAME#', '<strong>' + BX.util.htmlspecialchars(workflowName) + '</strong>');\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Bizproc();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Scoring extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst outerWrapper = BX.create(\"DIV\", {\n\t\t\tattrs: {\n\t\t\t\tclassName: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-scoring\"\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: function () {\n\t\t\t\t\tlet url = \"/crm/ml/#entity#/#id#/detail\";\n\t\t\t\t\tconst ownerTypeId = this.getOwnerTypeId();\n\t\t\t\t\tconst ownerId = this.getOwnerId();\n\n\t\t\t\t\tlet ownerType;\n\t\t\t\t\tif (ownerTypeId === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\townerType = \"lead\";\n\t\t\t\t\t}\n\t\t\t\t\telse if (ownerTypeId === 2)\n\t\t\t\t\t{\n\t\t\t\t\t\townerType = \"deal\";\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\turl = url.replace(\"#entity#\", ownerType);\n\t\t\t\t\turl = url.replace(\"#id#\", ownerId);\n\n\t\t\t\t\tif (BX.SidePanel)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.SidePanel.Instance.open(url, {width: 840});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttop.location.href = url;\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\n\t\tconst scoringInfo = BX.prop.getObject(this._data, \"SCORING_INFO\", null);\n\t\tif(!scoringInfo)\n\t\t{\n\t\t\treturn outerWrapper;\n\t\t}\n\n\t\tlet score = BX.prop.getNumber(scoringInfo, \"SCORE\", 0);\n\t\tlet scoreDelta = BX.prop.getNumber(scoringInfo, \"SCORE_DELTA\", 0);\n\t\tscore = Math.round(score * 100);\n\t\tscoreDelta = Math.round(scoreDelta * 100);\n\n\t\tconst result = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-scoring-total-result\"},\n\t\t\t\ttext: score + \"%\"\n\t\t\t});\n\n\t\tlet iconClass = \"crm-entity-stream-content-scoring-total-icon\";\n\t\tif (score < 50)\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-fail\";\n\t\t}\n\t\telse if (score < 75)\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-middle\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-success\";\n\t\t}\n\n\t\tconst icon = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: iconClass}\n\t\t\t}\n\t\t);\n\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-total\" },\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-total-text\" },\n\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_SCORING_TITLE_2\")\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tresult,\n\t\t\t\t\t\t\t\t\ticon\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event\" },\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\t\tscoreDelta !== 0 ?\n\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event-offset\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: (scoreDelta > 0 ? \"+\" : \"\") + scoreDelta + \"%\"\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t/*BX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event-detail\" },\n\t\t\t\t\t\t\t\t\t\t\ttext: \"<activity subject>\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t)*/\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn outerWrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Scoring();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Stream from \"../stream\";\nimport {Item as ItemType, Order as OrderType, Delivery as DeliveryType, Compilation as CompilationType} from \"../types\";\nimport HistoryItem from \"../items/history\";\nimport Modification from \"../items/modification\";\nimport Conversion from \"../items/conversion\";\nimport HistoryActivity from \"../items/history-activity\";\nimport Email from \"../items/email\";\nimport Call from \"../items/call\";\nimport Meeting from \"../items/meeting\";\nimport Task from \"../items/task\";\nimport WebForm from \"../items/webform\";\nimport Sms from \"../items/sms\";\nimport Request from \"../items/request\";\nimport OpenLine from \"../items/openline\";\nimport Rest from \"../items/rest\";\nimport Visit from \"../items/visit\";\nimport Zoom from \"../items/zoom\";\nimport OrderCreation from \"../items/order-creation\";\nimport OrderModification from \"../items/order-modification\";\nimport StoreDocumentCreation from \"../items/store-document-creation\";\nimport StoreDocumentModification from \"../items/store-document-modification\";\nimport ExternalNoticeStatusModification from \"../items/external-notice-status-modification\";\nimport ExternalNoticeModification from \"../items/external-notice-modification\";\nimport OrderCheck from \"../items/order-check\";\nimport FinalSummary from \"../items/final-summary\";\nimport FinalSummaryDocuments from \"../items/final-summary-documents\";\nimport Creation from \"../items/creation\";\nimport Restoration from \"../items/restoration\";\nimport Link from \"../items/link\";\nimport Unlink from \"../items/unlink\";\nimport Mark from \"../items/mark\";\nimport Comment from \"../items/comment\";\nimport Wait from \"../items/wait\";\nimport Document from \"../items/document\";\nimport Sender from \"../items/sender\";\nimport Bizproc from \"../items/bizproc\";\nimport Scoring from \"../items/scoring\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class History extends Stream\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._wrapper = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._emptySection = null;\n\t\tthis._currentDaySection = null;\n\t\tthis._lastDaySection = null;\n\t\tthis._lastDate = null;\n\t\tthis._anchor = null;\n\t\tthis._history = this;\n\t\tthis._enableLoading = false;\n\t\tthis._navigation = null;\n\t\tthis._scrollHandler = null;\n\t\tthis._loadingWaiter = null;\n\n\t\tthis._filterId = \"\";\n\t\tthis._isFilterApplied = false;\n\t\tthis._isFilterShown = false;\n\n\t\tthis._isRequestRunning = false;\n\n\t\tthis._filterButton = null;\n\t\tthis._filterWrapper = null;\n\t\tthis._filterResultStub = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._fixedHistory = this.getSetting(\"fixedHistory\");\n\t\tthis._ownerTypeId = this.getSetting(\"ownerTypeId\");\n\t\tthis._ownerId = this.getSetting(\"ownerId\");\n\t\tthis._serviceUrl = this.getSetting(\"serviceUrl\", \"\");\n\t\tif (!this.isStubMode())\n\t\t{\n\t\t\tlet itemData = this.getSetting(\"itemData\");\n\t\t\tif (!BX.type.isArray(itemData))\n\t\t\t{\n\t\t\t\titemData = [];\n\t\t\t}\n\n\t\t\tlet i, length, item;\n\t\t\tfor (i = 0, length = itemData.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this.createItem(itemData[i]);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._navigation = this.getSetting(\"navigation\", {});\n\n\t\t\tthis._filterWrapper = BX(\"timeline-filter\");\n\t\t\tthis._filterId = BX.prop.getString(this._settings, \"filterId\", this._id);\n\t\t\tthis._isFilterShown = this._filterWrapper\n\t\t\t\t&& BX.hasClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\t\t\tthis._isFilterApplied = BX.prop.getBoolean(this._settings, \"isFilterApplied\", false);\n\n\t\t\tBX.addCustomEvent(\"BX.Main.Filter:apply\", this.onFilterApply.bind(this));\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tconst now = BX.prop.extractDate(new Date());\n\t\tlet i, length, item;\n\n\t\tif (!this.isStubMode())\n\t\t{\n\t\t\tif (this._filterWrapper)\n\t\t\t{\n\t\t\t\tconst closeFilterButton = this._filterWrapper.querySelector(\".crm-entity-stream-filter-close\");\n\t\t\t\tif (closeFilterButton)\n\t\t\t\t{\n\t\t\t\t\tBX.bind(closeFilterButton, \"click\", this.onFilterClose.bind(this));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (i = 0, length = this._items.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this._items[i];\n\t\t\t\titem.setContainer(this._wrapper);\n\n\t\t\t\tconst created = item.getCreatedDate();\n\t\t\t\tif (this._lastDate === null || this._lastDate.getTime() !== created.getTime())\n\t\t\t\t{\n\t\t\t\t\tthis._lastDate = created;\n\t\t\t\t\tif (now.getTime() === created.getTime())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._lastDaySection = this.createDaySection(this._lastDate);\n\t\t\t\t\t\tthis._wrapper.appendChild(this._lastDaySection);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\titem._lastDate = this._lastDate;\n\n\t\t\t\titem.layout();\n\t\t\t}\n\n\t\t\tthis.enableLoading(this._items.length > 0);\n\t\t\tthis.refreshLayout();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\n\t\t\tthis._wrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-createEntity crm-entity-stream-section-last\"},\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\"}}),\n\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}}),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_HISTORY_STUB\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t\tif (this._filterWrapper)\n\t\t{\n\t\t\tif (this._wrapper.firstChild && this._filterWrapper !== this._wrapper.firstChild)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._filterWrapper, this._wrapper.firstChild);\n\t\t\t}\n\t\t\telse if (!this._wrapper.firstChild && this._filterWrapper.parentNode !== this._wrapper)\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._filterWrapper);\n\t\t\t}\n\t\t}\n\n\t\tthis.adjustFilterButton();\n\n\t\tconst length = this._items.length;\n\t\tif (length === 0 && this._isFilterApplied)\n\t\t{\n\t\t\tif (!this._filterEmptyResultSection)\n\t\t\t{\n\t\t\t\tthis._filterEmptyResultSection = this.createFilterEmptyResultSection();\n\t\t\t}\n\t\t\tthis._wrapper.appendChild(this._filterEmptyResultSection);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterEmptyResultSection)\n\t\t{\n\t\t\tthis._filterEmptyResultSection = BX.remove(this._filterEmptyResultSection);\n\t\t}\n\n\t\tif (length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < (length - 1); i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif (item.isTerminated())\n\t\t\t{\n\t\t\t\titem.markAsTerminated(false);\n\t\t\t}\n\t\t}\n\n\t\tthis._items[length - 1].markAsTerminated(true);\n\t}\n\n\tcalculateItemIndex(item)\n\t{\n\t\treturn 0;\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\treturn this.getLastItem() === item;\n\t}\n\n\thasContent()\n\t{\n\t\treturn (this._items.length > 0 || this._isFilterApplied || this._isStubMode);\n\t}\n\n\tgetLastItem()\n\t{\n\t\treturn this._items.length > 0 ? this._items[this._items.length - 1] : null;\n\t}\n\n\tgetItemByIndex(index)\n\t{\n\t\treturn index < this._items.length ? this._items[index] : null;\n\t}\n\n\tgetItemCount()\n\t{\n\t\treturn this._items.length;\n\t}\n\n\tremoveItemByIndex(index)\n\t{\n\t\tif (index < this._items.length)\n\t\t{\n\t\t\tthis._items.splice(index, 1);\n\t\t}\n\t}\n\n\tgetItemIndex(item)\n\t{\n\t\tfor (let i = 0, length = this._items.length; i < length; i++)\n\t\t{\n\t\t\tif (this._items[i] === item)\n\t\t\t{\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tgetItemsByAssociatedEntity($entityTypeId, entityId)\n\t{\n\t\tif (!BX.type.isNumber($entityTypeId))\n\t\t{\n\t\t\t$entityTypeId = parseInt($entityTypeId);\n\t\t}\n\n\t\tif (!BX.type.isNumber(entityId))\n\t\t{\n\t\t\tentityId = parseInt(entityId);\n\t\t}\n\n\t\tif (isNaN($entityTypeId) || $entityTypeId <= 0 || isNaN(entityId) || entityId <= 0)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst results = [];\n\t\tfor (let i = 0, l = this._items.length; i < l; i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif (item.getAssociatedEntityTypeId() === $entityTypeId && item.getAssociatedEntityId() === entityId)\n\t\t\t{\n\t\t\t\tresults.push(item);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tfindItemById(id)\n\t{\n\t\tid = id.toString();\n\t\tfor (let i = 0, l = this._items.length; i < l; i++)\n\t\t{\n\t\t\tif (this._items[i].getId() === id)\n\t\t\t{\n\t\t\t\treturn this._items[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tcreateFilterEmptyResultSection()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-filter-empty\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty\"},\n\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty-img\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty-text\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"filterEmptyResultStub\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tadjustFilterButton()\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._isFilterShown && this._items.length === 0)\n\t\t{\n\t\t\tif (!this._emptySection)\n\t\t\t{\n\t\t\t\tthis._emptySection = this.createEmptySection();\n\t\t\t}\n\t\t\tthis._wrapper.insertBefore(this._emptySection, this._filterWrapper);\n\t\t}\n\t\telse if (this._emptySection)\n\t\t{\n\t\t\tthis._emptySection = BX.remove(this._emptySection);\n\t\t}\n\n\t\tif (!this._filterButton)\n\t\t{\n\t\t\tthis._filterButton = BX.create(\"BUTTON\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-label\"},\n\t\t\t\t\ttext: this.getMessage(\"filterButtonCaption\")\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tBX.bind(this._filterButton, \"click\", function (e) {\n\t\t\t\tthis.showFilter();\n\t\t\t}.bind(this));\n\t\t}\n\n\t\tconst section = this._wrapper.querySelector(\".crm-entity-stream-section-today-label, .crm-entity-stream-section-planned-label, .crm-entity-stream-section-history-label\");\n\t\tif (section)\n\t\t{\n\t\t\tconst sectionWrapper = section.querySelector(\".crm-entity-stream-section-content\");\n\t\t\tif (sectionWrapper)\n\t\t\t{\n\t\t\t\tif (this._filterButton.parentNode !== sectionWrapper)\n\t\t\t\t{\n\t\t\t\t\tsectionWrapper.appendChild(this._filterButton);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this._isFilterApplied)\n\t\t{\n\t\t\tBX.addClass(this._filterButton, \"crm-entity-stream-filter-label-active\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.removeClass(this._filterButton, \"crm-entity-stream-filter-label-active\");\n\t\t}\n\t}\n\n\tshowFilter(params)\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._filterWrapper, \"crm-entity-stream-section-filter-hide\");\n\t\tBX.addClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\n\t\tthis._isFilterShown = true;\n\n\t\tif (BX.prop.getBoolean(params, \"enableAdjust\", true))\n\t\t{\n\t\t\tthis.adjustFilterButton();\n\t\t}\n\t}\n\n\thideFilter(params)\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\t\tBX.addClass(this._filterWrapper, \"crm-entity-stream-section-filter-hide\");\n\n\t\tthis._isFilterShown = false;\n\n\t\tif (BX.prop.getBoolean(params, \"enableAdjust\", true))\n\t\t{\n\t\t\tthis.adjustFilterButton();\n\t\t}\n\t}\n\n\tonFilterClose(e)\n\t{\n\t\tthis.hideFilter();\n\n\t\twindow.setTimeout(\n\t\t\tfunction () {\n\t\t\t\tconst filter = BX.Main.filterManager.getById(this._filterId);\n\t\t\t\tif (filter)\n\t\t\t\t{\n\t\t\t\t\tfilter.resetFilter();\n\t\t\t\t}\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\tcreateEmptySection()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-planned-label\"},\n\t\t\t\tchildren: [BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-content\"}})]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateCurrentDaySection()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today-label\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-today-label\"},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: this.formatDate(BX.prop.extractDate(new Date()))\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateDaySection(date)\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history-label\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-history-label\"},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: this.formatDate(date)\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tif (this._emptySection)\n\t\t{\n\t\t\tthis._emptySection = BX.remove(this._emptySection);\n\t\t}\n\n\t\tif (this._currentDaySection === null)\n\t\t{\n\t\t\tthis._currentDaySection = this.createCurrentDaySection();\n\t\t\tif (this._wrapper.firstChild)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._currentDaySection, this._wrapper.firstChild);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t}\n\t\t}\n\n\t\tif (this._anchor === null)\n\t\t{\n\t\t\tthis._anchor = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-shadow\"}});\n\t\t\tif (this._currentDaySection.nextSibling)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._anchor, this._currentDaySection.nextSibling);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._anchor);\n\t\t\t}\n\t\t}\n\t\treturn this._anchor;\n\t}\n\n\tcreateActivityItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_ID\", ItemType.undefined);\n\t\tconst typeCategoryId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tconst providerId = BX.prop.getString(\n\t\t\tBX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {}),\n\t\t\t\"PROVIDER_ID\",\n\t\t\t\"\"\n\t\t);\n\t\tconst vueComponentId = 'TYPE_' + typeCategoryId + (providerId ? '_' + providerId : '');\n\t\tconst vueComponentsMap = new Map([\n\t\t\t['TYPE_' + BX.CrmActivityType.provider + '_CRM_NOTIFICATION', BX.Crm.Timeline.Notification],\n\t\t\t['TYPE_' + BX.CrmActivityType.provider + '_CRM_DELIVERY', BX.Crm.Timeline.DeliveryActivity],\n\t\t]);\n\t\tconst vueComponent = vueComponentsMap.has(vueComponentId) ? vueComponentsMap.get(vueComponentId) : null;\n\n\t\tif (typeId !== ItemType.activity)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\treturn Email.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif (typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\treturn Call.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\treturn Meeting.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\treturn Task.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.provider)\n\t\t{\n\t\t\tif (providerId === \"CRM_WEBFORM\")\n\t\t\t{\n\t\t\t\treturn WebForm.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_SMS')\n\t\t\t{\n\t\t\t\treturn Sms.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data,\n\t\t\t\t\t\tsmsStatusDescriptions: this._manager.getSetting('smsStatusDescriptions', {}),\n\t\t\t\t\t\tsmsStatusSemantics: this._manager.getSetting('smsStatusSemantics', {}),\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_REQUEST')\n\t\t\t{\n\t\t\t\treturn Request.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === \"IMOPENLINES_SESSION\")\n\t\t\t{\n\t\t\t\treturn OpenLine.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'REST_APP')\n\t\t\t{\n\t\t\t\treturn Rest.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'VISIT_TRACKER')\n\t\t\t{\n\t\t\t\treturn Visit.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_DELIVERY')\n\t\t\t{\n\t\t\t\treturn HistoryActivity.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data,\n\t\t\t\t\t\tvueComponent: vueComponent,\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'ZOOM')\n\t\t\t{\n\t\t\t\treturn Zoom.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_CALL_TRACKER')\n\t\t\t{\n\t\t\t\treturn Call.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn HistoryActivity.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data,\n\t\t\t\tvueComponent: vueComponent,\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateOrderEntityItem(data)\n\t{\n\t\tconst entityId = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0);\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif (entityId !== BX.CrmEntityType.enumeration.order\n\t\t\t&& entityId !== BX.CrmEntityType.enumeration.orderpayment\n\t\t\t&& entityId !== BX.CrmEntityType.enumeration.ordershipment)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst settings = {\n\t\t\thistory: this._history,\n\t\t\tfixedHistory: this._fixedHistory,\n\t\t\tcontainer: this._wrapper,\n\t\t\tactivityEditor: this._activityEditor,\n\t\t\tdata: data\n\t\t};\n\n\t\tif (typeId === ItemType.creation)\n\t\t{\n\t\t\treturn OrderCreation.create(data[\"ID\"], settings);\n\t\t}\n\t\telse if (typeId === ItemType.modification)\n\t\t{\n\t\t\treturn OrderModification.create(data[\"ID\"], settings);\n\t\t}\n\t\telse if (typeId === OrderType.encourageBuyProducts)\n\t\t{\n\t\t\tsettings.vueComponent = BX.Crm.Timeline.EncourageBuyProducts;\n\t\t\treturn HistoryItem.create(data[\"ID\"], settings);\n\t\t}\n\t}\n\n\tcreateStoreDocumentItem(data)\n\t{\n\t\tconst entityId = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0);\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif (entityId !== BX.CrmEntityType.enumeration.storeDocument && entityId !== BX.CrmEntityType.enumeration.shipmentDocument)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst settings = {\n\t\t\thistory: this._history,\n\t\t\tfixedHistory: this._fixedHistory,\n\t\t\tcontainer: this._wrapper,\n\t\t\tactivityEditor: this._activityEditor,\n\t\t\tdata: data\n\t\t};\n\n\t\tif (typeId === ItemType.creation)\n\t\t{\n\t\t\treturn StoreDocumentCreation.create(data[\"ID\"], settings);\n\t\t}\n\t\telse if (typeId === ItemType.modification)\n\t\t{\n\t\t\treturn StoreDocumentModification.create(data[\"ID\"], settings);\n\t\t}\n\t}\n\n\tcreateProductCompilationItem(data)\n\t{\n\t\tvar typeId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tvar entityId = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0);\n\t\tif(entityId !== BX.CrmEntityType.enumeration.deal)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tvar settings = {\n\t\t\thistory: this._history,\n\t\t\tfixedHistory: this._fixedHistory,\n\t\t\tcontainer: this._wrapper,\n\t\t\tactivityEditor: this._activityEditor,\n\t\t\tdata: data\n\t\t};\n\n\t\tif (typeId === CompilationType.productList)\n\t\t{\n\t\t\tsettings.vueComponent = BX.Crm.Timeline.ProductCompilationList;\n\t\t}\n\t\telse if (typeId === CompilationType.orderExists)\n\t\t{\n\t\t\tsettings.vueComponent = BX.Crm.Timeline.CompilationOrderNotice;\n\t\t}\n\t\telse if (typeId === CompilationType.compilationViewed)\n\t\t{\n\t\t\tsettings.vueComponent = BX.Crm.Timeline.ProductCompilationViewed;\n\t\t}\n\t\telse if (typeId === CompilationType.newDealCreated)\n\t\t{\n\t\t\tsettings.vueComponent = BX.Crm.Timeline.NewDealCreated;\n\t\t}\n\n\t\treturn BX.CrmHistoryItem.create(data[\"ID\"], settings);\n\t}\n\n\tcreateExternalNotificationItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tconst changedFieldName = BX.prop.getString(data, 'CHANGED_FIELD_NAME', '');\n\n\t\tif (typeId === ItemType.modification && changedFieldName === 'STATUS_ID')\n\t\t{\n\t\t\treturn ExternalNoticeStatusModification.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn ExternalNoticeModification.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateDeliveryItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_ID\", ItemType.undefined);\n\t\tconst typeCategoryId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\n\t\tif (typeId !== ItemType.delivery)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst vueComponentsMap = new Map([\n\t\t\t[DeliveryType.taxiEstimationRequest, BX.Crm.Delivery.Taxi.EstimationRequest],\n\t\t\t[DeliveryType.taxiCallRequest, BX.Crm.Delivery.Taxi.CallRequest],\n\t\t\t[DeliveryType.taxiCancelledByManager, BX.Crm.Delivery.Taxi.CancelledByManager],\n\t\t\t[DeliveryType.taxiCancelledByDriver, BX.Crm.Delivery.Taxi.CancelledByDriver],\n\t\t\t[DeliveryType.taxiPerformerNotFound, BX.Crm.Delivery.Taxi.PerformerNotFound],\n\t\t\t[DeliveryType.taxiSmsProviderIssue, BX.Crm.Delivery.Taxi.SmsProviderIssue],\n\t\t\t[DeliveryType.taxiReturnedFinish, BX.Crm.Delivery.Taxi.ReturnedFinish],\n\t\t\t[DeliveryType.deliveryMessage, BX.Crm.Timeline.DeliveryMessage],\n\t\t\t[DeliveryType.deliveryCalculation, BX.Crm.Timeline.DeliveryCalculation]\n\t\t]);\n\n\t\tif (vueComponentsMap.has(typeCategoryId))\n\t\t{\n\t\t\treturn HistoryItem.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data,\n\t\t\t\t\tvueComponent: vueComponentsMap.get(typeCategoryId),\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tcreateItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_ID\", ItemType.undefined);\n\t\tconst typeCategoryId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\n\t\tif (typeId === ItemType.activity)\n\t\t{\n\t\t\treturn this.createActivityItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.order)\n\t\t{\n\t\t\treturn this.createOrderEntityItem(data);\n\t\t}\n\t\telse if(typeId === ItemType.productCompilation)\n\t\t{\n\t\t\treturn this.createProductCompilationItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.storeDocument)\n\t\t{\n\t\t\treturn this.createStoreDocumentItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.externalNotification)\n\t\t{\n\t\t\treturn this.createExternalNotificationItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.orderCheck)\n\t\t{\n\t\t\treturn OrderCheck.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.finalSummary)\n\t\t{\n\t\t\treturn FinalSummary.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.finalSummaryDocuments)\n\t\t{\n\t\t\treturn FinalSummaryDocuments.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.creation)\n\t\t{\n\t\t\treturn Creation.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.restoration)\n\t\t{\n\t\t\treturn Restoration.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.link)\n\t\t{\n\t\t\treturn Link.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.unlink)\n\t\t{\n\t\t\treturn Unlink.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.mark)\n\t\t{\n\t\t\treturn Mark.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.comment)\n\t\t{\n\t\t\treturn Comment.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.wait)\n\t\t{\n\t\t\treturn Wait.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.document)\n\t\t{\n\t\t\treturn Document.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.sender)\n\t\t{\n\t\t\treturn Sender.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.modification)\n\t\t{\n\t\t\treturn Modification.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.conversion)\n\t\t{\n\t\t\treturn Conversion.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.bizproc)\n\t\t{\n\t\t\treturn Bizproc.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.scoring)\n\t\t{\n\t\t\treturn Scoring.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.delivery)\n\t\t{\n\t\t\treturn this.createDeliveryItem(data);\n\t\t}\n\n\t\treturn HistoryItem.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data\n\t\t\t}\n\t\t);\n\t}\n\n\taddItem(item, index)\n\t{\n\t\tif (!BX.type.isNumber(index) || index < 0)\n\t\t{\n\t\t\tindex = this.calculateItemIndex(item);\n\t\t}\n\n\t\tif (index < this._items.length)\n\t\t{\n\t\t\tthis._items.splice(index, 0, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._items.push(item);\n\t\t}\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\tdeleteItem(item)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif (index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.clearLayout();\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\tresetLayout()\n\t{\n\t\tlet i;\n\n\t\tfor (i = (this._items.length - 1); i >= 0; i--)\n\t\t{\n\t\t\tthis._items[i].clearLayout();\n\t\t}\n\n\t\tthis._items = [];\n\n\t\tthis._currentDaySection = this._lastDaySection = this._emptySection = this._filterEmptyResultSection = null;\n\t\tthis._anchor = null;\n\t\tthis._lastDate = null;\n\n\t\t//Clean wrapper. Skip filter for prevent trembling.\n\t\tconst children = [];\n\t\tlet child;\n\t\tfor (i = 0; child = this._wrapper.children[i]; i++)\n\t\t{\n\t\t\tif (child !== this._filterWrapper)\n\t\t\t{\n\t\t\t\tchildren.push(child);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; child = children[i]; i++)\n\t\t{\n\t\t\tthis._wrapper.removeChild(child);\n\t\t}\n\t}\n\n\tonWindowScroll(e)\n\t{\n\t\tif (!this._loadingWaiter || !this._enableLoading || this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pos = this._loadingWaiter.getBoundingClientRect();\n\t\tif (pos.top <= document.documentElement.clientHeight)\n\t\t{\n\t\t\tthis.loadItems();\n\t\t}\n\t}\n\n\tonFilterApply(id, data, ctx, promise, params)\n\t{\n\t\tif (id !== this._filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams.autoResolve = false;\n\t\tthis._isFilterApplied = BX.prop.getString(data, \"action\", \"\") === \"apply\";\n\t\tthis._isRequestRunning = true;\n\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"GUID\": this._id,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId()\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(\n\t\t\tfunction (sender, result) {\n\t\t\t\tthis.resetLayout();\n\t\t\t\tthis.bulkCreateItems(BX.prop.getArray(result, \"HISTORY_ITEMS\", []));\n\t\t\t\tthis.setNavigation(BX.prop.getObject(result, \"HISTORY_NAVIGATION\", {}));\n\n\t\t\t\tthis.refreshLayout();\n\t\t\t\tif (this._items.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis._manager.processHistoryLayoutChange();\n\t\t\t\t}\n\n\t\t\t\tpromise.fulfill();\n\t\t\t\tthis._isRequestRunning = false;\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tbulkCreateItems(itemData)\n\t{\n\t\tconst length = itemData.length;\n\t\tif (length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterEmptyResultSection)\n\t\t{\n\t\t\tthis._filterEmptyResultSection = BX.remove(this._filterEmptyResultSection);\n\t\t}\n\n\t\tconst now = BX.prop.extractDate(new Date());\n\t\tlet i, item;\n\t\tlet lastItemTime = \"\";\n\t\tfor (i = 0; i < length; i++)\n\t\t{\n\t\t\tconst itemId = BX.prop.getInteger(itemData[i], \"ID\", 0);\n\t\t\tif (itemId <= 0)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlastItemTime = BX.prop.getString(itemData[i], \"CREATED_SERVER\", \"\");\n\t\t\tif (this.findItemById(itemId) !== null)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\titem = this.createItem(itemData[i]);\n\t\t\tthis._items.push(item);\n\n\t\t\tconst created = item.getCreatedDate();\n\t\t\tif (this._lastDate === null || this._lastDate.getTime() !== created.getTime())\n\t\t\t{\n\t\t\t\tthis._lastDate = created;\n\t\t\t\tif (now.getTime() === created.getTime())\n\t\t\t\t{\n\t\t\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._lastDaySection = this.createDaySection(this._lastDate);\n\t\t\t\t\tthis._wrapper.appendChild(this._lastDaySection);\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.layout();\n\t\t}\n\t}\n\n\tloadItems()\n\t{\n\t\tthis._isRequestRunning = true;\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"GUID\": this._id,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId(),\n\t\t\t\t\t\t\"NAVIGATION\": this._navigation\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(\n\t\t\tfunction (sender, result) {\n\t\t\t\tthis.bulkCreateItems(BX.prop.getArray(result, \"HISTORY_ITEMS\", []));\n\t\t\t\tthis.setNavigation(BX.prop.getObject(result, \"HISTORY_NAVIGATION\", {}));\n\n\t\t\t\tthis.refreshLayout();\n\t\t\t\tif (this._items.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis._manager.processHistoryLayoutChange();\n\t\t\t\t}\n\n\t\t\t\tthis._isRequestRunning = false;\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tgetNavigation()\n\t{\n\t\treturn this._navigation;\n\t}\n\n\tsetNavigation(navigation)\n\t{\n\t\tif (!BX.type.isPlainObject(navigation))\n\t\t{\n\t\t\tnavigation = {};\n\t\t}\n\n\t\tthis._navigation = navigation;\n\t\tthis.enableLoading(\n\t\t\tBX.prop.getString(this._navigation, \"OFFSET_TIMESTAMP\", \"\") !== \"\"\n\t\t);\n\t}\n\n\tisLoadingEnabled()\n\t{\n\t\treturn this._enableLoading;\n\t}\n\n\tenableLoading(enable)\n\t{\n\t\tenable = !!enable;\n\n\t\tif (this._enableLoading === enable)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._enableLoading = enable;\n\n\t\tif (this._enableLoading)\n\t\t{\n\t\t\tif (this._items.length > 0)\n\t\t\t{\n\t\t\t\tthis._loadingWaiter = this._items[this._items.length - 1].getWrapper();\n\t\t\t}\n\n\t\t\tif (!this._scrollHandler)\n\t\t\t{\n\t\t\t\tthis._scrollHandler = BX.delegate(this.onWindowScroll, this);\n\t\t\t\tBX.bind(window, \"scroll\", this._scrollHandler);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._loadingWaiter = null;\n\n\t\t\tif (this._scrollHandler)\n\t\t\t{\n\t\t\t\tBX.unbind(window, \"scroll\", this._scrollHandler);\n\t\t\t\tthis._scrollHandler = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = History.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new History();\n\t\tself.initialize(id, settings);\n\t\tHistory.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n\tstatic instances = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class FixedHistory extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._wrapper = null;\n\t\tthis._fixedHistory = this;\n\t\tthis._history = this;\n\t\tthis._isRequestRunning = false;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tconst datetimeFormat = BX.message(\"FORMAT_DATETIME\").replace(/:SS/, \"\");\n\t\tthis._timeFormat = BX.date.convertBitrixFormat(datetimeFormat);\n\n\t\tlet itemData = this.getSetting(\"itemData\");\n\t\tif(!BX.type.isArray(itemData))\n\t\t{\n\t\t\titemData = [];\n\t\t}\n\n\t\tlet i, length, item;\n\t\tfor(i = 0, length = itemData.length; i < length; i++)\n\t\t{\n\t\t\titem = this.createItem(itemData[i]);\n\t\t\titem._isFixed = true;\n\t\t\tthis._items.push(item);\n\t\t}\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\treturn false;\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis.createAnchor();\n\t\tthis._container.insertBefore(this._wrapper,  this._editorContainer.nextElementSibling);\n\n\t\tfor (let i = 0; i < this._items.length; i++)\n\t\t{\n\t\t\tthis._items[i].setContainer(this._wrapper);\n\t\t\tthis._items[i].layout();\n\t\t}\n\n\t\tthis.refreshLayout();\n\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t}\n\n\tformatDate(date)\n\t{\n\t}\n\n\tcreateCurrentDaySection()\n\t{\n\t}\n\n\tcreateDaySection(date)\n\t{\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tthis._anchor = BX.create(\"DIV\", { attrs:{className: \"crm-entity-stream-section-fixed-anchor\"} });\n\t\tthis._wrapper.appendChild(this._anchor);\n\t}\n\n\tonWindowScroll(e)\n\t{\n\t}\n\n\tonItemsLoad(sender, result)\n\t{\n\t}\n\n\tloadItems()\n\t{\n\t\tthis._isRequestRunning = true;\n\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_FIXED_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"OWNER_TYPE_ID\" : this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId(),\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(BX.delegate(this.onItemsLoad, this));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tlet self = new FixedHistory();\n\t\tself.initialize(id, settings);\n\t\tthis.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n}\n\nFixedHistory.instances = {};\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Expand\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._callback = null;\n\t}\n\n\tinitialize(node, callback)\n\t{\n\t\tthis._node = node;\n\t\tthis._callback = BX.type.isFunction(callback) ? callback : null;\n\t}\n\n\trun()\n\t{\n\t\tconst position = BX.pos(this._node);\n\n\t\tthis._node.style.height = 0;\n\t\tthis._node.style.opacity = 0;\n\t\tthis._node.style.overflow = \"hidden\";\n\n\t\t(new BX.easing(\n\t\t\t\t{\n\t\t\t\t\tduration : 150,\n\t\t\t\t\tstart : { height: 0 },\n\t\t\t\t\tfinish: { height: position.height },\n\t\t\t\t\ttransition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\tstep: BX.delegate(this.onNodeHeightStep, this),\n\t\t\t\t\tcomplete: BX.delegate(this.onNodeHeightComplete, this)\n\t\t\t\t}\n\t\t\t)\n\t\t).animate();\n\t}\n\n\tonNodeHeightStep(state)\n\t{\n\t\tthis._node.style.height = state.height + \"px\";\n\t}\n\n\tonNodeHeightComplete()\n\t{\n\t\tthis._node.style.overflow = \"\";\n\t\t(new BX.easing(\n\t\t\t\t{\n\t\t\t\t\tduration : 150,\n\t\t\t\t\tstart : { opacity: 0 },\n\t\t\t\t\tfinish: { opacity: 100 },\n\t\t\t\t\ttransition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\tstep: BX.delegate(this.onNodeOpacityStep, this),\n\t\t\t\t\tcomplete: BX.delegate(this.onNodeOpacityComplete, this)\n\t\t\t\t}\n\t\t\t)\n\t\t).animate();\n\t}\n\n\tonNodeOpacityStep(state)\n\t{\n\t\tthis._node.style.opacity = state.opacity / 100;\n\t}\n\n\tonNodeOpacityComplete()\n\t{\n\t\tthis._node.style.height = \"\";\n\t\tthis._node.style.opacity = \"\";\n\t\tif(this._callback)\n\t\t{\n\t\t\tthis._callback();\n\t\t}\n\t}\n\n\tstatic create(node, callback)\n\t{\n\t\tconst self = new Expand();\n\t\tself.initialize(node, callback);\n\t\treturn self;\n\t}\n}\n","import Wait from \"./editors/wait\";\nimport Sms from \"./editors/sms\";\nimport Rest from \"./editors/rest\";\nimport Comment from \"./editors/comment\";\nimport Scheduled from \"./items/scheduled\";\nimport Item from \"./item\";\nimport Document from \"./items/document\";\nimport EntityChat from \"./streams/entitychat\";\nimport MenuBar from \"./tools/menubar\";\nimport AudioPlaybackRateSelector from \"./tools/audio-playback-rate-selector\";\nimport Schedule from \"./streams/schedule\";\nimport FixedHistory from \"./streams/fixedhistory\";\nimport History from \"./streams/history\";\nimport Expand from \"./animations/expand\";\n\n/** @memberof BX.Crm.Timeline */\nexport default class Manager\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t\tthis._ownerTypeId = 0;\n\t\tthis._ownerId = 0;\n\t\tthis._ownerInfo = null;\n\t\tthis._progressSemantics = \"\";\n\n\t\tthis._commentEditor = null;\n\t\tthis._waitEditor = null;\n\t\tthis._smsEditor = null;\n\t\tthis._zoomEditor = null;\n\t\tthis._chat = null;\n\t\tthis._schedule = null;\n\t\tthis._history = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._activityEditor = null;\n\t\tthis._menuBar = null;\n\n\t\tthis._userId = 0;\n\t\tthis._readOnly = false;\n\t\tthis._pullTagName = \"\";\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._ownerTypeId = parseInt(this.getSetting(\"ownerTypeId\"));\n\t\tthis._ownerId = parseInt(this.getSetting(\"ownerId\"));\n\t\tthis._ownerInfo = this.getSetting(\"ownerInfo\");\n\t\tthis._progressSemantics = BX.prop.getString(this._settings, \"progressSemantics\", \"\");\n\t\tthis._spotlightFastenShowed = this.getSetting(\"spotlightFastenShowed\", true);\n\t\tthis._audioPlaybackRate = parseFloat(this.getSetting(\"audioPlaybackRate\", 1));\n\t\tconst containerId = this.getSetting(\"containerId\");\n\t\tif (!BX.type.isNotEmptyString(containerId))\n\t\t{\n\t\t\tthrow \"Manager. A required parameter 'containerId' is missing.\";\n\t\t}\n\n\t\tthis._container = BX(containerId);\n\t\tif (!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Manager. Container node is not found.\";\n\t\t}\n\t\tthis._editorContainer = BX(this.getSetting(\"editorContainer\"));\n\n\t\tthis._userId = BX.prop.getInteger(this._settings, \"userId\", 0);\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\n\t\tconst activityEditorId = this.getSetting(\"activityEditorId\");\n\t\tif (BX.type.isNotEmptyString(activityEditorId))\n\t\t{\n\t\t\tthis._activityEditor = BX.CrmActivityEditor.items[activityEditorId];\n\t\t\tif (!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t\t{\n\t\t\t\tthrow \"BX.CrmTimeline. Activity editor instance is not found.\";\n\t\t\t}\n\t\t}\n\n\t\tconst ajaxId = this.getSetting(\"ajaxId\");\n\t\tconst currentUrl = this.getSetting(\"currentUrl\");\n\t\tconst serviceUrl = this.getSetting(\"serviceUrl\");\n\n\t\tthis._chat = EntityChat.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tdata: this.getSetting(\"chatData\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._schedule = Schedule.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"scheduleData\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._fixedHistory = FixedHistory.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\teditorContainer: this._editorContainer,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"fixedData\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._history = History.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"historyData\"),\n\t\t\t\tnavigation: this.getSetting(\"historyNavigation\", {}),\n\t\t\t\tfilterId: BX.prop.getString(this._settings, \"historyFilterId\", this._id),\n\t\t\t\tisFilterApplied: BX.prop.getBoolean(this._settings, \"isHistoryFilterApplied\", false),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\t\tthis._schedule.setHistory(this._history);\n\t\tthis._fixedHistory.setHistory(this._history);\n\n\t\tthis._commentEditor = Comment.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\townerId: this._ownerId,\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\"),\n\t\t\t\tcontainer: this.getSetting(\"editorCommentContainer\"),\n\t\t\t\tinput: this.getSetting(\"editorCommentInput\"),\n\t\t\t\teditorName: this.getSetting(\"editorCommentEditorName\"),\n\t\t\t\tbutton: this.getSetting(\"editorCommentButton\"),\n\t\t\t\tcancelButton: this.getSetting(\"editorCommentCancelButton\")\n\t\t\t}\n\t\t);\n\t\tthis._commentEditor.setVisible(true);\n\t\tthis._commentEditor.setHistory(this._history);\n\n\t\tif (this._readOnly)\n\t\t{\n\t\t\tthis._commentEditor.setVisible(false);\n\t\t}\n\n\t\tif (BX.prop.getBoolean(this._settings, \"enableWait\", false))\n\t\t{\n\t\t\tthis._waitEditor = Wait.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\"),\n\t\t\t\t\tconfig: this.getSetting(\"editorWaitConfig\", {}),\n\t\t\t\t\ttargetDates: this.getSetting(\"editorWaitTargetDates\", []),\n\t\t\t\t\tcontainer: this.getSetting(\"editorWaitContainer\"),\n\t\t\t\t\tconfigContainer: this.getSetting(\"editorWaitConfigContainer\"),\n\t\t\t\t\tinput: this.getSetting(\"editorWaitInput\"),\n\t\t\t\t\tbutton: this.getSetting(\"editorWaitButton\"),\n\t\t\t\t\tcancelButton: this.getSetting(\"editorWaitCancelButton\")\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._waitEditor.setVisible(false);\n\t\t}\n\n\t\tif (BX.prop.getBoolean(this._settings, \"enableSms\", false))\n\t\t{\n\t\t\tthis._smsEditor = Sms.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\"),\n\t\t\t\t\tconfig: this.getSetting(\"editorSmsConfig\", {}),\n\t\t\t\t\tcontainer: this.getSetting(\"editorSmsContainer\"),\n\t\t\t\t\tinput: this.getSetting(\"editorSmsInput\"),\n\t\t\t\t\ttemplatesContainer: this.getSetting(\"editorSmsTemplatesContainer\"),\n\t\t\t\t\tbutton: this.getSetting(\"editorSmsButton\"),\n\t\t\t\t\tcancelButton: this.getSetting(\"editorSmsCancelButton\")\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._smsEditor.setVisible(false);\n\t\t}\n\n\t\tif (BX.prop.getBoolean(this._settings, \"enableZoom\", false) && BX.prop.getBoolean(this._settings, \"statusZoom\", false))\n\t\t{\n\t\t\tthis._zoomEditor = new BX.Crm.Zoom(\n\t\t\t\t{\n\t\t\t\t\tid: this._id,\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tcontainer: this.getSetting(\"editorZoomContainer\"),\n\t\t\t\t\tuserId: this._userId\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis._zoomEditor.setVisible(false);\n\t\t}\n\n\t\tif (BX.prop.getBoolean(this._settings, \"enableRest\", false))\n\t\t{\n\t\t\tthis._restEditor = Rest.create(\n\t\t\t\tthis._id,\n\t\t\t\t{\n\t\t\t\t\tmanager: this,\n\t\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\t\townerId: this._ownerId,\n\t\t\t\t\tplacement: BX.prop.getString(this._settings, \"restPlacement\", '')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis._chat.layout();\n\t\tthis._schedule.layout();\n\t\tthis._fixedHistory.layout();\n\t\tthis._history.layout();\n\n\t\tthis._pullTagName = BX.prop.getString(this._settings, \"pullTagName\", \"\");\n\t\tif (this._pullTagName !== \"\")\n\t\t{\n\t\t\tBX.addCustomEvent(\"onPullEvent-crm\", BX.delegate(this.onPullEvent, this));\n\t\t\tthis.extendWatch();\n\t\t}\n\t\tthis._menuBar = MenuBar.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tcontainer: BX(this.getSetting(\"menuBarContainer\")),\n\t\t\t\tmenuId: this.getSetting(\"menuBarObjectId\"),\n\t\t\t\townerInfo: this._ownerInfo,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tcommentEditor: this._commentEditor,\n\t\t\t\twaitEditor: this._waitEditor,\n\t\t\t\tsmsEditor: this._smsEditor,\n\t\t\t\tzoomEditor: this._zoomEditor,\n\t\t\t\trestEditor: this._restEditor,\n\t\t\t\treadOnly: this._readOnly,\n\t\t\t\tmanager: this\n\t\t\t}\n\t\t);\n\n\t\tif (!this._readOnly)\n\t\t{\n\t\t\tthis._menuBar.reset();\n\t\t}\n\n\t\tBX.addCustomEvent(window, \"Crm.EntityProgress.Change\", BX.delegate(this.onEntityProgressChange, this));\n\t\tBX.ready(function () {\n\t\t\twindow.addEventListener(\"scroll\", BX.throttle(function () {\n\t\t\t\tBX.LazyLoad.onScroll();\n\t\t\t}, 80));\n\t\t});\n\t}\n\n\textendWatch()\n\t{\n\t\tif (BX.type.isFunction(BX.PULL) && this._pullTagName !== \"\")\n\t\t{\n\t\t\tBX.PULL.extendWatch(this._pullTagName);\n\t\t\twindow.setTimeout(BX.delegate(this.extendWatch, this), 60000);\n\t\t}\n\t}\n\n\tonPullEvent(command, params)\n\t{\n\t\tif (this._pullTagName !== BX.prop.getString(params, \"TAG\", \"\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (command === \"timeline_chat_create\")\n\t\t{\n\t\t\tthis.processChatCreate(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_add\")\n\t\t{\n\t\t\tthis.processActivityExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_update\")\n\t\t{\n\t\t\tthis.processActivityExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_delete\")\n\t\t{\n\t\t\tthis.processActivityExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_add\")\n\t\t{\n\t\t\tthis.processCommentExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_link_add\")\n\t\t{\n\t\t\tthis.processLinkExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_link_delete\")\n\t\t{\n\t\t\tthis.processLinkExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_document_add\")\n\t\t{\n\t\t\tthis.processLinkExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_document_update\")\n\t\t{\n\t\t\tthis.processDocumentExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_document_delete\")\n\t\t{\n\t\t\tthis.processDocumentExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_update\")\n\t\t{\n\t\t\tthis.processCommentExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_delete\")\n\t\t{\n\t\t\tthis.processCommentExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_changed_binding\")\n\t\t{\n\t\t\tthis.processChangeBinding(params);\n\t\t}\n\t\telse if (command === \"timeline_item_change_fasten\")\n\t\t{\n\t\t\tthis.processItemChangeFasten(params);\n\t\t}\n\t\telse if (command === \"timeline_item_update\")\n\t\t{\n\t\t\tthis.processItemExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_add\")\n\t\t{\n\t\t\tthis.processWaitExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_update\")\n\t\t{\n\t\t\tthis.processWaitExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_delete\")\n\t\t{\n\t\t\tthis.processWaitExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_bizproc_status\")\n\t\t{\n\t\t\tthis.processBizprocStatus(params);\n\t\t}\n\t\telse if (command === \"timeline_scoring_add\")\n\t\t{\n\t\t\tthis.processScoringExternalAdd(params);\n\t\t}\n\t}\n\n\tprocessChatCreate(params)\n\t{\n\t\tif (this._chat)\n\t\t{\n\t\t\tthis._chat.setData(BX.prop.getObject(params, \"CHAT_DATA\", {}));\n\t\t\tthis._chat.refreshLayout();\n\t\t}\n\t}\n\n\tprocessActivityExternalAdd(params)\n\t{\n\t\tlet entityData, scheduleItemData, historyItemData, scheduleItem, historyItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\n\t\tif (entityData && historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t{\n\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t}\n\n\t\tif (scheduleItemData !== null && this._schedule.getItemByData(scheduleItemData) === null)\n\t\t{\n\t\t\tscheduleItem = this.addScheduleItem(scheduleItemData);\n\t\t\tscheduleItem.addWrapperClass(\"crm-entity-stream-section-updated\", 1000);\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessActivityExternalUpdate(params)\n\t{\n\t\tlet entityData, scheduleItemData, scheduleItem, historyItemData, historyItem, fixedHistoryItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (entityData)\n\t\t{\n\t\t\tif (historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t\t{\n\t\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t\t}\n\n\t\t\tconst entityId = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\t\tfor (let i = 0, length = historyItems.length; i < length; i++)\n\t\t\t{\n\t\t\t\thistoryItem = historyItems[i];\n\t\t\t\thistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t\tconst fixedHistoryItems = this._fixedHistory.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\t\tfor (let i = 0, length = fixedHistoryItems.length; i < length; i++)\n\t\t\t{\n\t\t\t\tfixedHistoryItem = fixedHistoryItems[i];\n\t\t\t\tfixedHistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\tfixedHistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tscheduleItem = this._schedule.getItemByAssociatedEntity(\n\t\t\t\tBX.CrmEntityType.enumeration.activity,\n\t\t\t\tBX.prop.getInteger(scheduleItemData, \"ASSOCIATED_ENTITY_ID\")\n\t\t\t);\n\n\t\t\tif (scheduleItem)\n\t\t\t{\n\t\t\t\tscheduleItem.setData(scheduleItemData);\n\t\t\t\tif (!scheduleItem.isDone())\n\t\t\t\t{\n\t\t\t\t\tthis._schedule.refreshItem(scheduleItem);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (historyItemData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.transferItemToHistory(\n\t\t\t\t\t\t\tscheduleItem,\n\t\t\t\t\t\t\thistoryItemData\n\t\t\t\t\t\t);\n\t\t\t\t\t\t//History data are already processed\n\t\t\t\t\t\thistoryItemData = null;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!Scheduled.isDone(scheduleItemData))\n\t\t\t{\n\t\t\t\tscheduleItem = this.addScheduleItem(scheduleItemData);\n\t\t\t\tscheduleItem.addWrapperClass(\"crm-entity-stream-section-updated\", 1000);\n\t\t\t}\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thistoryItem.setData(historyItemData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t\tfixedHistoryItem = this._fixedHistory.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\t\tif (fixedHistoryItem)\n\t\t\t\t{\n\t\t\t\t\tfixedHistoryItem.setData(historyItemData);\n\t\t\t\t\tfixedHistoryItem.refreshLayout()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessActivityExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tfor (let i = 0, length = historyItems.length; i < length; i++)\n\t\t{\n\t\t\tthis._history.deleteItem(historyItems[i]);\n\t\t}\n\n\t\tconst fixedHistoryItems = this._fixedHistory.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tfor (let i = 0, length = fixedHistoryItems.length; i < length; i++)\n\t\t{\n\t\t\tthis._fixedHistory.deleteItem(fixedHistoryItems[i]);\n\t\t}\n\n\t\tconst scheduleItem = this._schedule.getItemByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tif (scheduleItem)\n\t\t{\n\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t}\n\t}\n\n\tprocessCommentExternalAdd(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\twindow.setTimeout(\n\t\t\t\tBX.delegate(function () {\n\t\t\t\t\tif (!this._history.findItemById(historyItemData['ID']))\n\t\t\t\t\t{\n\t\t\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t\t\t}\n\t\t\t\t}, this),\n\t\t\t\t1500\n\t\t\t);\n\t\t}\n\t}\n\n\tprocessLinkExternalAdd(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t}\n\t}\n\n\tprocessLinkExternalDelete(params)\n\t{\n\t\tthis.processLinkExternalAdd(params);\n\t}\n\n\tprocessCommentExternalUpdate(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tconst updateItem = this._history.findItemById(entityId);\n\t\tif (updateItem instanceof Comment && historyItemData !== null)\n\t\t{\n\t\t\tupdateItem.setData(historyItemData);\n\t\t\tupdateItem.switchToViewMode();\n\t\t}\n\t\tconst updateFixedItem = this._fixedHistory.findItemById(entityId);\n\t\tif (updateFixedItem instanceof Comment && historyItemData !== null)\n\t\t{\n\t\t\tupdateFixedItem.setData(historyItemData);\n\t\t\tupdateFixedItem.switchToViewMode();\n\t\t}\n\t}\n\n\tprocessCommentExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\twindow.setTimeout(\n\t\t\tBX.delegate(function () {\n\t\t\t\tconst deleteItem = this._history.findItemById(entityId);\n\t\t\t\tif (deleteItem instanceof Comment)\n\t\t\t\t{\n\t\t\t\t\tthis._history.deleteItem(deleteItem);\n\t\t\t\t}\n\t\t\t\tconst deleteFixedItem = this._fixedHistory.findItemById(entityId);\n\t\t\t\tif (deleteFixedItem instanceof Comment)\n\t\t\t\t{\n\t\t\t\t\tthis._fixedHistory.deleteItem(deleteFixedItem);\n\t\t\t\t}\n\t\t\t}, this),\n\t\t\t1200\n\t\t);\n\t}\n\n\tprocessDocumentExternalDelete(params)\n\t{\n\t\twindow.setTimeout(\n\t\t\tBX.delegate(function () {\n\t\t\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\t\t\tlet i, length;\n\t\t\t\tconst associatedEntityId = BX.prop.getInteger(historyItemData, \"ASSOCIATED_ENTITY_ID\", 0);\n\t\t\t\tlet historyItems = this._history.getItemsByAssociatedEntity(\n\t\t\t\t\tBX.CrmEntityType.enumeration.document,\n\t\t\t\t\tassociatedEntityId\n\t\t\t\t);\n\t\t\t\tfor (i = 0, length = historyItems.length; i < length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (historyItems[i] instanceof Document)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._history.deleteItem(historyItems[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\thistoryItems = this._fixedHistory.getItemsByAssociatedEntity(\n\t\t\t\t\tBX.CrmEntityType.enumeration.document,\n\t\t\t\t\tassociatedEntityId\n\t\t\t\t);\n\t\t\t\tfor (i = 0, length = historyItems.length; i < length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (historyItems[i] instanceof Document)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._fixedHistory.deleteItem(historyItems[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, this),\n\t\t\t100\n\t\t);\n\t}\n\n\tprocessDocumentExternalUpdate(params)\n\t{\n\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tconst id = BX.prop.getInteger(historyItemData, \"ID\", 0);\n\t\tconst updateItem = this._history.findItemById(id);\n\t\tif (updateItem instanceof Document && historyItemData !== null)\n\t\t{\n\t\t\tupdateItem.setData(historyItemData);\n\t\t\tupdateItem.updateWrapper();\n\t\t}\n\t\tconst updateFixedItem = this._fixedHistory.findItemById(id);\n\t\tif (updateFixedItem instanceof Document && historyItemData !== null)\n\t\t{\n\t\t\tupdateFixedItem.setData(historyItemData);\n\t\t\tupdateFixedItem.updateWrapper();\n\t\t}\n\t}\n\n\tprocessChangeBinding(params)\n\t{\n\t\tconst entityId = BX.prop.getString(params, \"OLD_ID\", 0);\n\t\tconst entityNewId = BX.prop.getString(params, \"NEW_ID\", 0);\n\t\tconst item = this._history.findItemById(entityId);\n\t\tif (item instanceof Item)\n\t\t{\n\t\t\titem._id = entityNewId;\n\t\t\tconst itemData = item.getData();\n\t\t\titemData.ID = entityNewId;\n\t\t\titem.setData(itemData);\n\t\t}\n\n\t\tconst fixedItem = this._fixedHistory.findItemById(entityId);\n\t\tif (fixedItem instanceof Item)\n\t\t{\n\t\t\tfixedItem._id = entityNewId;\n\t\t\tconst fixedItemData = fixedItem.getData();\n\t\t\tfixedItemData.ID = entityNewId;\n\t\t\tfixedItem.setData(fixedItemData);\n\t\t}\n\t}\n\n\tprocessItemChangeFasten(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\twindow.setTimeout(\n\t\t\tBX.delegate(function () {\n\t\t\t\tconst fixedItem = this._fixedHistory.findItemById(entityId);\n\t\t\t\tif (historyItemData['IS_FIXED'] === 'N' && fixedItem)\n\t\t\t\t{\n\t\t\t\t\tfixedItem.onSuccessUnfasten();\n\t\t\t\t}\n\t\t\t\telse if (historyItemData['IS_FIXED'] === 'Y' && !fixedItem)\n\t\t\t\t{\n\t\t\t\t\tconst historyItem = this._history.findItemById(entityId);\n\t\t\t\t\tif (historyItem)\n\t\t\t\t\t{\n\t\t\t\t\t\thistoryItem.onSuccessFasten();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst newFixedItem = this._fixedHistory.createItem(this._data);\n\t\t\t\t\t\tnewFixedItem._isFixed = true;\n\t\t\t\t\t\tthis._fixedHistory.addItem(newFixedItem, 0);\n\t\t\t\t\t\tnewFixedItem.layout();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, this),\n\t\t\t1200\n\t\t);\n\t}\n\n\tprocessItemExternalUpdate(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tconst historyItem = this._history.findItemById(entityId);\n\t\tif (historyItem && historyItemData !== null)\n\t\t{\n\t\t\thistoryItem.setData(historyItemData);\n\t\t\thistoryItem.markAsTerminated(this._history.checkItemForTermination(historyItem));\n\t\t\thistoryItem.refreshLayout();\n\t\t\tif (historyItem.isTerminated())\n\t\t\t{\n\t\t\t\tBX.addClass(historyItem._wrapper, \"crm-entity-stream-section-last\");\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessWaitExternalAdd(params)\n\t{\n\t\tconst scheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tthis.addScheduleItem(scheduleItemData);\n\t\t}\n\t}\n\n\tprocessWaitExternalUpdate(params)\n\t{\n\t\tlet entityData, scheduleItemData, scheduleItem, historyItemData, historyItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (entityData)\n\t\t{\n\t\t\tif (historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t\t{\n\t\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t\t}\n\n\t\t\tconst entityId = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\t\tlet i = 0;\n\t\t\tconst length = historyItems.length;\n\t\t\tfor (; i < length; i++)\n\t\t\t{\n\t\t\t\thistoryItem = historyItems[i];\n\t\t\t\thistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tscheduleItem = this._schedule.getItemByAssociatedEntity(\n\t\t\t\tBX.CrmEntityType.enumeration.wait,\n\t\t\t\tBX.prop.getInteger(scheduleItemData, \"ASSOCIATED_ENTITY_ID\")\n\t\t\t);\n\t\t\tif (!scheduleItem)\n\t\t\t{\n\t\t\t\tthis.addScheduleItem(scheduleItemData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tscheduleItem.setData(scheduleItemData);\n\t\t\t\tif (!scheduleItem.isDone())\n\t\t\t\t{\n\t\t\t\t\tthis._schedule.refreshItem(scheduleItem);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (historyItemData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.transferItemToHistory(\n\t\t\t\t\t\t\tscheduleItem,\n\t\t\t\t\t\t\thistoryItemData\n\t\t\t\t\t\t);\n\t\t\t\t\t\t//History data are already processed\n\t\t\t\t\t\thistoryItemData = null;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thistoryItem.setData(historyItemData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessWaitExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\tlet i = 0;\n\t\tconst length = historyItems.length;\n\t\tfor (; i < length; i++)\n\t\t{\n\t\t\tthis._history.deleteItem(historyItems[i]);\n\t\t}\n\n\t\tconst scheduleItem = this._schedule.getItemByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\tif (scheduleItem)\n\t\t{\n\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t}\n\t}\n\n\tprocessBizprocStatus(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t}\n\t}\n\n\tprocessScoringExternalAdd(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t}\n\t}\n\n\tonEntityProgressChange(sender, eventArgs)\n\t{\n\t\tif (BX.prop.getInteger(eventArgs, \"entityTypeId\", 0) !== this._ownerTypeId\n\t\t\t|| BX.prop.getInteger(eventArgs, \"entityId\", 0) !== this._ownerId\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst semantics = BX.prop.getString(eventArgs, \"semantics\", \"\");\n\t\tif (semantics === this._progressSemantics)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._progressSemantics = semantics;\n\t\tthis._schedule.refreshLayout();\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tgetOwnerTypeId()\n\t{\n\t\treturn this._ownerTypeId;\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn this._ownerId;\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._ownerInfo;\n\t}\n\n\tisStubCounterEnabled()\n\t{\n\t\tif (this._ownerId <= 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn (\n\t\t\t(this._ownerTypeId === BX.CrmEntityType.enumeration.deal || this._ownerTypeId === BX.CrmEntityType.enumeration.lead)\n\t\t\t&& this._progressSemantics === \"process\"\n\t\t);\n\t}\n\n\tgetSchedule()\n\t{\n\t\treturn this._schedule;\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tgetFixedHistory()\n\t{\n\t\treturn this._fixedHistory;\n\t}\n\n\tgetWaitEditor()\n\t{\n\t\treturn this._waitEditor;\n\t}\n\n\tgetSmsEditor()\n\t{\n\t\treturn this._smsEditor;\n\t}\n\n\tprocessSheduleLayoutChange()\n\t{\n\t}\n\n\tprocessHistoryLayoutChange()\n\t{\n\t\tthis._schedule.refreshLayout();\n\t}\n\n\tprocessEditingCompletion(editor)\n\t{\n\t\tif (this._waitEditor && editor === this._waitEditor)\n\t\t{\n\t\t\tthis._waitEditor.setVisible(false);\n\t\t\tthis._commentEditor.setVisible(true);\n\t\t\tthis._menuBar.setActiveItemById(\"comment\");\n\t\t}\n\t\tif (this._smsEditor && editor === this._smsEditor)\n\t\t{\n\t\t\tthis._smsEditor.setVisible(false);\n\t\t\tthis._commentEditor.setVisible(true);\n\t\t\tthis._menuBar.setActiveItemById(\"comment\");\n\t\t}\n\t}\n\n\tprocessEditingCancellation(editor)\n\t{\n\t\tif (this._waitEditor && editor === this._waitEditor)\n\t\t{\n\t\t\tthis._waitEditor.setVisible(false);\n\t\t\tthis._commentEditor.setVisible(true);\n\t\t\tthis._menuBar.setActiveItemById(\"comment\");\n\t\t}\n\t\tif (this._smsEditor && editor === this._smsEditor)\n\t\t{\n\t\t\tthis._smsEditor.setVisible(false);\n\t\t\tthis._commentEditor.setVisible(true);\n\t\t\tthis._menuBar.setActiveItemById(\"comment\");\n\t\t}\n\t}\n\n\taddScheduleItem(data)\n\t{\n\t\tconst item = this._schedule.createItem(data);\n\t\tconst index = this._schedule.calculateItemIndex(item);\n\t\tconst anchor = this._schedule.createAnchor(index);\n\t\tthis._schedule.addItem(item, index);\n\t\titem.layout({anchor: anchor});\n\n\t\treturn item;\n\t}\n\n\taddHistoryItem(data)\n\t{\n\t\tconst item = this._history.createItem(data);\n\t\tconst index = this._history.calculateItemIndex(item);\n\t\tconst historyAnchor = this._history.createAnchor(index);\n\t\tthis._history.addItem(item, index);\n\t\titem.layout({anchor: historyAnchor});\n\n\t\treturn item;\n\t}\n\n\trenderAudioDummy(durationText, onClick)\n\t{\n\t\treturn BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-audio-cap-wrap-container\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: {className: \"crm-audio-cap-wrap\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-audio-cap-time\"},\n\t\t\t\t\t\t\t\ttext: durationText\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t],\n\t\t\t\t\tevents: {click: onClick}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tloadMediaPlayer(id, filePath, mediaType, node, duration, options)\n\t{\n\t\tif (!duration)\n\t\t{\n\t\t\tduration = 0;\n\t\t}\n\t\tif (!options)\n\t\t{\n\t\t\toptions = {};\n\t\t}\n\t\tconst player = new BX.Fileman.Player(id, {\n\t\t\tsources: [\n\t\t\t\t{\n\t\t\t\t\tsrc: filePath,\n\t\t\t\t\ttype: mediaType\n\t\t\t\t}\n\t\t\t],\n\t\t\tisAudio: !options.video,\n\t\t\tskin: options.hasOwnProperty('skin') ? options.skin : 'vjs-timeline_player-skin',\n\t\t\twidth: options.width || 350,\n\t\t\theight: options.height || 30,\n\t\t\tduration: duration,\n\t\t\tplaybackRate: options.playbackRate || null,\n\t\t\tonInit: function (player) {\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('timeDivider');\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('durationDisplay');\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('fullscreenToggle');\n\t\t\t\tplayer.vjsPlayer.controlBar.addChild('timeDivider');\n\t\t\t\tplayer.vjsPlayer.controlBar.addChild('durationDisplay');\n\t\t\t\tif (!player.isPlaying())\n\t\t\t\t{\n\t\t\t\t\tplayer.play();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tBX.cleanNode(node, false);\n\t\tnode.appendChild(player.createElement());\n\t\tplayer.init();\n\t\t// todo remove this after player will be able to get float playbackRate\n\t\tif (options.playbackRate > 1)\n\t\t{\n\t\t\tplayer.vjsPlayer.playbackRate(options.playbackRate);\n\t\t}\n\t\treturn player;\n\t}\n\n\tonActivityCreated(activity, data)\n\t{\n\t\t//Already processed in onPullEvent\n\t}\n\n\tisSpotlightShowed()\n\t{\n\t\treturn this._spotlightFastenShowed;\n\t}\n\n\tsetSpotlightShowed()\n\t{\n\t\tthis._spotlightFastenShowed = true;\n\t}\n\n\tgetAudioPlaybackRateSelector()\n\t{\n\t\tif (!this.audioPlaybackRateSelector)\n\t\t{\n\t\t\tthis.audioPlaybackRateSelector = new AudioPlaybackRateSelector({\n\t\t\t\tname: 'timeline_audio_playback',\n\t\t\t\tcurrentRate: this._audioPlaybackRate,\n\t\t\t\tavailableRates: [\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 1,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_1')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">1x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 1.5,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_1.5')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">1.5x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 2,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_2')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">2x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 3,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_3')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">3x</span>')\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\ttextMessageCode: 'CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_TEXT'\n\t\t\t});\n\t\t}\n\n\t\treturn this.audioPlaybackRateSelector;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Manager();\n\t\tself.initialize(id, settings);\n\t\tManager.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic instances = {};\n}\n","/** @memberof BX.Crm.Timeline.Tools */\nexport const SmsWatcher =\n{\n\t_pullTagName: 'MESSAGESERVICE',\n\t_pullInited: false,\n\t_listeners: {},\n\tinitPull: function()\n\t{\n\t\tif (this._pullInited)\n\t\t\treturn;\n\n\t\tBX.addCustomEvent(\"onPullEvent-messageservice\", this.onPullEvent.bind(this));\n\t\tthis.extendWatch();\n\n\t\tthis._pullInited = true;\n\t},\n\tsubscribeOnMessageUpdate: function(messageId, callback)\n\t{\n\t\tthis.initPull();\n\t\tthis._listeners[messageId] = callback;\n\t},\n\tfireExternalStatusUpdate: function(messageId, message)\n\t{\n\t\tconst listener = this._listeners[messageId];\n\t\tif (listener)\n\t\t{\n\t\t\tlistener(message);\n\t\t}\n\t},\n\tonPullEvent: function(command, params)\n\t{\n\t\t// console.log(command, params);\n\t\tif (command === 'message_update')\n\t\t{\n\t\t\tfor (let i = 0; i < params.messages.length; ++i)\n\t\t\t{\n\t\t\t\tconst message = params.messages[i];\n\t\t\t\tthis.fireExternalStatusUpdate(message['ID'], message);\n\t\t\t}\n\t\t}\n\t},\n\textendWatch: function()\n\t{\n\t\tif(BX.type.isFunction(BX.PULL))\n\t\t{\n\t\t\tBX.PULL.extendWatch(this._pullTagName);\n\t\t\twindow.setTimeout(this.extendWatch.bind(this), 60000);\n\t\t}\n\t}\n};","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class SchedulePostpone extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._button = null;\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._isMenuShown = false;\n\n\t\tthis._menu = false;\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: this._isEnabled\n\t\t\t\t\t\t\t? \"crm-entity-stream-planned-action-aside\"\n\t\t\t\t\t\t\t: \"crm-entity-stream-planned-action-aside-disabled\"\n\t\t\t\t\t},\n\t\t\t\ttext: this.getMessage(\"postpone\")\n\t\t\t}\n\t\t);\n\n\t\tif(this._isEnabled)\n\t\t{\n\t\t\tBX.bind(this._button, \"click\", this._clickHandler)\n\t\t}\n\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\topenMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\t\tconst menuItems =\n\t\t\t[\n\t\t\t\t{id: \"hour_1\", text: this.getMessage(\"forOneHour\"), onclick: handler},\n\t\t\t\t{id: \"hour_2\", text: this.getMessage(\"forTwoHours\"), onclick: handler},\n\t\t\t\t{id: \"hour_3\", text: this.getMessage(\"forThreeHours\"), onclick: handler},\n\t\t\t\t{id: \"day_1\", text: this.getMessage(\"forOneDay\"), onclick: handler},\n\t\t\t\t{id: \"day_2\", text: this.getMessage(\"forTwoDays\"), onclick: handler},\n\t\t\t\t{id: \"day_3\", text: this.getMessage(\"forThreeDays\"), onclick: handler}\n\t\t\t];\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._button,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tonClick()\n\t{\n\t\tif(!this._isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\tthis.closeMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.openMenu();\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\n\t\tlet offset = 0;\n\t\tif(item.id === \"hour_1\")\n\t\t{\n\t\t\toffset = 3600;\n\t\t}\n\t\telse if(item.id === \"hour_2\")\n\t\t{\n\t\t\toffset = 7200;\n\t\t}\n\t\telse if(item.id === \"hour_3\")\n\t\t{\n\t\t\toffset = 10800;\n\t\t}\n\t\telse if(item.id === \"day_1\")\n\t\t{\n\t\t\toffset = 86400;\n\t\t}\n\t\telse if(item.id === \"day_2\")\n\t\t{\n\t\t\toffset = 172800;\n\t\t}\n\t\telse if(item.id === \"day_3\")\n\t\t{\n\t\t\toffset = 259200;\n\t\t}\n\n\t\tif(offset > 0 && this._item)\n\t\t{\n\t\t\tthis._item.postpone(offset);\n\t\t}\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tif(this._menu && this._menu.popupWindow)\n\t\t{\n\t\t\tthis._menu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu = null;\n\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = SchedulePostpone.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new SchedulePostpone();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Shift from \"./shift\";\n\n/** @memberof BX.Crm.Timeline.Animation */\nexport default class Comment\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._anchor = null;\n\t\tthis._nodeParent  = null;\n\t\tthis._startPosition = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(node, anchor, startPosition, events)\n\t{\n\t\tthis._node = node;\n\t\tthis._anchor = anchor;\n\t\tthis._nodeParent  = node.parentNode;\n\t\tthis._startPosition = startPosition;\n\t\tthis._events = BX.type.isPlainObject(events) ? events : {};\n\n\t}\n\n\trun()\n\t{\n\t\tBX.addClass(this._node, 'crm-entity-stream-section-animate-start');\n\n\t\tthis._node.style.position = \"absolute\";\n\t\tthis._node.style.width = this._startPosition.width + \"px\";\n\t\tthis._node.style.height = this._startPosition.height + \"px\";\n\t\tthis._node.style.top = this._startPosition.top - 30 + \"px\";\n\t\tthis._node.style.left = this._startPosition.left + \"px\";\n\t\tthis._node.style.opacity = 0;\n\t\tthis._node.style.zIndex = 960;\n\n\t\tdocument.body.appendChild(this._node);\n\n\t\tconst nodeOpacityAnim = new BX.easing({\n\t\t\tduration: 350,\n\t\t\tstart: {opacity: 0},\n\t\t\tfinish: {opacity: 100},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._node.style.opacity = state.opacity / 100;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tif (BX.type.isFunction(this._events[\"start\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"start\"]();\n\t\t\t\t}\n\t\t\t\tconst shift = Shift.create(\n\t\t\t\t\tthis._node,\n\t\t\t\t\tthis._anchor,\n\t\t\t\t\tthis._startPosition,\n\t\t\t\t\tfalse,\n\t\t\t\t\t{complete: BX.delegate(this.finish, this)}\n\t\t\t\t);\n\t\t\t\tshift.run();\n\t\t\t}, this)\n\t\t});\n\t\tnodeOpacityAnim.animate();\n\n\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t}\n\n\tfinish()\n\t{\n\t\tthis._node.style.position = \"\";\n\t\tthis._node.style.width = \"\";\n\t\tthis._node.style.height = \"\";\n\t\tthis._node.style.top = \"\";\n\t\tthis._node.style.left = \"\";\n\t\tthis._node.style.opacity = \"\";\n\t\tthis._node.style.zIndex = \"\";\n\t\tthis._anchor.style.height = \"\";\n\t\tthis._anchor.parentNode.insertBefore(this._node, this._anchor.nextSibling);\n\t\tsetTimeout(\n\t\t\tBX.delegate(function() {\n\t\t\t\tBX.removeClass(this._node, 'crm-entity-stream-section-animate-start');\n\t\t\t\tBX.remove(this._anchor);\n\t\t\t}, this),\n\t\t\t0\n\t\t);\n\t}\n\n\tstatic create(node, anchor, startPosition, events)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(node, anchor, startPosition, events);\n\t\treturn self;\n\t}\n}\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\nimport HistoryItemMixin from '../../mixins/history-item';\nimport ProductListMixin from '../../mixins/product-list';\nimport ProductList from '../../components/product/product-list';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin, ProductListMixin],\n\tcomponents: {\n\t\t'product-list': ProductList,\n\t},\n\tcreated() {\n\t\tthis.products = this.data.SENT_PRODUCTS;\n\t\tthis.dealId = this.data.DEAL_ID;\n\t\tthis.productsGrid = null;\n\t\tthis.subscribeCustomEvents();\n\t\tBX.Crm.EntityEditor.getDefault().tapController('PRODUCT_LIST', (controller) => {\n\t\t\tthis.setProductsGrid(controller.getProductList());\n\t\t});\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-advice\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-advice\"></div>\n\t\t\t<div class=\"crm-entity-stream-advice-content\">\n\t\t\t\t<div class=\"crm-entity-stream-advice-info\">\n\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_LIST_COMPILATION_SENT')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-entity-stream-advice-inner\">\n\t\t\t\t\t<!--<ul class=\"crm-entity-stream-advice-list\">-->\n\t\t\t\t\t<product-list\n\t\t\t\t\t\t:products=\"products\"\n\t\t\t\t\t\t:dealId=\"dealId\"\n\t\t\t\t\t\t:isAddToDealVisible=\"isProductsGridAvailable\"\n\t\t\t\t\t\t@product-added-to-deal=\"handleProductAddedToDeal\"\n\t\t\t\t\t\t@product-adding-to-deal=\"handleProductAddingToDeal\"\n\t\t\t\t\t></product-list>\n\t\t\t\t\t<!--</ul>-->\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\nimport HistoryItemMixin from '../../mixins/history-item';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-advice\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-advice\"></div>\n\t\t\t<div class=\"crm-entity-stream-advice-content\">\n\t\t\t\t<div class=\"crm-entity-stream-advice-info\">\n\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_ORDER_EXISTS_NOTICE')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\nimport HistoryItemMixin from '../../mixins/history-item';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\tcomputed: {\n\t\tlegend()\n\t\t{\n\t\t\tvar compilationCreationDate = BX.prop.getString(this.data, 'COMPILATION_CREATION_DATE', '');\n\t\t\tvar legendTextTemplate = Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_VIEWED_LEGEND');\n\n\t\t\treturn legendTextTemplate.replace('#DATE_CREATE#', compilationCreationDate);\n\t\t},\n\t\tauthorFormattedName()\n\t\t{\n\t\t\treturn this?.data?.AUTHOR?.FORMATTED_NAME;\n\t\t},\n\t\tauthorHref()\n\t\t{\n\t\t\treturn this?.data?.AUTHOR?.SHOW_URL;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-history\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\"></div>\n\t\t\t<div class=\"crm-entity-stream-section-content\">\n\t\t\t\t<div class=\"crm-entity-stream-content-event\">\n\t\t\t\t\t<div class=\"crm-entity-stream-content-header\">\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-event-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_TITLE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-done\">\n\t\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_VIEWED')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"crm-entity-stream-content-event-time\">{{createdAt}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-entity-stream-content-detail\">\n\t\t\t\t\t\t<div class=\"crm-entity-stream-content-detail-description\">\n\t\t\t\t\t\t\t${Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_VIEWED_DESCRIPTION')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tclass=\"ui-icon ui-icon-common-user crm-entity-stream-content-detail-employee\" \n\t\t\t\t\t\t\tv-bind:title=\"authorFormattedName\"\n\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\tv-bind:href=\"authorHref\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<i></i>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import {Vue} from 'ui.vue';\nimport {Loc} from 'main.core';\nimport HistoryItemMixin from '../../mixins/history-item';\n\nexport default Vue.extend({\n\tmixins: [HistoryItemMixin],\n\tcomputed: {\n\t\tmessage()\n\t\t{\n\t\t\tconst dealTitle = BX.util.htmlspecialchars(this?.data?.NEW_DEAL_DATA?.TITLE);\n\t\t\tconst dealLegend = this?.data?.NEW_DEAL_DATA?.LEGEND;\n\t\t\tconst dealUrl = this?.data?.NEW_DEAL_DATA?.SHOW_URL;\n\t\t\tconst dealTitleLink = `<a href=\"${dealUrl}\">${dealTitle}</a>`;\n\t\t\tlet message = Loc.getMessage('CRM_TIMELINE_PRODUCT_COMPILATION_DEAL_CREATED');\n\t\t\tmessage = message.replace('#DEAL_TITLE#', dealTitleLink);\n\t\t\tmessage = message.replace('#DEAL_LEGEND#', dealLegend);\n\n\t\t\treturn message;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-advice\">\n\t\t\t<div class=\"crm-entity-stream-section-icon crm-entity-stream-section-icon-advice\"></div>\n\t\t\t<div class=\"crm-entity-stream-advice-content\">\n\t\t\t\t<div class=\"crm-entity-stream-advice-info\" v-html=\"message\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n","import EncourageBuyProducts from './encourage-buy-products/component';\nimport Notification from './notification/component';\nimport DeliveryActivity from './delivery-activity/component';\nimport DeliveryMessage from './delivery-message/component';\nimport DeliveryCalculation from './delivery-calculation/component';\nimport Manager from \"./manager\";\nimport Stream from \"./stream\";\nimport Editor from \"./editor\";\nimport History from \"./streams/history\";\nimport FixedHistory from \"./streams/fixedhistory\";\nimport EntityChat from \"./streams/entitychat\";\nimport Schedule from \"./streams/schedule\";\nimport Comment from \"./editors/comment\";\nimport Wait from \"./editors/wait\";\nimport Rest from \"./editors/rest\";\nimport Sms from \"./editors/sms\";\nimport WaitConfigurationDialog from \"./tools/wait-configuration-dialog\";\nimport SchedulePostponeController from \"./tools/schedule-postpone-controller\";\nimport MenuBar from \"./tools/menubar\";\nimport {SmsWatcher} from \"./tools/sms-watcher\";\nimport AudioPlaybackRateSelector from \"./tools/audio-playback-rate-selector\";\nimport * as Types from \"./types\";\nimport Action from \"./action\";\nimport Activity from \"./actions/activity\";\nimport {Call, HistoryCall, ScheduleCall} from \"./actions/call\";\nimport {Email, HistoryEmail, ScheduleEmail} from \"./actions/email\";\nimport {OpenLine} from \"./actions/openline\";\nimport SchedulePostpone from \"./actions/schedule-postpone\";\nimport Item from \"./item\";\nimport HistoryItem from \"./items/history\";\nimport HistoryActivity from \"./items/history-activity\";\nimport CommentItem from \"./items/comment\";\nimport Modification from \"./items/modification\";\nimport Mark from \"./items/mark\";\nimport Creation from \"./items/creation\";\nimport Restoration from \"./items/restoration\";\nimport Relation from \"./items/relation\";\nimport Link from \"./items/link\";\nimport Unlink from \"./items/unlink\";\nimport EmailItem from \"./items/email\";\nimport CallItem from \"./items/call\";\nimport Meeting from \"./items/meeting\";\nimport Task from \"./items/task\";\nimport WebForm from \"./items/webform\";\nimport WaitItem from \"./items/wait\";\nimport Document from \"./items/document\";\nimport Sender from \"./items/sender\";\nimport Bizproc from \"./items/bizproc\";\nimport SmsItem from \"./items/sms\";\nimport Request from \"./items/request\";\nimport RestItem from \"./items/rest\";\nimport OpenLineItem from \"./items/openline\";\nimport Zoom from \"./items/zoom\";\nimport Conversion from \"./items/conversion\";\nimport Visit from \"./items/visit\";\nimport Scoring from \"./items/scoring\";\nimport OrderCreation from \"./items/order-creation\";\nimport OrderModification from \"./items/order-modification\";\nimport StoreDocumentCreation from \"./items/store-document-creation\";\nimport StoreDocumentModification from \"./items/store-document-modification\";\nimport FinalSummaryDocuments from \"./items/final-summary-documents\";\nimport FinalSummary from \"./items/final-summary\";\nimport ExternalNoticeModification from \"./items/external-notice-modification\";\nimport ExternalNoticeStatusModification from \"./items/external-notice-status-modification\";\nimport OrderCheck from \"./items/order-check\";\nimport Scheduled from \"./items/scheduled\";\nimport ScheduledActivity from \"./items/scheduled/activity\";\nimport ScheduledEmail from \"./items/scheduled/email\";\nimport ScheduledCall from \"./items/scheduled/call\";\nimport CallTracker from \"./items/scheduled/call-tracker\";\nimport ScheduledMeeting from \"./items/scheduled/meeting\";\nimport ScheduledTask from \"./items/scheduled/task\";\nimport ScheduledStoreDocument from \"./items/scheduled/store-document\";\nimport ScheduledWebForm from \"./items/scheduled/webform\";\nimport ScheduledWait from \"./items/scheduled/wait\";\nimport ScheduledRequest from \"./items/scheduled/request\";\nimport ScheduledRest from \"./items/scheduled/rest\";\nimport ScheduledOpenLine from \"./items/scheduled/openline\";\nimport ScheduledZoom from \"./items/scheduled/zoom\";\nimport AnimationItem from \"./animations/item\";\nimport ItemNew from \"./animations/item-new\";\nimport Expand from \"./animations/expand\";\nimport Shift from \"./animations/shift\";\nimport AnimationComment from \"./animations/comment\";\nimport Fasten from \"./animations/fasten\";\nimport ProductCompilationList from './product-compilation/compilation-product-list/component';\nimport CompilationOrderNotice from './product-compilation/order-notice/component';\nimport ProductCompilationViewed from './product-compilation/compilation-viewed/component';\nimport NewDealCreated from './product-compilation/deal-created/component';\n\nconst Streams = {\n\tHistory,\n\tFixedHistory,\n\tEntityChat,\n\tSchedule,\n}\n\nconst Editors = {\n\tComment,\n\tWait,\n\tRest,\n\tSms\n}\n\nconst Tools = {\n\tWaitConfigurationDialog,\n\tSchedulePostponeController,\n\tMenuBar,\n\tSmsWatcher,\n\tAudioPlaybackRateSelector,\n}\n\nconst Actions = {\n\tActivity,\n\tCall,\n\tHistoryCall,\n\tScheduleCall,\n\tEmail,\n\tHistoryEmail,\n\tScheduleEmail,\n\tOpenLine,\n\tSchedulePostpone,\n}\n\nconst ScheduledItems = {\n\tActivity: ScheduledActivity,\n\tEmail: ScheduledEmail,\n\tCall: ScheduledCall,\n\tCallTracker,\n\tMeeting: ScheduledMeeting,\n\tTask: ScheduledTask,\n\tStoreDocument: ScheduledStoreDocument,\n\tWebForm: ScheduledWebForm,\n\tWait: ScheduledWait,\n\tRequest: ScheduledRequest,\n\tRest: ScheduledRest,\n\tOpenLine: ScheduledOpenLine,\n\tZoom: ScheduledZoom,\n}\n\nconst Items = {\n\tHistory: HistoryItem,\n\tHistoryActivity,\n\tComment: CommentItem,\n\tModification,\n\tMark,\n\tCreation,\n\tRestoration,\n\tRelation,\n\tLink,\n\tUnlink,\n\tEmail: EmailItem,\n\tCall: CallItem,\n\tMeeting,\n\tTask,\n\tWebForm,\n\tWait: WaitItem,\n\tDocument,\n\tSender,\n\tBizproc,\n\tSms: SmsItem,\n\tRequest,\n\tRest: RestItem,\n\tOpenLine: OpenLineItem,\n\tZoom,\n\tConversion,\n\tVisit,\n\tScoring,\n\tOrderCreation,\n\tOrderModification,\n\tStoreDocumentCreation,\n\tStoreDocumentModification,\n\tFinalSummaryDocuments,\n\tFinalSummary,\n\tExternalNoticeModification,\n\tExternalNoticeStatusModification,\n\tOrderCheck,\n\tScheduledBase: Scheduled,\n\tScheduled: ScheduledItems,\n}\n\nconst Animations = {\n\tItem: AnimationItem,\n\tItemNew,\n\tExpand,\n\tShift,\n\tComment: AnimationComment,\n\tFasten,\n};\n\nexport {\n\tEncourageBuyProducts,\n\tNotification,\n\tDeliveryActivity,\n\tDeliveryMessage,\n\tDeliveryCalculation,\n\tManager,\n\tStream,\n\tStreams,\n\tEditor,\n\tEditors,\n\tTools,\n\tTypes,\n\tAction,\n\tActions,\n\tItem,\n\tItems,\n\tAnimations,\n\tProductCompilationList,\n\tCompilationOrderNotice,\n\tProductCompilationViewed,\n\tNewDealCreated,\n};\n"],"names":["Item","undefined","activity","creation","modification","link","unlink","mark","comment","wait","bizproc","conversion","sender","document","restoration","order","orderCheck","scoring","externalNotification","finalSummary","delivery","finalSummaryDocuments","storeDocument","productCompilation","Mark","waiting","success","renew","ignored","failed","Delivery","taxiEstimationRequest","taxiCallRequest","taxiCancelledByManager","taxiCancelledByDriver","taxiPerformerNotFound","taxiSmsProviderIssue","taxiReturnedFinish","deliveryMessage","deliveryCalculation","Order","encourageBuyProducts","EditorMode","view","edit","Compilation","productList","orderExists","compilationViewed","newDealCreated","_id","_settings","_data","_container","_wrapper","_typeCategoryId","_associatedEntityData","_associatedEntityTypeId","_associatedEntityId","_isContextMenuShown","_contextMenuButton","_activityEditor","_actions","_actionContainer","_isTerminated","_vueComponent","_vueComponentMountedNode","id","settings","BX","type","isNotEmptyString","util","getRandomString","getSetting","isPlainObject","doInitialize","name","defaultval","hasOwnProperty","data","clearCachedData","prop","getInteger","associatedEntityData","entityData","getAssociatedEntityData","getObject","permissions","getString","getArray","ItemType","container","isElementNode","className","timeout","addClass","isNumber","window","setTimeout","delegate","removeWrapperClass","removeClass","addWrapperClass","options","prepareLayout","prepareActions","actionQty","length","i","layout","showActions","mode","app","propsData","self","langMessages","messages","$mount","$el","show","remove","anchor","previousSibling","_playerWrappers","isDone","terminated","text","offset","whilespaceOffset","substring","search","clickHandler","htmlspecialchars","replace","create","attrs","href","events","click","getMessage","authorInfo","getObjectDataParam","showUrl","target","title","children","imageUrl","style","backgroundImage","backgroundSize","onContextMenuButtonClick","e","openContextMenu","closeContextMenu","menuItems","prepareContextMenuItems","IntranetExtensions","push","PopupMenu","offsetTop","offsetLeft","angle","position","onPopupShow","onContextMenuShow","onPopupClose","onContextMenuClose","onPopupDestroy","onContextMenuDestroy","_contextMenu","currentItem","close","popupWindow","destroy","Data","m","userTimezoneOffset","parseInt","message","isNaN","Fasten","_initialItem","_finalItem","_events","_anchor","defaultValue","node","getWrapper","parentNode","insertBefore","nextSibling","onFinishFasten","_clone","cloneNode","_startPosition","pos","width","_cloneHeight","height","_minHeight","_sumPaddingContent","top","left","zIndex","body","appendChild","proxy","_anchorPosition","finish","opacity","_difference","bottom","_deepHistoryLimit","clientHeight","_duration","Math","abs","movingEvent","easing","duration","start","transition","makeEaseOut","transitions","quart","step","state","complete","animate","addFixedHistoryItem","isFunction","initialize","History","_history","_fixedHistory","_typeId","_createdTime","_isFixed","_headerClickHandler","onHeaderClick","isReadOnly","getTextDataParam","time","parseDate","getCreatedTimestamp","Date","getTime","getUserTimezoneOffset","extractDate","getCreatedTime","getOwnerInfo","CrmEntityType","enumeration","typeId","getTypeId","CrmActivityStatus","isFinal","_items","fastenLimitPopup","PopupWindow","_switcher","content","darkMode","autoHide","closeByEsc","bindOptions","forceBindPosition","ajax","url","_serviceUrl","method","dataType","getOwnerTypeId","getOwnerId","onsuccess","onSuccessFasten","result","ERROR","isFixed","IS_FIXED","fixedItem","createItem","addItem","add","refreshLayout","animation","initialItem","finalItem","run","onSuccessUnfasten","item","historyItem","findItemById","index","getItemIndex","clearAnimate","removeItemByIndex","LazyLoad","showImages","isDomNode","wrapperPosition","hideEvent","marginBottom","clearLayout","wrapperClassName","getWrapperClassName","wrapper","getIconClassName","contentWrapper","header","getTitle","formatTime","prepareContentDetails","authorNode","prepareAuthorLayout","vueComponent","makeVueComponent","prepareContent","enableAdd","getBoolean","markAsTerminated","checkItemForTermination","preventDefault","returnValue","unfasten","fasten","manager","getManager","isSpotlightShowed","setSpotlightShowed","spotlight","SpotLight","targetElement","targetVertex","lightMode","autoSave","prepareTitleLayout","onActivityCreated","deadline","isDate","setHours","setMinutes","setSeconds","setMilliseconds","end","props","required","Object","computed","fields","FIELDS","author","AUTHOR","createdAt","HistoryItem","methods","getLangMessage","key","notificationBalloon","activeRequestsCnt","dealId","products","isProductsGridAvailable","productsGrid","setProductsGrid","onProductsGridChanged","handleProductAddingToDeal","handleProductAddedToDeal","Crm","EntityEditor","getDefault","reload","reloadGrid","getState","UI","Notification","State","OPEN","Center","notify","Loc","actions","event","balloon","action","onCustomEvent","subscribeCustomEvents","EventEmitter","subscribe","onProductsGridCreated","unsubscribeCustomEvents","unsubscribe","getData","dealOfferIds","map","product","OFFER_ID","entries","isInDeal","some","offerId","Vue","set","assign","beforeDestroy","Number","isAddToDealVisible","Boolean","addProductToDeal","$emit","runAction","productId","price","then","catch","openDetailPage","adminLink","slider","open","SidePanel","Instance","isBottomAreaVisible","isVariationInfoVisible","isPriceVisible","variationInfo","currency","Currency","currencyFormat","imageStyle","image","buttonText","template","isShortList","shortListProductsCnt","components","Product","onProductAddedToDeal","onProductAddingToDeal","showMore","listWrap","$refs","adviceList","maxHeight","isShowMoreVisible","visibleProducts","productIndex","extend","mixins","HistoryItemMixin","ProductListMixin","ProductList","created","VIEWED_PRODUCTS","DEAL_ID","tapController","controller","getProductList","iStyle","IMAGE_URL","Author","messageId","status","semantics","description","provider","isRefreshing","setMessageInfo","PULL","moduleId","command","callback","params","ID","refresh","extendWatch","messageInfo","Array","isArray","capitalizeFirstLetter","viewActivity","str","locale","navigator","language","char","toLocaleUpperCase","communication","statusClass","isStatusError","statusErrorDescription","deliveryService","isDeliveryServiceProfile","IS_PROFILE","deliveryServiceName","PARENT_NAME","NAME","deliveryProfileServiceName","deliveryServiceLogoBackgroundUrl","PARENT_LOGO","LOGO","logo","DeliveryServiceInfo","String","deliveryInfo","isCreatingRequest","isCancellingRequest","completeActivity","canComplete","setAsDone","showContextMenu","popup","getId","onclick","deletionDlgId","dlg","ConfirmationDialog","get","cancel","createDeliveryRequest","isLocked","analyticsLabel","shipmentIds","additional","ACTIVITY_ID","activityId","showError","errors","join","cancelDeliveryRequest","deliveryRequest","requestId","actionType","checkRequestStatus","startCheckingRequestStatus","clearTimeout","_checkRequestStatusTimeoutId","setInterval","stopCheckingRequestStatus","setDeliveryInfo","finallyCallback","subscribePullEvents","_isPullSubscribed","deliveryServiceIds","deliveryRequestId","callPhone","phone","canUseTelephony","BXIM","phoneTo","location","isPhone","property","includes","loadExt","needCheckRequestStatus","ASSOCIATED_ENTITY","shipments","shipment","expectedDeliveryPriceFormatted","IDS","deliveryRequestProperties","deliveryRequestStatus","deliveryRequestStatusSemantic","isConnectedWithDeliveryRequest","isSendRequestButtonVisible","miscellaneous","cancelRequestButtonStyle","wrapperContainerClass","innerWrapperContainerClass","watch","value","DELIVERY_SERVICE","messageData","MESSAGE_DATA","messageTitle","messageDescription","messageStatus","messageStatusSemantics","messageStatusSemanticsClass","addressFrom","ADDRESS_FROM_FORMATTED","addressTo","ADDRESS_TO_FORMATTED","Editor","_manager","_ownerTypeId","_ownerId","_input","_saveButton","_cancelButton","_ghostInput","_saveButtonHandler","onSaveButtonClick","_cancelButtonHandler","onCancelButtonClick","_focusHandler","onFocus","_blurHandler","onBlur","_keyupHandler","resizeForm","_delayedKeyupHandler","bind","_isVisible","_hideButtonsOnBlur","Manager","visible","display","minHeight","save","processEditingCancellation","offsetWidth","ghost","ensureGhostCreated","computedStyle","getComputedStyle","diff","paddingBottom","paddingTop","borderTopWidth","borderBottomWidth","innerHTML","scrollHeight","WaitConfigurationDialog","_type","Wait","WaitingType","_target","_targetDates","_durationMeasureNode","_durationInput","_targetDateNode","_popup","after","_menuId","enableNumber","Helper","getDurationText","info","draggable","prepareDialogContent","buttons","PopupWindowButton","PopupWindowButtonLink","keyup","onDurationChange","getTargetDateCaption","toggleTargetMenu","isTargetMenuOpened","closeTargetMenu","openTargetMenu","getMenuById","onTargetSelect","getFunction","before","fieldName","_isRequestRunning","_isLocked","_configContainer","_configSelector","_isMenuShown","_menu","_configDialog","config","resolveTypeId","names","layoutConfigurationSummary","openMenu","closeMenu","handler","onMenuItemClick","customMenu","items","onMenuShow","onMenuClose","onMenuDestroy","openConfigDialog","saveConfiguration","targetDates","onSave","onConfigDialogSave","onCancel","onConfigDialogCancel","setType","setDuration","setTarget","optionName","toLowerCase","userOptions","strip_tags","getSummaryHtml","querySelector","onSelectorClick","completed","getSummaryText","trim","targetFieldName","subject","ownerType","resolveName","ownerID","onSaveSuccess","onfailure","onSaveFailure","release","error","alert","processEditingCompletion","getMessagePlural","toString","Sms","_senderId","_from","_commEntityTypeId","_commEntityId","_to","_canUse","_canSendMessage","_manageUrl","_senders","_fromList","_toList","_defaults","_communications","_shownMenuId","_documentSelector","_source","_paymentId","_shipmentId","_compilationProductIds","_templateId","_templatesContainer","_templateFieldHintNode","_templateSelectorNode","_templateTemplateTitleNode","_templatePreviewNode","_templateSelectorMenuId","_templateFieldHintHandler","onTemplateHintIconClick","_templateSeletorClickHandler","onTemplateSelectClick","_selectTemplateHandler","onSelectTemplate","remove_url_param","senderId","from","_isSalescenterEnabled","_isDocumentsEnabled","_documentsProvider","_documentsValue","_isFilesEnabled","_diskUrls","_isFilesExternalLinkEnabled","_senderSelectorNode","_fromContainerNode","_fromSelectorNode","_clientContainerNode","_clientSelectorNode","_toSelectorNode","_messageLengthCounterWrapperNode","_messageLengthCounterNode","_salescenterStarter","_smsDetailSwitcher","_smsDetail","_documentSelectorButton","_fileSelectorButton","_fileUploadZone","_fileUploadLabel","_fileSelectorBitrix","_fileExternalLinkDisabledContent","initSenderSelector","initDetailSwitcher","initFromSelector","initClientContainer","initClientSelector","initToSelector","initMessageLengthCounter","setMessageLengthCounter","initDocumentSelector","initFileSelector","initSalescenterApplication","classList","contains","innerText","defaultSenderId","defaultSender","canUse","restSender","onSenderSelectorClick","fromList","delimiter","setSender","Uri","addParam","manageUrl","getTopSlider","onClose","onCloseComplete","setFrom","setAsDefault","textContent","shortName","isTemplatesBased","showNode","hideNode","toggleTemplateSelectAvailability","toggleSaveButton","visualFn","defaultFromId","defaultFrom","onFromSelectorClick","onFromSelectorItemClick","hide","onClientSelectorClick","caption","client","setClient","entityTypeId","entityId","phones","setTo","onToSelectorClick","onToSelectorItemClick","valueFormatted","to","menuId","bindElement","_messageLengthMax","getAttribute","setMessageLengthCounterDelayed","classFn","getSelectedSender","enabled","templateId","getSelectedTemplate","PREVIEW","add_url_param","bitrix_sessid","startSalescenterApplication","Salescenter","openApplication","disableSendButton","context","ownerTypeId","ownerId","deal","focus","paymentId","shipmentId","productIds","onDocumentSelectorClick","DocumentGenerator","Selector","Menu","analyticsLabelPrefix","selectPublicUrl","object","Template","createDocument","pasteDocumentUrl","console","Document","getDocumentPublicUrl","publicUrl","onFileSelectorClick","uploadFile","findFile","getElementById","closeFileSelector","initDiskUF","fireEvent","getFileUploadInput","showFilesExternalLinkFeaturePopup","loader","Loader","size","getLoader","isShown","isDiskFileUploaderInited","addCustomEvent","OnFileUploadSuccess","uf","_onUploadProgress","showLoader","Disk","UF","UID","controlName","hideSelectDialog","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","fileResult","file","uploaderFile","hideLoader","diskFileId","element_id","fileName","element_name","pasteFileUrl","fileId","response","externalLink","pop","featurePopup","closeIcon","overlay","contentColor","getFeaturePopup","Type","forEach","TITLE","loaderMenuId","loaderMenuLoaderId","html","onDestroy","module","find","templates","showTemplateSelectDropdown","applySelectedTemplate","menu","preview","Text","encode","Rest","_interfaceInitialized","initializeInterface","rest","Marketplace","PLACEMENT","fireUpdateEvent","appId","appData","split","AppLayout","PLACEMENT_ID","PlacementInterface","initializePlacement","prototype","reloadData","cb","EntityEvent","fireUpdate","log","fire","invalidate","Comment","_postForm","_editor","unbind","_editorName","onLoadEditorSuccess","_editorContainer","showEditor","addEvents","firstElementChild","removeEventListener","obj","blob","addEventListener","LHEPostForm","getHandler","BXHtmlEditor","Get","eventNode","history","Focus","loadEditor","attachmentList","oEditor","GetContent","querySelectorAll","input","emptyCommentMessage","reinit","itemData","createAnchor","move","CrmCommentAnimation","onAnimationStart","onAnimationComplete","Scheduled","_schedule","_deadlineNode","_setAsDoneButtonHandler","onSetAsDoneButtonClick","CrmActivityEditor","hasPermissions","verifyPermissions","loadPermissions","userId","getPermissions","getUserId","getServiceUrl","getAssociatedEntityId","onPermissionsLoad","setPermissions","getDeadline","isCounterEnabled","markAsDone","onItemMarkedAsDone","formatDateTime","perms","Action","doLayout","Activity","_entityData","_item","_isEnabled","getActivityCommunications","getActivityId","communications","Email","_clickHandler","onClick","_saveHandler","CrmActivityProvider","Bitrix24","Slider","addEmail","addOnSave","loadActivityCommunications","CrmActivityEmail","prepareReply","PreventDefault","onActivityCreate","HistoryEmail","ScheduleEmail","HistoryActivity","direction","typeCategoryId","getTypeCategoryId","CrmActivityType","email","CrmActivityDirection","incoming","call","meeting","task","providerId","getTypeDescription","markTypeId","messageName","markText","activityEditor","isEditable","processRemoval","associatedEntityTypeId","getAssociatedEntityTypeId","editActivity","_detetionConfirmDlgId","getRemoveMessage","onRemovalConfirm","onRemovalCancel","getItemById","deleteActivity","serviceUrl","ownertype","ownerid","_handleActivityChange","editDocument","statusLayout","prepareTitleStatusLayout","prepareTimeLayout","isContextMenuEnabled","prepareContextMenuButton","prepareFixedSwitcherLayout","prepareHeaderLayout","detailWrapper","findChildByClassName","confirmDelete","onConfirmDelete","DoNothing","deleteDocument","deleteItem","deleteFixedItem","documentId","DOCUMENT_ID","adjust","Steam","_userTimezoneOffset","_serverTimezoneOffset","_timeFormat","_year","_isStubMode","_userId","_readOnly","datetimeFormat","dateFormat","date","convertBitrixFormat","getFullYear","currentUrl","ajaxId","insertToNode","bxajaxid","now","utc","format","whitespaceOffset","EntityChat","_layoutType","LayoutType","none","_contentWrapper","_messageWrapper","_messageDateNode","_messageTexWrapper","_messageTextNode","_userWrapper","_extraUserCounter","_openChatHandler","onOpenChat","lockScript","isString","eval","getUserInfoData","userInfos","counter","isEnabled","isStubMode","getChatId","renderSummary","renderInvitation","onChatEvent","cleanNode","invitation","refreshUsers","summary","_messageTexWraper","_messageCounterNode","refreshSummary","infos","list","values","count","icon","getMessageData","isoDate","remoteDate","getServerTimezoneOffset","localTime","MessengerCommon","purifyText","isRestricted","applyLockScript","slug","chatId","hasUserInfo","ownerInfo","entityTypeName","openMessengerSlider","RECENT","MENU","extras","setUserInfoData","mergeEx","refreshUsersAnimated","removeUserInfo","setMessageData","setUnreadMessageCounter","refreshSummaryAnimated","Stream","MenuBar","_ownerInfo","_commentEditor","_waitEditor","_smsEditor","_zoomEditor","_restEditor","Main","interfaceButtonsManager","getById","setActiveItemById","_activeItem","getActive","firstId","getAllItems","dataset","indexOf","processItemSelection","currentDiv","wasActiveInMoreMenu","isActiveInMoreMenu","classes","itemActive","getItemData","currentDivData","activeItemData","isActiveData","JSON","parse","err","IS_ACTIVE","stringify","wasActiveData","submenu","getSubmenu","getMenuItems","menuItem","getContainer","getMoreButton","closeSubmenu","planner","Planner","showEdit","addDelivery","addTask","setVisible","visitParameters","CrmActivityVisit","match","AudioPlaybackRateSelector","availableRates","currentRate","normalizeRate","textMessageCode","renderedItems","players","rateDescription","rate","parseFloat","isRateCurrent","selectedRate","getRate","setRate","popupMenu","MenuManager","getPopupWindow","setBindElement","getPopup","textNode","getText","vjsPlayer","playbackRate","Dom","player","Fileman","Player","SchedulePostponeController","postpone","_postponeController","autoCompleted","setActivityCompleted","onSetAsDoneCompleted","getSourceId","postponeActivity","onPosponeCompleted","activityType","canPostpone","timeText","communicationValue","iconClassName","contentInnerWrapper","headerWrapper","statusNode","getStatusNode","cutOffText","additionalDetails","prepareDetailNodes","members","getPrepositionText","communicationNode","prepareCommunicationNode","setAsDoneButton","checked","change","disabled","buttonContainer","onContextMenuItemSelect","postponeMenu","commands","getCommandList","processCommand","CrmScheduleEmailAction","Call","CrmScheduleCallAction","callInfo","callTypeText","CallTracker","isSuccessfull","statusText","Meeting","Task","StoreDocument","WebForm","editor","getWaitEditor","nl2br","Request","iconNode","backgroundPosition","OpenLine","_button","OpenLineAction","messageWrapper","openLineData","isExternal","Zoom","topic","startTimeStamp","detailZoomMessage","detailZoomInfoLink","detailZoomInfo","detailZoomCopyInviteLink","clipboard","bindCopyClick","detailZoomStartConferenceButton","detailZoomCopyInviteLinkWrapper","_node","originalPosition","_initialYPosition","_initialXPosition","_initialWidth","_initialHeight","offsetHeight","_anchorYPosition","createStub","createGhost","moveGhost","_stub","_ghostNode","boxShadow","placeEventAnim","addHistoryItem","removeGhost","_finalItemHeight","ghostNode","finalNode","overflow","hideCasperItem","collapseStub","removePlannedEvent","inited","Shift","_nodeParent","startPosition","shadowNode","_shadowNode","ItemNew","shift","stubContainer","Schedule","timeFormat","label","addStub","setContainer","processSheduleLayoutChange","hasContent","stubIcon","isStubCounterEnabled","isTerminated","getItemCount","getLastItem","curTime","sourceId","$entityTypeId","getItemByAssociatedEntity","l","splice","entityTypeID","entityID","itemId","schedule","Timeline","DeliveryActivity","calculateItemIndex","removeStub","newItem","newIndex","historyItemData","onTransferComplete","stubClassName","stubIconClassName","stubMessage","lead","Modification","contentChildren","Conversion","entityNodes","entityInfos","getArrayDataParam","entityInfo","entityNode","getNotFoundMessage","emailInfo","markNode","prepareMarkLayout","communicationTitle","communicationShowUrl","outerWrapper","communicationWrapper","prepareCutOffElements","_menuItems","addCall","showMenu","prepareMenuItems","PopupMenuWindow","formattedValue","complexName","itemText","HistoryCall","ScheduleCall","_playerDummyClickHandler","onPlayerDummyClick","_playerWrapper","_transcriptWrapper","_mediaFileInfo","hasCallInfo","communicationValueFormatted","durationText","hasTranscript","isTranscriptPending","callId","callComment","prepareMultilineCutOffElements","callInfoWrapper","renderAudioDummy","getAudioPlaybackRateSelector","render","Voximplant","Transcript","stubNode","addPlayer","loadMediaPlayer","prepareMessageStatusLayout","_messageStatusNode","smsInfo","senderName","senderShortName","fromName","messageSenderWrapper","statusId","setMessageStatus","errorText","bodyText","messageBodyWrapper","statuses","setMessageStatusErrorText","statusSemantic","getMessageStatusSemantic","setMessageStatusSemantic","semantic","classMap","process","failure","checkSemantic","fn","removeAttribute","setAttribute","CrmSmsWatcher","subscribeOnMessageUpdate","onMessageUpdate","STATUS_ID","EXEC_ERROR","entityDetailWrapper","Visit","visitInfo","recordLength","recordLengthFormatted","vkProfile","createTextNode","getVkProfileUrl","profile","getClass","Restriction","_videoDummy","_audioDummy","_videoPlayer","_audioPlayer","_audioLengthElement","_recordings","_currentRecordingIndex","zoomActivitySubject","_downloadWrapper","_downloadSubject","_downloadSubjectDetail","_downloadVideoLink","_downloadSeparator","_downloadAudioLink","_playVideoLink","detailZoomCopyVideoLink","prepareSuccessfulLayout","zoomData","tabs","recording","active","tabsComponent","TabsComponent","eventEmitter","_onTabChange","_onVideoDummyClick","hint","Hint","init","_onAudioDummyClick","videoLinkExpireTS","videoLinkContainer","_detailZoomCopyVideoLink","zoomAudioDetailWrapper","setCurrentRecording","video","skin","tabId","recordingIndex","videoRecording","audioRecording","hidden","pause","setSource","clean","lengthHuman","lastElementChild","elements","Event","_renderTab","tabDescription","setActiveTab","Error","emit","OrderCreation","msg","statusMessage","legend","nodes","getHeaderChildren","OrderModification","statusInfo","classCode","orderpayment","psStatusCode","ordershipment","getStatusInfo","isNotEmptyObject","htmlTitle","descriptionNode","sublegend","destination","detailNode","sliderLinkNode","orderId","templateMode","paySystemName","sum","paymentDetail","logotip","encodeURI","isPaid","isClick","isManualContinuePay","isManualAddCheck","preparePaidPaymentContent","prepareClickedPaymentContent","prepareManualContinuePayContent","prepareManualAddCheck","prepareItemOrderContent","isViewed","isSent","prepareViewedContentDetails","prepareSentContentDetails","prepareErrorPaymentContentDetails","headerWrap","preparePaidPaymentContentDetails","paySystemError","errorDetailNode","prepareClickedPaymentContentDetails","StoreDocumentCreation","docType","titleNode","titleTemplate","documentDetailUrl","documentLinkTag","StoreDocumentModification","field","statusName","errorMessage","ExternalNoticeModification","ExternalNoticeStatusModification","OrderCheck","checkName","isSended","Page","openSlider","legendNode","checkUrl","FinalSummaryDocuments","check","blockNode","URL","contentItem","RESULT","summaryOptions","ASSOCIATED_ENTITY_ID","ASSOCIATED_ENTITY_TYPE_ID","timelineSummaryDocuments","TimelineSummaryDocuments","TIMELINE_SUMMARY_OPTIONS","setOptions","FinalSummary","Creation","isMessageNotFound","TYPE_CATEGORY_ID","HTML_TITLE","createOrderEntityItem","orderData","ORDER_DATE","SHOW_URL","SUM","spanAttrs","linkAttrs","baseEntityData","baseEntityInfo","Restoration","Relation","Link","Unlink","activityProviderId","MarkType","isDefined","innerWrapper","associatedEntityTitle","contentTemplate","_isCollapsed","_hasFiles","_commentMessage","_mode","_streamContentEventBlock","playerWrapper","entityValueId","files","extension","detailChildren","_commentWrapper","switchToEditMode","switchToViewMode","cleanText","_hasInlineAttachment","onExpandButtonClick","_textLoaded","_fileBlock","ready","loadContent","registerImages","viewElementBind","showTitle","BLOCK","promise","SetContent","ReInitIframe","actionData","commentImages","commentImagesLength","idsList","toggleMode","tagName","hasClass","getSelection","onRequestFailure","getHistory","fixedHistory","getFixedHistory","onRemoveSuccess","updateFixedItem","setData","updateItem","eventWrapper","button","Sender","getDataSetting","isRemoved","stopPropagation","layoutClassName","textCaption","prepareStatusLayout","Bizproc","prepareContentTextHtml","workflowName","workflowStatus","Scoring","scoringInfo","score","getNumber","scoreDelta","round","iconClass","_emptySection","_currentDaySection","_lastDaySection","_lastDate","_enableLoading","_navigation","_scrollHandler","_loadingWaiter","_filterId","_isFilterApplied","_isFilterShown","_filterButton","_filterWrapper","_filterResultStub","onFilterApply","closeFilterButton","onFilterClose","getCreatedDate","createCurrentDaySection","createDaySection","enableLoading","processHistoryLayoutChange","firstChild","adjustFilterButton","_filterEmptyResultSection","createFilterEmptyResultSection","results","createEmptySection","showFilter","section","sectionWrapper","hideFilter","filter","filterManager","resetFilter","formatDate","vueComponentId","vueComponentsMap","Map","has","smsStatusDescriptions","smsStatusSemantics","OrderType","EncourageBuyProducts","shipmentDocument","CompilationType","ProductCompilationList","CompilationOrderNotice","ProductCompilationViewed","NewDealCreated","CrmHistoryItem","changedFieldName","DeliveryType","Taxi","EstimationRequest","CallRequest","CancelledByManager","CancelledByDriver","PerformerNotFound","SmsProviderIssue","ReturnedFinish","DeliveryMessage","DeliveryCalculation","createActivityItem","createProductCompilationItem","createStoreDocumentItem","createExternalNotificationItem","createDeliveryItem","child","removeChild","getBoundingClientRect","documentElement","loadItems","ctx","autoResolve","CrmDataLoader","load","resetLayout","bulkCreateItems","setNavigation","fulfill","lastItemTime","navigation","enable","onWindowScroll","instances","FixedHistory","nextElementSibling","onItemsLoad","Expand","_callback","onNodeHeightStep","onNodeHeightComplete","onNodeOpacityStep","onNodeOpacityComplete","_progressSemantics","_chat","_menuBar","_pullTagName","_spotlightFastenShowed","_audioPlaybackRate","containerId","activityEditorId","readOnly","editorContainer","filterId","isFilterApplied","setHistory","editorName","cancelButton","configContainer","templatesContainer","placement","onPullEvent","commentEditor","waitEditor","smsEditor","zoomEditor","restEditor","reset","onEntityProgressChange","throttle","onScroll","processChatCreate","processActivityExternalAdd","processActivityExternalUpdate","processActivityExternalDelete","processCommentExternalAdd","processLinkExternalAdd","processLinkExternalDelete","processDocumentExternalUpdate","processDocumentExternalDelete","processCommentExternalUpdate","processCommentExternalDelete","processChangeBinding","processItemChangeFasten","processItemExternalUpdate","processWaitExternalAdd","processWaitExternalUpdate","processWaitExternalDelete","processBizprocStatus","processScoringExternalAdd","scheduleItemData","scheduleItem","getItemByData","addScheduleItem","fixedHistoryItem","historyItems","getItemsByAssociatedEntity","setAssociatedEntityData","fixedHistoryItems","refreshItem","transferItemToHistory","associatedEntityId","updateWrapper","entityNewId","fixedItemData","newFixedItem","eventArgs","historyAnchor","filePath","mediaType","sources","src","isAudio","onInit","controlBar","addChild","isPlaying","play","createElement","audioPlaybackRateSelector","SmsWatcher","_pullInited","_listeners","initPull","fireExternalStatusUpdate","listener","SchedulePostpone","nodeOpacityAnim","SENT_PRODUCTS","compilationCreationDate","legendTextTemplate","authorFormattedName","FORMATTED_NAME","authorHref","dealTitle","NEW_DEAL_DATA","dealLegend","LEGEND","dealUrl","dealTitleLink","Streams","Editors","Tools","Actions","ScheduledItems","ScheduledActivity","ScheduledEmail","ScheduledCall","ScheduledMeeting","ScheduledTask","ScheduledStoreDocument","ScheduledWebForm","ScheduledWait","ScheduledRequest","ScheduledRest","ScheduledOpenLine","ScheduledZoom","Items","CommentItem","EmailItem","CallItem","WaitItem","SmsItem","RestItem","OpenLineItem","ScheduledBase","Animations","AnimationItem","AnimationComment"],"mappings":"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"}